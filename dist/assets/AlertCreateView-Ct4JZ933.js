import{d as V,k as E,l as N,z as b,e as A,c as m,a as e,n as $,p as C,q as g,v as k,h as n,t as c,P as w,F as D,A as I,j as i,I as y,B as v,w as S,g as M,o as u,_ as h}from"./index-WKext-pH.js";import{useAlertsStore as O}from"./alerts-DAXRZVl7.js";import{C as R}from"./constants-DDm60LNs.js";import{L as T}from"./LocationSelector-CIHh1hpR.js";import{u as j}from"./location-JCncGmg2.js";import"./Map-Cr7WoUv5.js";import"./Text.vue_vue_type_script_setup_true_lang-CyQVRKCi.js";const q={class:"alert-form"},z=["disabled"],G={for:"alert-radius",class:"block text-sm font-medium text-gray-700 mb-2"},H=["disabled"],P={class:"space-y-2"},Y={class:"flex items-center"},J=["disabled"],K=["onUpdate:modelValue","value","disabled"],Q={class:"ml-2 text-sm text-gray-700"},W={key:0,class:"error-message"},X={class:"form-actions"},Z=V({__name:"AlertForm",props:{alert:{default:null},loading:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(x,{emit:o}){const r=x,p=o,d=j(),f=E(""),t=N({name:"",location:{lat:0,lng:0},radius_meters:5e3,category:""}),F=b(()=>!!r.alert),L=b(()=>{const s=t.radius_meters/1e3;return s<1?`${t.radius_meters}m`:`${s.toFixed(1)}km`}),_=b(()=>t.name.trim().length>0&&t.location.lat!==0&&t.location.lng!==0&&t.radius_meters>=500&&t.radius_meters<=5e4),U=()=>{if(!_.value)return;f.value="";const s={name:t.name.trim(),location:t.location,radius_meters:t.radius_meters,category:t.category||void 0};p("submit",s)};return A(async()=>{r.alert?(t.name=r.alert.name,t.location={...r.alert.location},t.radius_meters=r.alert.radius_meters,t.category=r.alert.category||""):d.creationLocation&&(t.location={...d.creationLocation})}),(s,a)=>(u(),m("div",q,[e("form",{onSubmit:$(U,["prevent"]),class:"space-y-6"},[e("div",null,[a[4]||(a[4]=e("label",{for:"alert-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Alert Name ",-1)),g(e("input",{id:"alert-name","onUpdate:modelValue":a[0]||(a[0]=l=>t.name=l),type:"text",required:"",placeholder:"e.g. 'Downtown alerts' or 'Help needed in my area'",class:"input",disabled:s.loading},null,8,z),[[k,t.name]]),a[5]||(a[5]=e("p",{class:"mt-1 text-sm text-gray-500"}," Give your alert a descriptive name to help you identify it later. ",-1))]),e("div",null,[a[6]||(a[6]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Location ",-1)),n(T,{modelValue:t.location,"onUpdate:modelValue":a[1]||(a[1]=l=>t.location=l),disabled:s.loading,class:"mb-2"},null,8,["modelValue","disabled"]),a[7]||(a[7]=e("p",{class:"text-sm text-gray-500"},"Set the center point for your alert area.",-1))]),e("div",null,[e("label",G," Alert Radius: "+c(L.value),1),g(e("input",{id:"alert-radius","onUpdate:modelValue":a[2]||(a[2]=l=>t.radius_meters=l),type:"range",min:"500",max:"50000",step:"500",class:"slider",disabled:s.loading},null,8,H),[[k,t.radius_meters,void 0,{number:!0}]]),a[8]||(a[8]=e("div",{class:"flex justify-between text-xs text-gray-500 mt-1"},[e("span",null,"500m"),e("span",null,"50km")],-1)),a[9]||(a[9]=e("p",{class:"mt-1 text-sm text-gray-500"}," You'll be notified about new listings within this distance from your location. ",-1))]),e("div",null,[a[11]||(a[11]=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Category Filter (Optional) ",-1)),e("div",P,[e("label",Y,[g(e("input",{"onUpdate:modelValue":a[3]||(a[3]=l=>t.category=l),type:"radio",value:"",class:"radio",disabled:s.loading},null,8,J),[[w,t.category]]),a[10]||(a[10]=e("span",{class:"ml-2 text-sm text-gray-700"},"All categories",-1))]),(u(!0),m(D,null,I(i(R),l=>(u(),m("label",{key:l.value,class:"flex items-center"},[g(e("input",{"onUpdate:modelValue":B=>t.category=B,type:"radio",value:l.value,class:"radio",disabled:s.loading},null,8,K),[[w,t.category]]),e("span",Q,c(l.label),1)]))),128))]),a[12]||(a[12]=e("p",{class:"mt-1 text-sm text-gray-500"}," Only get notified about listings in specific categories, or leave unselected for all. ",-1))]),f.value?(u(),m("div",W,[n(i(y),{icon:"tabler:alert-triangle",class:"error-icon"}),e("span",null,c(f.value),1)])):C("",!0),e("div",X,[n(v,{loading:s.loading,disabled:!_.value},{default:S(()=>[M(c(F.value?"Update Alert":"Create Alert"),1)]),_:1},8,["loading","disabled"])])],32)]))}}),ee=h(Z,[["__scopeId","data-v-70f1aef4"]]),te={class:"form-section"},ae={class:"form-header"},se={key:0,class:"error-banner"},le=V({__name:"AlertCreateView",setup(x){const o=O(),r=async p=>{try{await o.createAlert(p)}catch{}};return A(()=>{o.clearError()}),(p,d)=>(u(),m("div",null,[e("div",te,[e("div",ae,[n(v,{variant:"ghost",link:{name:"alerts"},class:"hover:bg-gray-100 mr-3"},{default:S(()=>[n(i(y),{icon:"tabler:chevron-left",class:"w-6 h-6 text-gray-500"})]),_:1}),d[0]||(d[0]=e("h2",{class:"form-title grow"},"Create New Alert",-1))]),n(ee,{loading:i(o).loading,onSubmit:r},null,8,["loading"])]),i(o).error?(u(),m("div",se,[n(i(y),{icon:"tabler:alert-triangle",class:"error-icon"}),e("span",null,c(i(o).error),1),n(v,{variant:"ghost",size:"sm","icon-left":"tabler:x",onClick:i(o).clearError,class:"error-close"},null,8,["onClick"])])):C("",!0)]))}}),ce=h(le,[["__scopeId","data-v-9190c35d"]]);export{ce as default};
//# sourceMappingURL=AlertCreateView-Ct4JZ933.js.map
