import{d as I,A as v,c as l,E as S,a as t,p as g,t as c,h as e,j as n,I as f,o as a,_ as B,R as D,k as T,e as V,i as x,w as _,B as d,F as z,C as E,g as m,x as F}from"./index-Cwfaiojx.js";import{C as R}from"./constants-DDm60LNs.js";import{_ as L}from"./Chip.vue_vue_type_script_setup_true_lang-CN88rGI7.js";const U={class:"notification-content"},O={class:"notification-header"},j={class:"notification-info"},G={class:"notification-title"},H={class:"notification-meta"},J={class:"notification-alert"},Y={class:"notification-time"},q={class:"notification-location"},K={key:0,class:"unread-indicator"},P=I({__name:"NotificationItem",props:{notification:{}},emits:["click"],setup(M,{emit:h}){const o=M,r=h,p=v(()=>{var s;return((s=R.find(i=>i.value===o.notification.listing_category))==null?void 0:s.label)||o.notification.listing_category}),y=v(()=>{const s=R.find(u=>u.value===o.notification.listing_category);return s&&{"#059669":"green","#2563eb":"blue","#7c3aed":"purple"}[s.color]||"gray"}),k=v(()=>`${o.notification.listing_location.lat.toFixed(4)}, ${o.notification.listing_location.lng.toFixed(4)}`),b=s=>{const i=new Date(s),C=new Date().getTime()-i.getTime(),$=Math.floor(C/(1e3*60)),A=Math.floor(C/(1e3*60*60)),N=Math.floor(C/(1e3*60*60*24));return $<1?"Just now":$<60?`${$}m ago`:A<24?`${A}h ago`:N<7?`${N}d ago`:i.toLocaleDateString(void 0,{month:"short",day:"numeric",year:N>365?"numeric":void 0})},w=()=>{r("click",o.notification)};return(s,i)=>(a(),l("div",{class:S(["notification-item",{unread:!s.notification.read}]),onClick:w},[t("div",U,[t("div",O,[t("div",j,[t("h4",G,c(s.notification.listing_title),1),t("div",H,[e(L,{label:p.value,color:y.value,size:"xs"},null,8,["label","color"]),t("span",J,c(s.notification.alert_name),1)])]),t("div",Y,c(b(s.notification.created_at)),1)]),t("div",q,[e(n(f),{icon:"tabler:map-pin",class:"location-icon"}),t("span",null,c(k.value),1)])]),s.notification.read?g("",!0):(a(),l("div",K))],2))}}),Q=B(P,[["__scopeId","data-v-1418d186"]]),W={class:"notifications-view"},X={class:"notifications-container"},Z={class:"notifications-header"},tt={class:"header-actions"},it={class:"stats-section"},ot={class:"stat-card"},st={class:"stat-icon unread"},nt={class:"stat-content"},et={class:"stat-number"},at={class:"stat-card"},lt={class:"stat-icon total"},ct={class:"stat-content"},rt={class:"stat-number"},dt={key:0,class:"error-banner"},ft={class:"notifications-section"},ut={key:0,class:"loading-state"},_t={key:1,class:"empty-state"},mt={class:"empty-icon"},vt={key:2,class:"notifications-list"},gt={class:"list-header"},ht={class:"list-filters"},pt={class:"notifications-container-inner"},yt={key:0,class:"load-more-section"},kt=I({__name:"NotificationsView",setup(M){const h=F(),o=D(),r=T(!1),p=v(()=>r.value?o.unreadNotifications:o.notifications),y=()=>{r.value=!r.value},k=async()=>{try{await o.markAllAsRead()}catch{}},b=async s=>{s.read||await o.markAsRead(s.id),h.push({name:"show",params:{id:s.listing_id}})},w=async()=>{try{await o.loadMore()}catch{}};return V(()=>{o.initialize()}),(s,i)=>(a(),l("div",W,[t("div",X,[t("div",Z,[i[2]||(i[2]=t("div",{class:"header-content"},[t("h1",{class:"page-title"},"Notifications"),t("p",{class:"page-description"},"See when new listings match your alert areas.")],-1)),t("div",tt,[n(o).unreadCount>0?(a(),x(d,{key:0,variant:"outline",onClick:k,loading:n(o).loading,"icon-left":"tabler:check"},{default:_(()=>i[0]||(i[0]=[m(" Mark All Read ")])),_:1,__:[0]},8,["loading"])):g("",!0),e(d,{variant:"outline",link:{name:"alerts"},"icon-left":"tabler:settings"},{default:_(()=>i[1]||(i[1]=[m(" Manage Alerts ")])),_:1,__:[1]})])]),t("div",it,[t("div",ot,[t("div",st,[e(n(f),{icon:"tabler:bell",class:"w-6 h-6"})]),t("div",nt,[t("div",et,c(n(o).unreadCount),1),i[3]||(i[3]=t("div",{class:"stat-label"},"Unread",-1))])]),t("div",at,[t("div",lt,[e(n(f),{icon:"tabler:list",class:"w-6 h-6"})]),t("div",ct,[t("div",rt,c(n(o).notifications.length),1),i[4]||(i[4]=t("div",{class:"stat-label"},"Total",-1))])])]),n(o).error?(a(),l("div",dt,[e(n(f),{icon:"tabler:alert-triangle",class:"error-icon"}),t("span",null,c(n(o).error),1),e(d,{variant:"ghost",size:"sm","icon-left":"tabler:x",onClick:n(o).clearError,class:"error-close"},null,8,["onClick"])])):g("",!0),t("div",ft,[n(o).loading&&n(o).notifications.length===0?(a(),l("div",ut,[e(n(f),{icon:"svg-spinners:3-dots-bounce",class:"loading-spinner"}),i[5]||(i[5]=t("p",null,"Loading your notifications...",-1))])):!n(o).loading&&n(o).notifications.length===0?(a(),l("div",_t,[t("div",mt,[e(n(f),{icon:"tabler:bell-off",class:"w-16 h-16 text-gray-300"})]),i[7]||(i[7]=t("h3",{class:"empty-title"},"No notifications yet",-1)),i[8]||(i[8]=t("p",{class:"empty-description"}," You'll see notifications here when new listings match your alert areas. ",-1)),e(d,{link:{name:"alerts-create"},"icon-left":"tabler:plus",class:"mt-4"},{default:_(()=>i[6]||(i[6]=[m(" Create an Alert ")])),_:1,__:[6]})])):(a(),l("div",vt,[t("div",gt,[i[9]||(i[9]=t("h2",{class:"list-title"},"Recent Notifications",-1)),t("div",ht,[e(d,{variant:"ghost",size:"sm",class:S({"text-blue-600 bg-blue-50":r.value}),onClick:y},{default:_(()=>[m(c(r.value?"Show All":"Unread Only"),1)]),_:1},8,["class"])])]),t("div",pt,[(a(!0),l(z,null,E(p.value,u=>(a(),x(Q,{key:u.id,notification:u,onClick:b},null,8,["notification"]))),128))]),n(o).hasMore?(a(),l("div",yt,[e(d,{variant:"outline",onClick:w,loading:n(o).loading,class:"load-more-button"},{default:_(()=>i[10]||(i[10]=[m(" Load More ")])),_:1,__:[10]},8,["loading"])])):g("",!0)]))])])]))}}),$t=B(kt,[["__scopeId","data-v-5469977e"]]);export{$t as default};
//# sourceMappingURL=NotificationsView-UfI3pSTa.js.map
