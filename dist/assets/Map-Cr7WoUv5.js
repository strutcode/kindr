import{V as fs,d as iE,W as rE,k as wf,G as Cf,e as sE,f as oE,c as aE,a as Fl,o as lE,_ as hE}from"./index-WKext-pH.js";var qo={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */qo.exports;(function(r,t){(function(){var e,n="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",h="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",f=500,g="__lodash_placeholder__",_=1,p=2,x=4,v=1,w=2,R=1,T=2,S=4,b=8,O=16,M=32,F=64,z=128,B=256,H=512,it=30,gt="...",_t=800,ut=16,Gt=1,V=2,J=3,U=1/0,nt=9007199254740991,St=17976931348623157e292,xt=NaN,Ot=4294967295,X=Ot-1,$t=Ot>>>1,mt=[["ary",z],["bind",R],["bindKey",T],["curry",b],["curryRight",O],["flip",H],["partial",M],["partialRight",F],["rearg",B]],Et="[object Arguments]",Ge="[object Array]",ie="[object AsyncFunction]",me="[object Boolean]",pe="[object Date]",ti="[object DOMException]",Pn="[object Error]",hn="[object Function]",Oi="[object GeneratorFunction]",Vt="[object Map]",un="[object Number]",wn="[object Null]",Ae="[object Object]",Pi="[object Promise]",ir="[object Proxy]",qe="[object RegExp]",ye="[object Set]",Ht="[object String]",re="[object Symbol]",We="[object Undefined]",xe="[object WeakMap]",ei="[object WeakSet]",ze="[object ArrayBuffer]",Ee="[object DataView]",Cn="[object Float32Array]",ni="[object Float64Array]",jt="[object Int8Array]",Di="[object Int16Array]",Hr="[object Int32Array]",qr="[object Uint8Array]",rr="[object Uint8ClampedArray]",sr="[object Uint16Array]",Fi="[object Uint32Array]",Zs=/\b__p \+= '';/g,$r=/\b(__p \+=) '' \+/g,ki=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ii=/&(?:amp|lt|gt|quot|#39);/g,ri=/[&<>"']/g,Ks=RegExp(ii.source),Vs=RegExp(ri.source),ve=/<%-([\s\S]+?)%>/g,si=/<%([\s\S]+?)%>/g,we=/<%=([\s\S]+?)%>/g,cn=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ce=/^\w*$/,or=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,oi=/[\\^$.*+?()[\]{}|]/g,ae=RegExp(oi.source),le=/^\s+/,fn=/\s/,Ra=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ng=/\{\n\/\* \[wrapped with (.+)\] \*/,Gg=/,? & /,Wg=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,zg=/[()=,{}\[\]\/\s]/,Xg=/\\(\\)?/g,Bg=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qh=/\w*$/,Yg=/^[-+]0x[0-9a-f]+$/i,Ug=/^0b[01]+$/i,Zg=/^\[object .+?Constructor\]$/,Kg=/^0o[0-7]+$/i,Vg=/^(?:0|[1-9]\d*)$/,Hg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Hs=/($^)/,qg=/['\n\r\u2028\u2029\\]/g,qs="\\ud800-\\udfff",$g="\\u0300-\\u036f",jg="\\ufe20-\\ufe2f",Jg="\\u20d0-\\u20ff",$h=$g+jg+Jg,jh="\\u2700-\\u27bf",Jh="a-z\\xdf-\\xf6\\xf8-\\xff",Qg="\\xac\\xb1\\xd7\\xf7",t_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",e_="\\u2000-\\u206f",n_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Qh="A-Z\\xc0-\\xd6\\xd8-\\xde",tu="\\ufe0e\\ufe0f",eu=Qg+t_+e_+n_,Ta="['’]",i_="["+qs+"]",nu="["+eu+"]",$s="["+$h+"]",iu="\\d+",r_="["+jh+"]",ru="["+Jh+"]",su="[^"+qs+eu+iu+jh+Jh+Qh+"]",Ia="\\ud83c[\\udffb-\\udfff]",s_="(?:"+$s+"|"+Ia+")",ou="[^"+qs+"]",Sa="(?:\\ud83c[\\udde6-\\uddff]){2}",Aa="[\\ud800-\\udbff][\\udc00-\\udfff]",ar="["+Qh+"]",au="\\u200d",lu="(?:"+ru+"|"+su+")",o_="(?:"+ar+"|"+su+")",hu="(?:"+Ta+"(?:d|ll|m|re|s|t|ve))?",uu="(?:"+Ta+"(?:D|LL|M|RE|S|T|VE))?",cu=s_+"?",fu="["+tu+"]?",a_="(?:"+au+"(?:"+[ou,Sa,Aa].join("|")+")"+fu+cu+")*",l_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",h_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",du=fu+cu+a_,u_="(?:"+[r_,Sa,Aa].join("|")+")"+du,c_="(?:"+[ou+$s+"?",$s,Sa,Aa,i_].join("|")+")",f_=RegExp(Ta,"g"),d_=RegExp($s,"g"),La=RegExp(Ia+"(?="+Ia+")|"+c_+du,"g"),g_=RegExp([ar+"?"+ru+"+"+hu+"(?="+[nu,ar,"$"].join("|")+")",o_+"+"+uu+"(?="+[nu,ar+lu,"$"].join("|")+")",ar+"?"+lu+"+"+hu,ar+"+"+uu,h_,l_,iu,u_].join("|"),"g"),__=RegExp("["+au+qs+$h+tu+"]"),m_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,p_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],y_=-1,Nt={};Nt[Cn]=Nt[ni]=Nt[jt]=Nt[Di]=Nt[Hr]=Nt[qr]=Nt[rr]=Nt[sr]=Nt[Fi]=!0,Nt[Et]=Nt[Ge]=Nt[ze]=Nt[me]=Nt[Ee]=Nt[pe]=Nt[Pn]=Nt[hn]=Nt[Vt]=Nt[un]=Nt[Ae]=Nt[qe]=Nt[ye]=Nt[Ht]=Nt[xe]=!1;var Dt={};Dt[Et]=Dt[Ge]=Dt[ze]=Dt[Ee]=Dt[me]=Dt[pe]=Dt[Cn]=Dt[ni]=Dt[jt]=Dt[Di]=Dt[Hr]=Dt[Vt]=Dt[un]=Dt[Ae]=Dt[qe]=Dt[ye]=Dt[Ht]=Dt[re]=Dt[qr]=Dt[rr]=Dt[sr]=Dt[Fi]=!0,Dt[Pn]=Dt[hn]=Dt[xe]=!1;var x_={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},E_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},v_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},w_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},C_=parseFloat,R_=parseInt,gu=typeof fs=="object"&&fs&&fs.Object===Object&&fs,T_=typeof self=="object"&&self&&self.Object===Object&&self,se=gu||T_||Function("return this")(),ba=t&&!t.nodeType&&t,Ni=ba&&!0&&r&&!r.nodeType&&r,_u=Ni&&Ni.exports===ba,Ma=_u&&gu.process,$e=function(){try{var A=Ni&&Ni.require&&Ni.require("util").types;return A||Ma&&Ma.binding&&Ma.binding("util")}catch{}}(),mu=$e&&$e.isArrayBuffer,pu=$e&&$e.isDate,yu=$e&&$e.isMap,xu=$e&&$e.isRegExp,Eu=$e&&$e.isSet,vu=$e&&$e.isTypedArray;function Xe(A,D,P){switch(P.length){case 0:return A.call(D);case 1:return A.call(D,P[0]);case 2:return A.call(D,P[0],P[1]);case 3:return A.call(D,P[0],P[1],P[2])}return A.apply(D,P)}function I_(A,D,P,Z){for(var rt=-1,Rt=A==null?0:A.length;++rt<Rt;){var Jt=A[rt];D(Z,Jt,P(Jt),A)}return Z}function je(A,D){for(var P=-1,Z=A==null?0:A.length;++P<Z&&D(A[P],P,A)!==!1;);return A}function S_(A,D){for(var P=A==null?0:A.length;P--&&D(A[P],P,A)!==!1;);return A}function wu(A,D){for(var P=-1,Z=A==null?0:A.length;++P<Z;)if(!D(A[P],P,A))return!1;return!0}function ai(A,D){for(var P=-1,Z=A==null?0:A.length,rt=0,Rt=[];++P<Z;){var Jt=A[P];D(Jt,P,A)&&(Rt[rt++]=Jt)}return Rt}function js(A,D){var P=A==null?0:A.length;return!!P&&lr(A,D,0)>-1}function Oa(A,D,P){for(var Z=-1,rt=A==null?0:A.length;++Z<rt;)if(P(D,A[Z]))return!0;return!1}function Wt(A,D){for(var P=-1,Z=A==null?0:A.length,rt=Array(Z);++P<Z;)rt[P]=D(A[P],P,A);return rt}function li(A,D){for(var P=-1,Z=D.length,rt=A.length;++P<Z;)A[rt+P]=D[P];return A}function Pa(A,D,P,Z){var rt=-1,Rt=A==null?0:A.length;for(Z&&Rt&&(P=A[++rt]);++rt<Rt;)P=D(P,A[rt],rt,A);return P}function A_(A,D,P,Z){var rt=A==null?0:A.length;for(Z&&rt&&(P=A[--rt]);rt--;)P=D(P,A[rt],rt,A);return P}function Da(A,D){for(var P=-1,Z=A==null?0:A.length;++P<Z;)if(D(A[P],P,A))return!0;return!1}var L_=Fa("length");function b_(A){return A.split("")}function M_(A){return A.match(Wg)||[]}function Cu(A,D,P){var Z;return P(A,function(rt,Rt,Jt){if(D(rt,Rt,Jt))return Z=Rt,!1}),Z}function Js(A,D,P,Z){for(var rt=A.length,Rt=P+(Z?1:-1);Z?Rt--:++Rt<rt;)if(D(A[Rt],Rt,A))return Rt;return-1}function lr(A,D,P){return D===D?Y_(A,D,P):Js(A,Ru,P)}function O_(A,D,P,Z){for(var rt=P-1,Rt=A.length;++rt<Rt;)if(Z(A[rt],D))return rt;return-1}function Ru(A){return A!==A}function Tu(A,D){var P=A==null?0:A.length;return P?Na(A,D)/P:xt}function Fa(A){return function(D){return D==null?e:D[A]}}function ka(A){return function(D){return A==null?e:A[D]}}function Iu(A,D,P,Z,rt){return rt(A,function(Rt,Jt,Pt){P=Z?(Z=!1,Rt):D(P,Rt,Jt,Pt)}),P}function P_(A,D){var P=A.length;for(A.sort(D);P--;)A[P]=A[P].value;return A}function Na(A,D){for(var P,Z=-1,rt=A.length;++Z<rt;){var Rt=D(A[Z]);Rt!==e&&(P=P===e?Rt:P+Rt)}return P}function Ga(A,D){for(var P=-1,Z=Array(A);++P<A;)Z[P]=D(P);return Z}function D_(A,D){return Wt(D,function(P){return[P,A[P]]})}function Su(A){return A&&A.slice(0,Mu(A)+1).replace(le,"")}function Be(A){return function(D){return A(D)}}function Wa(A,D){return Wt(D,function(P){return A[P]})}function jr(A,D){return A.has(D)}function Au(A,D){for(var P=-1,Z=A.length;++P<Z&&lr(D,A[P],0)>-1;);return P}function Lu(A,D){for(var P=A.length;P--&&lr(D,A[P],0)>-1;);return P}function F_(A,D){for(var P=A.length,Z=0;P--;)A[P]===D&&++Z;return Z}var k_=ka(x_),N_=ka(E_);function G_(A){return"\\"+w_[A]}function W_(A,D){return A==null?e:A[D]}function hr(A){return __.test(A)}function z_(A){return m_.test(A)}function X_(A){for(var D,P=[];!(D=A.next()).done;)P.push(D.value);return P}function za(A){var D=-1,P=Array(A.size);return A.forEach(function(Z,rt){P[++D]=[rt,Z]}),P}function bu(A,D){return function(P){return A(D(P))}}function hi(A,D){for(var P=-1,Z=A.length,rt=0,Rt=[];++P<Z;){var Jt=A[P];(Jt===D||Jt===g)&&(A[P]=g,Rt[rt++]=P)}return Rt}function Qs(A){var D=-1,P=Array(A.size);return A.forEach(function(Z){P[++D]=Z}),P}function B_(A){var D=-1,P=Array(A.size);return A.forEach(function(Z){P[++D]=[Z,Z]}),P}function Y_(A,D,P){for(var Z=P-1,rt=A.length;++Z<rt;)if(A[Z]===D)return Z;return-1}function U_(A,D,P){for(var Z=P+1;Z--;)if(A[Z]===D)return Z;return Z}function ur(A){return hr(A)?K_(A):L_(A)}function dn(A){return hr(A)?V_(A):b_(A)}function Mu(A){for(var D=A.length;D--&&fn.test(A.charAt(D)););return D}var Z_=ka(v_);function K_(A){for(var D=La.lastIndex=0;La.test(A);)++D;return D}function V_(A){return A.match(La)||[]}function H_(A){return A.match(g_)||[]}var q_=function A(D){D=D==null?se:cr.defaults(se.Object(),D,cr.pick(se,p_));var P=D.Array,Z=D.Date,rt=D.Error,Rt=D.Function,Jt=D.Math,Pt=D.Object,Xa=D.RegExp,$_=D.String,Je=D.TypeError,to=P.prototype,j_=Rt.prototype,fr=Pt.prototype,eo=D["__core-js_shared__"],no=j_.toString,bt=fr.hasOwnProperty,J_=0,Ou=function(){var i=/[^.]+$/.exec(eo&&eo.keys&&eo.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),io=fr.toString,Q_=no.call(Pt),tm=se._,em=Xa("^"+no.call(bt).replace(oi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ro=_u?D.Buffer:e,ui=D.Symbol,so=D.Uint8Array,Pu=ro?ro.allocUnsafe:e,oo=bu(Pt.getPrototypeOf,Pt),Du=Pt.create,Fu=fr.propertyIsEnumerable,ao=to.splice,ku=ui?ui.isConcatSpreadable:e,Jr=ui?ui.iterator:e,Gi=ui?ui.toStringTag:e,lo=function(){try{var i=Yi(Pt,"defineProperty");return i({},"",{}),i}catch{}}(),nm=D.clearTimeout!==se.clearTimeout&&D.clearTimeout,im=Z&&Z.now!==se.Date.now&&Z.now,rm=D.setTimeout!==se.setTimeout&&D.setTimeout,ho=Jt.ceil,uo=Jt.floor,Ba=Pt.getOwnPropertySymbols,sm=ro?ro.isBuffer:e,Nu=D.isFinite,om=to.join,am=bu(Pt.keys,Pt),Qt=Jt.max,he=Jt.min,lm=Z.now,hm=D.parseInt,Gu=Jt.random,um=to.reverse,Ya=Yi(D,"DataView"),Qr=Yi(D,"Map"),Ua=Yi(D,"Promise"),dr=Yi(D,"Set"),ts=Yi(D,"WeakMap"),es=Yi(Pt,"create"),co=ts&&new ts,gr={},cm=Ui(Ya),fm=Ui(Qr),dm=Ui(Ua),gm=Ui(dr),_m=Ui(ts),fo=ui?ui.prototype:e,ns=fo?fo.valueOf:e,Wu=fo?fo.toString:e;function y(i){if(Bt(i)&&!st(i)&&!(i instanceof pt)){if(i instanceof Qe)return i;if(bt.call(i,"__wrapped__"))return zc(i)}return new Qe(i)}var _r=function(){function i(){}return function(o){if(!Xt(o))return{};if(Du)return Du(o);i.prototype=o;var u=new i;return i.prototype=e,u}}();function go(){}function Qe(i,o){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}y.templateSettings={escape:ve,evaluate:si,interpolate:we,variable:"",imports:{_:y}},y.prototype=go.prototype,y.prototype.constructor=y,Qe.prototype=_r(go.prototype),Qe.prototype.constructor=Qe;function pt(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Ot,this.__views__=[]}function mm(){var i=new pt(this.__wrapped__);return i.__actions__=Le(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=Le(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=Le(this.__views__),i}function pm(){if(this.__filtered__){var i=new pt(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function ym(){var i=this.__wrapped__.value(),o=this.__dir__,u=st(i),d=o<0,m=u?i.length:0,E=bp(0,m,this.__views__),C=E.start,I=E.end,L=I-C,k=d?I:C-1,N=this.__iteratees__,W=N.length,Y=0,K=he(L,this.__takeCount__);if(!u||!d&&m==L&&K==L)return hc(i,this.__actions__);var tt=[];t:for(;L--&&Y<K;){k+=o;for(var lt=-1,et=i[k];++lt<W;){var dt=N[lt],yt=dt.iteratee,Ze=dt.type,Ie=yt(et);if(Ze==V)et=Ie;else if(!Ie){if(Ze==Gt)continue t;break t}}tt[Y++]=et}return tt}pt.prototype=_r(go.prototype),pt.prototype.constructor=pt;function Wi(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var d=i[o];this.set(d[0],d[1])}}function xm(){this.__data__=es?es(null):{},this.size=0}function Em(i){var o=this.has(i)&&delete this.__data__[i];return this.size-=o?1:0,o}function vm(i){var o=this.__data__;if(es){var u=o[i];return u===c?e:u}return bt.call(o,i)?o[i]:e}function wm(i){var o=this.__data__;return es?o[i]!==e:bt.call(o,i)}function Cm(i,o){var u=this.__data__;return this.size+=this.has(i)?0:1,u[i]=es&&o===e?c:o,this}Wi.prototype.clear=xm,Wi.prototype.delete=Em,Wi.prototype.get=vm,Wi.prototype.has=wm,Wi.prototype.set=Cm;function Dn(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var d=i[o];this.set(d[0],d[1])}}function Rm(){this.__data__=[],this.size=0}function Tm(i){var o=this.__data__,u=_o(o,i);if(u<0)return!1;var d=o.length-1;return u==d?o.pop():ao.call(o,u,1),--this.size,!0}function Im(i){var o=this.__data__,u=_o(o,i);return u<0?e:o[u][1]}function Sm(i){return _o(this.__data__,i)>-1}function Am(i,o){var u=this.__data__,d=_o(u,i);return d<0?(++this.size,u.push([i,o])):u[d][1]=o,this}Dn.prototype.clear=Rm,Dn.prototype.delete=Tm,Dn.prototype.get=Im,Dn.prototype.has=Sm,Dn.prototype.set=Am;function Fn(i){var o=-1,u=i==null?0:i.length;for(this.clear();++o<u;){var d=i[o];this.set(d[0],d[1])}}function Lm(){this.size=0,this.__data__={hash:new Wi,map:new(Qr||Dn),string:new Wi}}function bm(i){var o=So(this,i).delete(i);return this.size-=o?1:0,o}function Mm(i){return So(this,i).get(i)}function Om(i){return So(this,i).has(i)}function Pm(i,o){var u=So(this,i),d=u.size;return u.set(i,o),this.size+=u.size==d?0:1,this}Fn.prototype.clear=Lm,Fn.prototype.delete=bm,Fn.prototype.get=Mm,Fn.prototype.has=Om,Fn.prototype.set=Pm;function zi(i){var o=-1,u=i==null?0:i.length;for(this.__data__=new Fn;++o<u;)this.add(i[o])}function Dm(i){return this.__data__.set(i,c),this}function Fm(i){return this.__data__.has(i)}zi.prototype.add=zi.prototype.push=Dm,zi.prototype.has=Fm;function gn(i){var o=this.__data__=new Dn(i);this.size=o.size}function km(){this.__data__=new Dn,this.size=0}function Nm(i){var o=this.__data__,u=o.delete(i);return this.size=o.size,u}function Gm(i){return this.__data__.get(i)}function Wm(i){return this.__data__.has(i)}function zm(i,o){var u=this.__data__;if(u instanceof Dn){var d=u.__data__;if(!Qr||d.length<s-1)return d.push([i,o]),this.size=++u.size,this;u=this.__data__=new Fn(d)}return u.set(i,o),this.size=u.size,this}gn.prototype.clear=km,gn.prototype.delete=Nm,gn.prototype.get=Gm,gn.prototype.has=Wm,gn.prototype.set=zm;function zu(i,o){var u=st(i),d=!u&&Zi(i),m=!u&&!d&&_i(i),E=!u&&!d&&!m&&xr(i),C=u||d||m||E,I=C?Ga(i.length,$_):[],L=I.length;for(var k in i)(o||bt.call(i,k))&&!(C&&(k=="length"||m&&(k=="offset"||k=="parent")||E&&(k=="buffer"||k=="byteLength"||k=="byteOffset")||Wn(k,L)))&&I.push(k);return I}function Xu(i){var o=i.length;return o?i[el(0,o-1)]:e}function Xm(i,o){return Ao(Le(i),Xi(o,0,i.length))}function Bm(i){return Ao(Le(i))}function Za(i,o,u){(u!==e&&!_n(i[o],u)||u===e&&!(o in i))&&kn(i,o,u)}function is(i,o,u){var d=i[o];(!(bt.call(i,o)&&_n(d,u))||u===e&&!(o in i))&&kn(i,o,u)}function _o(i,o){for(var u=i.length;u--;)if(_n(i[u][0],o))return u;return-1}function Ym(i,o,u,d){return ci(i,function(m,E,C){o(d,m,u(m),C)}),d}function Bu(i,o){return i&&Tn(o,te(o),i)}function Um(i,o){return i&&Tn(o,Me(o),i)}function kn(i,o,u){o=="__proto__"&&lo?lo(i,o,{configurable:!0,enumerable:!0,value:u,writable:!0}):i[o]=u}function Ka(i,o){for(var u=-1,d=o.length,m=P(d),E=i==null;++u<d;)m[u]=E?e:Il(i,o[u]);return m}function Xi(i,o,u){return i===i&&(u!==e&&(i=i<=u?i:u),o!==e&&(i=i>=o?i:o)),i}function tn(i,o,u,d,m,E){var C,I=o&_,L=o&p,k=o&x;if(u&&(C=m?u(i,d,m,E):u(i)),C!==e)return C;if(!Xt(i))return i;var N=st(i);if(N){if(C=Op(i),!I)return Le(i,C)}else{var W=ue(i),Y=W==hn||W==Oi;if(_i(i))return fc(i,I);if(W==Ae||W==Et||Y&&!m){if(C=L||Y?{}:Mc(i),!I)return L?vp(i,Um(C,i)):Ep(i,Bu(C,i))}else{if(!Dt[W])return m?i:{};C=Pp(i,W,I)}}E||(E=new gn);var K=E.get(i);if(K)return K;E.set(i,C),af(i)?i.forEach(function(et){C.add(tn(et,o,u,et,i,E))}):sf(i)&&i.forEach(function(et,dt){C.set(dt,tn(et,o,u,dt,i,E))});var tt=k?L?fl:cl:L?Me:te,lt=N?e:tt(i);return je(lt||i,function(et,dt){lt&&(dt=et,et=i[dt]),is(C,dt,tn(et,o,u,dt,i,E))}),C}function Zm(i){var o=te(i);return function(u){return Yu(u,i,o)}}function Yu(i,o,u){var d=u.length;if(i==null)return!d;for(i=Pt(i);d--;){var m=u[d],E=o[m],C=i[m];if(C===e&&!(m in i)||!E(C))return!1}return!0}function Uu(i,o,u){if(typeof i!="function")throw new Je(l);return us(function(){i.apply(e,u)},o)}function rs(i,o,u,d){var m=-1,E=js,C=!0,I=i.length,L=[],k=o.length;if(!I)return L;u&&(o=Wt(o,Be(u))),d?(E=Oa,C=!1):o.length>=s&&(E=jr,C=!1,o=new zi(o));t:for(;++m<I;){var N=i[m],W=u==null?N:u(N);if(N=d||N!==0?N:0,C&&W===W){for(var Y=k;Y--;)if(o[Y]===W)continue t;L.push(N)}else E(o,W,d)||L.push(N)}return L}var ci=pc(Rn),Zu=pc(Ha,!0);function Km(i,o){var u=!0;return ci(i,function(d,m,E){return u=!!o(d,m,E),u}),u}function mo(i,o,u){for(var d=-1,m=i.length;++d<m;){var E=i[d],C=o(E);if(C!=null&&(I===e?C===C&&!Ue(C):u(C,I)))var I=C,L=E}return L}function Vm(i,o,u,d){var m=i.length;for(u=at(u),u<0&&(u=-u>m?0:m+u),d=d===e||d>m?m:at(d),d<0&&(d+=m),d=u>d?0:hf(d);u<d;)i[u++]=o;return i}function Ku(i,o){var u=[];return ci(i,function(d,m,E){o(d,m,E)&&u.push(d)}),u}function oe(i,o,u,d,m){var E=-1,C=i.length;for(u||(u=Fp),m||(m=[]);++E<C;){var I=i[E];o>0&&u(I)?o>1?oe(I,o-1,u,d,m):li(m,I):d||(m[m.length]=I)}return m}var Va=yc(),Vu=yc(!0);function Rn(i,o){return i&&Va(i,o,te)}function Ha(i,o){return i&&Vu(i,o,te)}function po(i,o){return ai(o,function(u){return zn(i[u])})}function Bi(i,o){o=di(o,i);for(var u=0,d=o.length;i!=null&&u<d;)i=i[In(o[u++])];return u&&u==d?i:e}function Hu(i,o,u){var d=o(i);return st(i)?d:li(d,u(i))}function Re(i){return i==null?i===e?We:wn:Gi&&Gi in Pt(i)?Lp(i):Bp(i)}function qa(i,o){return i>o}function Hm(i,o){return i!=null&&bt.call(i,o)}function qm(i,o){return i!=null&&o in Pt(i)}function $m(i,o,u){return i>=he(o,u)&&i<Qt(o,u)}function $a(i,o,u){for(var d=u?Oa:js,m=i[0].length,E=i.length,C=E,I=P(E),L=1/0,k=[];C--;){var N=i[C];C&&o&&(N=Wt(N,Be(o))),L=he(N.length,L),I[C]=!u&&(o||m>=120&&N.length>=120)?new zi(C&&N):e}N=i[0];var W=-1,Y=I[0];t:for(;++W<m&&k.length<L;){var K=N[W],tt=o?o(K):K;if(K=u||K!==0?K:0,!(Y?jr(Y,tt):d(k,tt,u))){for(C=E;--C;){var lt=I[C];if(!(lt?jr(lt,tt):d(i[C],tt,u)))continue t}Y&&Y.push(tt),k.push(K)}}return k}function jm(i,o,u,d){return Rn(i,function(m,E,C){o(d,u(m),E,C)}),d}function ss(i,o,u){o=di(o,i),i=Fc(i,o);var d=i==null?i:i[In(nn(o))];return d==null?e:Xe(d,i,u)}function qu(i){return Bt(i)&&Re(i)==Et}function Jm(i){return Bt(i)&&Re(i)==ze}function Qm(i){return Bt(i)&&Re(i)==pe}function os(i,o,u,d,m){return i===o?!0:i==null||o==null||!Bt(i)&&!Bt(o)?i!==i&&o!==o:tp(i,o,u,d,os,m)}function tp(i,o,u,d,m,E){var C=st(i),I=st(o),L=C?Ge:ue(i),k=I?Ge:ue(o);L=L==Et?Ae:L,k=k==Et?Ae:k;var N=L==Ae,W=k==Ae,Y=L==k;if(Y&&_i(i)){if(!_i(o))return!1;C=!0,N=!1}if(Y&&!N)return E||(E=new gn),C||xr(i)?Ac(i,o,u,d,m,E):Sp(i,o,L,u,d,m,E);if(!(u&v)){var K=N&&bt.call(i,"__wrapped__"),tt=W&&bt.call(o,"__wrapped__");if(K||tt){var lt=K?i.value():i,et=tt?o.value():o;return E||(E=new gn),m(lt,et,u,d,E)}}return Y?(E||(E=new gn),Ap(i,o,u,d,m,E)):!1}function ep(i){return Bt(i)&&ue(i)==Vt}function ja(i,o,u,d){var m=u.length,E=m,C=!d;if(i==null)return!E;for(i=Pt(i);m--;){var I=u[m];if(C&&I[2]?I[1]!==i[I[0]]:!(I[0]in i))return!1}for(;++m<E;){I=u[m];var L=I[0],k=i[L],N=I[1];if(C&&I[2]){if(k===e&&!(L in i))return!1}else{var W=new gn;if(d)var Y=d(k,N,L,i,o,W);if(!(Y===e?os(N,k,v|w,d,W):Y))return!1}}return!0}function $u(i){if(!Xt(i)||Np(i))return!1;var o=zn(i)?em:Zg;return o.test(Ui(i))}function np(i){return Bt(i)&&Re(i)==qe}function ip(i){return Bt(i)&&ue(i)==ye}function rp(i){return Bt(i)&&Do(i.length)&&!!Nt[Re(i)]}function ju(i){return typeof i=="function"?i:i==null?Oe:typeof i=="object"?st(i)?tc(i[0],i[1]):Qu(i):Ef(i)}function Ja(i){if(!hs(i))return am(i);var o=[];for(var u in Pt(i))bt.call(i,u)&&u!="constructor"&&o.push(u);return o}function sp(i){if(!Xt(i))return Xp(i);var o=hs(i),u=[];for(var d in i)d=="constructor"&&(o||!bt.call(i,d))||u.push(d);return u}function Qa(i,o){return i<o}function Ju(i,o){var u=-1,d=be(i)?P(i.length):[];return ci(i,function(m,E,C){d[++u]=o(m,E,C)}),d}function Qu(i){var o=gl(i);return o.length==1&&o[0][2]?Pc(o[0][0],o[0][1]):function(u){return u===i||ja(u,i,o)}}function tc(i,o){return ml(i)&&Oc(o)?Pc(In(i),o):function(u){var d=Il(u,i);return d===e&&d===o?Sl(u,i):os(o,d,v|w)}}function yo(i,o,u,d,m){i!==o&&Va(o,function(E,C){if(m||(m=new gn),Xt(E))op(i,o,C,u,yo,d,m);else{var I=d?d(yl(i,C),E,C+"",i,o,m):e;I===e&&(I=E),Za(i,C,I)}},Me)}function op(i,o,u,d,m,E,C){var I=yl(i,u),L=yl(o,u),k=C.get(L);if(k){Za(i,u,k);return}var N=E?E(I,L,u+"",i,o,C):e,W=N===e;if(W){var Y=st(L),K=!Y&&_i(L),tt=!Y&&!K&&xr(L);N=L,Y||K||tt?st(I)?N=I:Ut(I)?N=Le(I):K?(W=!1,N=fc(L,!0)):tt?(W=!1,N=dc(L,!0)):N=[]:cs(L)||Zi(L)?(N=I,Zi(I)?N=uf(I):(!Xt(I)||zn(I))&&(N=Mc(L))):W=!1}W&&(C.set(L,N),m(N,L,d,E,C),C.delete(L)),Za(i,u,N)}function ec(i,o){var u=i.length;if(u)return o+=o<0?u:0,Wn(o,u)?i[o]:e}function nc(i,o,u){o.length?o=Wt(o,function(E){return st(E)?function(C){return Bi(C,E.length===1?E[0]:E)}:E}):o=[Oe];var d=-1;o=Wt(o,Be(Q()));var m=Ju(i,function(E,C,I){var L=Wt(o,function(k){return k(E)});return{criteria:L,index:++d,value:E}});return P_(m,function(E,C){return xp(E,C,u)})}function ap(i,o){return ic(i,o,function(u,d){return Sl(i,d)})}function ic(i,o,u){for(var d=-1,m=o.length,E={};++d<m;){var C=o[d],I=Bi(i,C);u(I,C)&&as(E,di(C,i),I)}return E}function lp(i){return function(o){return Bi(o,i)}}function tl(i,o,u,d){var m=d?O_:lr,E=-1,C=o.length,I=i;for(i===o&&(o=Le(o)),u&&(I=Wt(i,Be(u)));++E<C;)for(var L=0,k=o[E],N=u?u(k):k;(L=m(I,N,L,d))>-1;)I!==i&&ao.call(I,L,1),ao.call(i,L,1);return i}function rc(i,o){for(var u=i?o.length:0,d=u-1;u--;){var m=o[u];if(u==d||m!==E){var E=m;Wn(m)?ao.call(i,m,1):rl(i,m)}}return i}function el(i,o){return i+uo(Gu()*(o-i+1))}function hp(i,o,u,d){for(var m=-1,E=Qt(ho((o-i)/(u||1)),0),C=P(E);E--;)C[d?E:++m]=i,i+=u;return C}function nl(i,o){var u="";if(!i||o<1||o>nt)return u;do o%2&&(u+=i),o=uo(o/2),o&&(i+=i);while(o);return u}function ct(i,o){return xl(Dc(i,o,Oe),i+"")}function up(i){return Xu(Er(i))}function cp(i,o){var u=Er(i);return Ao(u,Xi(o,0,u.length))}function as(i,o,u,d){if(!Xt(i))return i;o=di(o,i);for(var m=-1,E=o.length,C=E-1,I=i;I!=null&&++m<E;){var L=In(o[m]),k=u;if(L==="__proto__"||L==="constructor"||L==="prototype")return i;if(m!=C){var N=I[L];k=d?d(N,L,I):e,k===e&&(k=Xt(N)?N:Wn(o[m+1])?[]:{})}is(I,L,k),I=I[L]}return i}var sc=co?function(i,o){return co.set(i,o),i}:Oe,fp=lo?function(i,o){return lo(i,"toString",{configurable:!0,enumerable:!1,value:Ll(o),writable:!0})}:Oe;function dp(i){return Ao(Er(i))}function en(i,o,u){var d=-1,m=i.length;o<0&&(o=-o>m?0:m+o),u=u>m?m:u,u<0&&(u+=m),m=o>u?0:u-o>>>0,o>>>=0;for(var E=P(m);++d<m;)E[d]=i[d+o];return E}function gp(i,o){var u;return ci(i,function(d,m,E){return u=o(d,m,E),!u}),!!u}function xo(i,o,u){var d=0,m=i==null?d:i.length;if(typeof o=="number"&&o===o&&m<=$t){for(;d<m;){var E=d+m>>>1,C=i[E];C!==null&&!Ue(C)&&(u?C<=o:C<o)?d=E+1:m=E}return m}return il(i,o,Oe,u)}function il(i,o,u,d){var m=0,E=i==null?0:i.length;if(E===0)return 0;o=u(o);for(var C=o!==o,I=o===null,L=Ue(o),k=o===e;m<E;){var N=uo((m+E)/2),W=u(i[N]),Y=W!==e,K=W===null,tt=W===W,lt=Ue(W);if(C)var et=d||tt;else k?et=tt&&(d||Y):I?et=tt&&Y&&(d||!K):L?et=tt&&Y&&!K&&(d||!lt):K||lt?et=!1:et=d?W<=o:W<o;et?m=N+1:E=N}return he(E,X)}function oc(i,o){for(var u=-1,d=i.length,m=0,E=[];++u<d;){var C=i[u],I=o?o(C):C;if(!u||!_n(I,L)){var L=I;E[m++]=C===0?0:C}}return E}function ac(i){return typeof i=="number"?i:Ue(i)?xt:+i}function Ye(i){if(typeof i=="string")return i;if(st(i))return Wt(i,Ye)+"";if(Ue(i))return Wu?Wu.call(i):"";var o=i+"";return o=="0"&&1/i==-U?"-0":o}function fi(i,o,u){var d=-1,m=js,E=i.length,C=!0,I=[],L=I;if(u)C=!1,m=Oa;else if(E>=s){var k=o?null:Tp(i);if(k)return Qs(k);C=!1,m=jr,L=new zi}else L=o?[]:I;t:for(;++d<E;){var N=i[d],W=o?o(N):N;if(N=u||N!==0?N:0,C&&W===W){for(var Y=L.length;Y--;)if(L[Y]===W)continue t;o&&L.push(W),I.push(N)}else m(L,W,u)||(L!==I&&L.push(W),I.push(N))}return I}function rl(i,o){return o=di(o,i),i=Fc(i,o),i==null||delete i[In(nn(o))]}function lc(i,o,u,d){return as(i,o,u(Bi(i,o)),d)}function Eo(i,o,u,d){for(var m=i.length,E=d?m:-1;(d?E--:++E<m)&&o(i[E],E,i););return u?en(i,d?0:E,d?E+1:m):en(i,d?E+1:0,d?m:E)}function hc(i,o){var u=i;return u instanceof pt&&(u=u.value()),Pa(o,function(d,m){return m.func.apply(m.thisArg,li([d],m.args))},u)}function sl(i,o,u){var d=i.length;if(d<2)return d?fi(i[0]):[];for(var m=-1,E=P(d);++m<d;)for(var C=i[m],I=-1;++I<d;)I!=m&&(E[m]=rs(E[m]||C,i[I],o,u));return fi(oe(E,1),o,u)}function uc(i,o,u){for(var d=-1,m=i.length,E=o.length,C={};++d<m;){var I=d<E?o[d]:e;u(C,i[d],I)}return C}function ol(i){return Ut(i)?i:[]}function al(i){return typeof i=="function"?i:Oe}function di(i,o){return st(i)?i:ml(i,o)?[i]:Wc(At(i))}var _p=ct;function gi(i,o,u){var d=i.length;return u=u===e?d:u,!o&&u>=d?i:en(i,o,u)}var cc=nm||function(i){return se.clearTimeout(i)};function fc(i,o){if(o)return i.slice();var u=i.length,d=Pu?Pu(u):new i.constructor(u);return i.copy(d),d}function ll(i){var o=new i.constructor(i.byteLength);return new so(o).set(new so(i)),o}function mp(i,o){var u=o?ll(i.buffer):i.buffer;return new i.constructor(u,i.byteOffset,i.byteLength)}function pp(i){var o=new i.constructor(i.source,qh.exec(i));return o.lastIndex=i.lastIndex,o}function yp(i){return ns?Pt(ns.call(i)):{}}function dc(i,o){var u=o?ll(i.buffer):i.buffer;return new i.constructor(u,i.byteOffset,i.length)}function gc(i,o){if(i!==o){var u=i!==e,d=i===null,m=i===i,E=Ue(i),C=o!==e,I=o===null,L=o===o,k=Ue(o);if(!I&&!k&&!E&&i>o||E&&C&&L&&!I&&!k||d&&C&&L||!u&&L||!m)return 1;if(!d&&!E&&!k&&i<o||k&&u&&m&&!d&&!E||I&&u&&m||!C&&m||!L)return-1}return 0}function xp(i,o,u){for(var d=-1,m=i.criteria,E=o.criteria,C=m.length,I=u.length;++d<C;){var L=gc(m[d],E[d]);if(L){if(d>=I)return L;var k=u[d];return L*(k=="desc"?-1:1)}}return i.index-o.index}function _c(i,o,u,d){for(var m=-1,E=i.length,C=u.length,I=-1,L=o.length,k=Qt(E-C,0),N=P(L+k),W=!d;++I<L;)N[I]=o[I];for(;++m<C;)(W||m<E)&&(N[u[m]]=i[m]);for(;k--;)N[I++]=i[m++];return N}function mc(i,o,u,d){for(var m=-1,E=i.length,C=-1,I=u.length,L=-1,k=o.length,N=Qt(E-I,0),W=P(N+k),Y=!d;++m<N;)W[m]=i[m];for(var K=m;++L<k;)W[K+L]=o[L];for(;++C<I;)(Y||m<E)&&(W[K+u[C]]=i[m++]);return W}function Le(i,o){var u=-1,d=i.length;for(o||(o=P(d));++u<d;)o[u]=i[u];return o}function Tn(i,o,u,d){var m=!u;u||(u={});for(var E=-1,C=o.length;++E<C;){var I=o[E],L=d?d(u[I],i[I],I,u,i):e;L===e&&(L=i[I]),m?kn(u,I,L):is(u,I,L)}return u}function Ep(i,o){return Tn(i,_l(i),o)}function vp(i,o){return Tn(i,Lc(i),o)}function vo(i,o){return function(u,d){var m=st(u)?I_:Ym,E=o?o():{};return m(u,i,Q(d,2),E)}}function mr(i){return ct(function(o,u){var d=-1,m=u.length,E=m>1?u[m-1]:e,C=m>2?u[2]:e;for(E=i.length>3&&typeof E=="function"?(m--,E):e,C&&Te(u[0],u[1],C)&&(E=m<3?e:E,m=1),o=Pt(o);++d<m;){var I=u[d];I&&i(o,I,d,E)}return o})}function pc(i,o){return function(u,d){if(u==null)return u;if(!be(u))return i(u,d);for(var m=u.length,E=o?m:-1,C=Pt(u);(o?E--:++E<m)&&d(C[E],E,C)!==!1;);return u}}function yc(i){return function(o,u,d){for(var m=-1,E=Pt(o),C=d(o),I=C.length;I--;){var L=C[i?I:++m];if(u(E[L],L,E)===!1)break}return o}}function wp(i,o,u){var d=o&R,m=ls(i);function E(){var C=this&&this!==se&&this instanceof E?m:i;return C.apply(d?u:this,arguments)}return E}function xc(i){return function(o){o=At(o);var u=hr(o)?dn(o):e,d=u?u[0]:o.charAt(0),m=u?gi(u,1).join(""):o.slice(1);return d[i]()+m}}function pr(i){return function(o){return Pa(yf(pf(o).replace(f_,"")),i,"")}}function ls(i){return function(){var o=arguments;switch(o.length){case 0:return new i;case 1:return new i(o[0]);case 2:return new i(o[0],o[1]);case 3:return new i(o[0],o[1],o[2]);case 4:return new i(o[0],o[1],o[2],o[3]);case 5:return new i(o[0],o[1],o[2],o[3],o[4]);case 6:return new i(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new i(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var u=_r(i.prototype),d=i.apply(u,o);return Xt(d)?d:u}}function Cp(i,o,u){var d=ls(i);function m(){for(var E=arguments.length,C=P(E),I=E,L=yr(m);I--;)C[I]=arguments[I];var k=E<3&&C[0]!==L&&C[E-1]!==L?[]:hi(C,L);if(E-=k.length,E<u)return Rc(i,o,wo,m.placeholder,e,C,k,e,e,u-E);var N=this&&this!==se&&this instanceof m?d:i;return Xe(N,this,C)}return m}function Ec(i){return function(o,u,d){var m=Pt(o);if(!be(o)){var E=Q(u,3);o=te(o),u=function(I){return E(m[I],I,m)}}var C=i(o,u,d);return C>-1?m[E?o[C]:C]:e}}function vc(i){return Gn(function(o){var u=o.length,d=u,m=Qe.prototype.thru;for(i&&o.reverse();d--;){var E=o[d];if(typeof E!="function")throw new Je(l);if(m&&!C&&Io(E)=="wrapper")var C=new Qe([],!0)}for(d=C?d:u;++d<u;){E=o[d];var I=Io(E),L=I=="wrapper"?dl(E):e;L&&pl(L[0])&&L[1]==(z|b|M|B)&&!L[4].length&&L[9]==1?C=C[Io(L[0])].apply(C,L[3]):C=E.length==1&&pl(E)?C[I]():C.thru(E)}return function(){var k=arguments,N=k[0];if(C&&k.length==1&&st(N))return C.plant(N).value();for(var W=0,Y=u?o[W].apply(this,k):N;++W<u;)Y=o[W].call(this,Y);return Y}})}function wo(i,o,u,d,m,E,C,I,L,k){var N=o&z,W=o&R,Y=o&T,K=o&(b|O),tt=o&H,lt=Y?e:ls(i);function et(){for(var dt=arguments.length,yt=P(dt),Ze=dt;Ze--;)yt[Ze]=arguments[Ze];if(K)var Ie=yr(et),Ke=F_(yt,Ie);if(d&&(yt=_c(yt,d,m,K)),E&&(yt=mc(yt,E,C,K)),dt-=Ke,K&&dt<k){var Zt=hi(yt,Ie);return Rc(i,o,wo,et.placeholder,u,yt,Zt,I,L,k-dt)}var mn=W?u:this,Bn=Y?mn[i]:i;return dt=yt.length,I?yt=Yp(yt,I):tt&&dt>1&&yt.reverse(),N&&L<dt&&(yt.length=L),this&&this!==se&&this instanceof et&&(Bn=lt||ls(Bn)),Bn.apply(mn,yt)}return et}function wc(i,o){return function(u,d){return jm(u,i,o(d),{})}}function Co(i,o){return function(u,d){var m;if(u===e&&d===e)return o;if(u!==e&&(m=u),d!==e){if(m===e)return d;typeof u=="string"||typeof d=="string"?(u=Ye(u),d=Ye(d)):(u=ac(u),d=ac(d)),m=i(u,d)}return m}}function hl(i){return Gn(function(o){return o=Wt(o,Be(Q())),ct(function(u){var d=this;return i(o,function(m){return Xe(m,d,u)})})})}function Ro(i,o){o=o===e?" ":Ye(o);var u=o.length;if(u<2)return u?nl(o,i):o;var d=nl(o,ho(i/ur(o)));return hr(o)?gi(dn(d),0,i).join(""):d.slice(0,i)}function Rp(i,o,u,d){var m=o&R,E=ls(i);function C(){for(var I=-1,L=arguments.length,k=-1,N=d.length,W=P(N+L),Y=this&&this!==se&&this instanceof C?E:i;++k<N;)W[k]=d[k];for(;L--;)W[k++]=arguments[++I];return Xe(Y,m?u:this,W)}return C}function Cc(i){return function(o,u,d){return d&&typeof d!="number"&&Te(o,u,d)&&(u=d=e),o=Xn(o),u===e?(u=o,o=0):u=Xn(u),d=d===e?o<u?1:-1:Xn(d),hp(o,u,d,i)}}function To(i){return function(o,u){return typeof o=="string"&&typeof u=="string"||(o=rn(o),u=rn(u)),i(o,u)}}function Rc(i,o,u,d,m,E,C,I,L,k){var N=o&b,W=N?C:e,Y=N?e:C,K=N?E:e,tt=N?e:E;o|=N?M:F,o&=~(N?F:M),o&S||(o&=-4);var lt=[i,o,m,K,W,tt,Y,I,L,k],et=u.apply(e,lt);return pl(i)&&kc(et,lt),et.placeholder=d,Nc(et,i,o)}function ul(i){var o=Jt[i];return function(u,d){if(u=rn(u),d=d==null?0:he(at(d),292),d&&Nu(u)){var m=(At(u)+"e").split("e"),E=o(m[0]+"e"+(+m[1]+d));return m=(At(E)+"e").split("e"),+(m[0]+"e"+(+m[1]-d))}return o(u)}}var Tp=dr&&1/Qs(new dr([,-0]))[1]==U?function(i){return new dr(i)}:Ol;function Tc(i){return function(o){var u=ue(o);return u==Vt?za(o):u==ye?B_(o):D_(o,i(o))}}function Nn(i,o,u,d,m,E,C,I){var L=o&T;if(!L&&typeof i!="function")throw new Je(l);var k=d?d.length:0;if(k||(o&=-97,d=m=e),C=C===e?C:Qt(at(C),0),I=I===e?I:at(I),k-=m?m.length:0,o&F){var N=d,W=m;d=m=e}var Y=L?e:dl(i),K=[i,o,u,d,m,N,W,E,C,I];if(Y&&zp(K,Y),i=K[0],o=K[1],u=K[2],d=K[3],m=K[4],I=K[9]=K[9]===e?L?0:i.length:Qt(K[9]-k,0),!I&&o&(b|O)&&(o&=-25),!o||o==R)var tt=wp(i,o,u);else o==b||o==O?tt=Cp(i,o,I):(o==M||o==(R|M))&&!m.length?tt=Rp(i,o,u,d):tt=wo.apply(e,K);var lt=Y?sc:kc;return Nc(lt(tt,K),i,o)}function Ic(i,o,u,d){return i===e||_n(i,fr[u])&&!bt.call(d,u)?o:i}function Sc(i,o,u,d,m,E){return Xt(i)&&Xt(o)&&(E.set(o,i),yo(i,o,e,Sc,E),E.delete(o)),i}function Ip(i){return cs(i)?e:i}function Ac(i,o,u,d,m,E){var C=u&v,I=i.length,L=o.length;if(I!=L&&!(C&&L>I))return!1;var k=E.get(i),N=E.get(o);if(k&&N)return k==o&&N==i;var W=-1,Y=!0,K=u&w?new zi:e;for(E.set(i,o),E.set(o,i);++W<I;){var tt=i[W],lt=o[W];if(d)var et=C?d(lt,tt,W,o,i,E):d(tt,lt,W,i,o,E);if(et!==e){if(et)continue;Y=!1;break}if(K){if(!Da(o,function(dt,yt){if(!jr(K,yt)&&(tt===dt||m(tt,dt,u,d,E)))return K.push(yt)})){Y=!1;break}}else if(!(tt===lt||m(tt,lt,u,d,E))){Y=!1;break}}return E.delete(i),E.delete(o),Y}function Sp(i,o,u,d,m,E,C){switch(u){case Ee:if(i.byteLength!=o.byteLength||i.byteOffset!=o.byteOffset)return!1;i=i.buffer,o=o.buffer;case ze:return!(i.byteLength!=o.byteLength||!E(new so(i),new so(o)));case me:case pe:case un:return _n(+i,+o);case Pn:return i.name==o.name&&i.message==o.message;case qe:case Ht:return i==o+"";case Vt:var I=za;case ye:var L=d&v;if(I||(I=Qs),i.size!=o.size&&!L)return!1;var k=C.get(i);if(k)return k==o;d|=w,C.set(i,o);var N=Ac(I(i),I(o),d,m,E,C);return C.delete(i),N;case re:if(ns)return ns.call(i)==ns.call(o)}return!1}function Ap(i,o,u,d,m,E){var C=u&v,I=cl(i),L=I.length,k=cl(o),N=k.length;if(L!=N&&!C)return!1;for(var W=L;W--;){var Y=I[W];if(!(C?Y in o:bt.call(o,Y)))return!1}var K=E.get(i),tt=E.get(o);if(K&&tt)return K==o&&tt==i;var lt=!0;E.set(i,o),E.set(o,i);for(var et=C;++W<L;){Y=I[W];var dt=i[Y],yt=o[Y];if(d)var Ze=C?d(yt,dt,Y,o,i,E):d(dt,yt,Y,i,o,E);if(!(Ze===e?dt===yt||m(dt,yt,u,d,E):Ze)){lt=!1;break}et||(et=Y=="constructor")}if(lt&&!et){var Ie=i.constructor,Ke=o.constructor;Ie!=Ke&&"constructor"in i&&"constructor"in o&&!(typeof Ie=="function"&&Ie instanceof Ie&&typeof Ke=="function"&&Ke instanceof Ke)&&(lt=!1)}return E.delete(i),E.delete(o),lt}function Gn(i){return xl(Dc(i,e,Yc),i+"")}function cl(i){return Hu(i,te,_l)}function fl(i){return Hu(i,Me,Lc)}var dl=co?function(i){return co.get(i)}:Ol;function Io(i){for(var o=i.name+"",u=gr[o],d=bt.call(gr,o)?u.length:0;d--;){var m=u[d],E=m.func;if(E==null||E==i)return m.name}return o}function yr(i){var o=bt.call(y,"placeholder")?y:i;return o.placeholder}function Q(){var i=y.iteratee||bl;return i=i===bl?ju:i,arguments.length?i(arguments[0],arguments[1]):i}function So(i,o){var u=i.__data__;return kp(o)?u[typeof o=="string"?"string":"hash"]:u.map}function gl(i){for(var o=te(i),u=o.length;u--;){var d=o[u],m=i[d];o[u]=[d,m,Oc(m)]}return o}function Yi(i,o){var u=W_(i,o);return $u(u)?u:e}function Lp(i){var o=bt.call(i,Gi),u=i[Gi];try{i[Gi]=e;var d=!0}catch{}var m=io.call(i);return d&&(o?i[Gi]=u:delete i[Gi]),m}var _l=Ba?function(i){return i==null?[]:(i=Pt(i),ai(Ba(i),function(o){return Fu.call(i,o)}))}:Pl,Lc=Ba?function(i){for(var o=[];i;)li(o,_l(i)),i=oo(i);return o}:Pl,ue=Re;(Ya&&ue(new Ya(new ArrayBuffer(1)))!=Ee||Qr&&ue(new Qr)!=Vt||Ua&&ue(Ua.resolve())!=Pi||dr&&ue(new dr)!=ye||ts&&ue(new ts)!=xe)&&(ue=function(i){var o=Re(i),u=o==Ae?i.constructor:e,d=u?Ui(u):"";if(d)switch(d){case cm:return Ee;case fm:return Vt;case dm:return Pi;case gm:return ye;case _m:return xe}return o});function bp(i,o,u){for(var d=-1,m=u.length;++d<m;){var E=u[d],C=E.size;switch(E.type){case"drop":i+=C;break;case"dropRight":o-=C;break;case"take":o=he(o,i+C);break;case"takeRight":i=Qt(i,o-C);break}}return{start:i,end:o}}function Mp(i){var o=i.match(Ng);return o?o[1].split(Gg):[]}function bc(i,o,u){o=di(o,i);for(var d=-1,m=o.length,E=!1;++d<m;){var C=In(o[d]);if(!(E=i!=null&&u(i,C)))break;i=i[C]}return E||++d!=m?E:(m=i==null?0:i.length,!!m&&Do(m)&&Wn(C,m)&&(st(i)||Zi(i)))}function Op(i){var o=i.length,u=new i.constructor(o);return o&&typeof i[0]=="string"&&bt.call(i,"index")&&(u.index=i.index,u.input=i.input),u}function Mc(i){return typeof i.constructor=="function"&&!hs(i)?_r(oo(i)):{}}function Pp(i,o,u){var d=i.constructor;switch(o){case ze:return ll(i);case me:case pe:return new d(+i);case Ee:return mp(i,u);case Cn:case ni:case jt:case Di:case Hr:case qr:case rr:case sr:case Fi:return dc(i,u);case Vt:return new d;case un:case Ht:return new d(i);case qe:return pp(i);case ye:return new d;case re:return yp(i)}}function Dp(i,o){var u=o.length;if(!u)return i;var d=u-1;return o[d]=(u>1?"& ":"")+o[d],o=o.join(u>2?", ":" "),i.replace(Ra,`{
/* [wrapped with `+o+`] */
`)}function Fp(i){return st(i)||Zi(i)||!!(ku&&i&&i[ku])}function Wn(i,o){var u=typeof i;return o=o??nt,!!o&&(u=="number"||u!="symbol"&&Vg.test(i))&&i>-1&&i%1==0&&i<o}function Te(i,o,u){if(!Xt(u))return!1;var d=typeof o;return(d=="number"?be(u)&&Wn(o,u.length):d=="string"&&o in u)?_n(u[o],i):!1}function ml(i,o){if(st(i))return!1;var u=typeof i;return u=="number"||u=="symbol"||u=="boolean"||i==null||Ue(i)?!0:Ce.test(i)||!cn.test(i)||o!=null&&i in Pt(o)}function kp(i){var o=typeof i;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?i!=="__proto__":i===null}function pl(i){var o=Io(i),u=y[o];if(typeof u!="function"||!(o in pt.prototype))return!1;if(i===u)return!0;var d=dl(u);return!!d&&i===d[0]}function Np(i){return!!Ou&&Ou in i}var Gp=eo?zn:Dl;function hs(i){var o=i&&i.constructor,u=typeof o=="function"&&o.prototype||fr;return i===u}function Oc(i){return i===i&&!Xt(i)}function Pc(i,o){return function(u){return u==null?!1:u[i]===o&&(o!==e||i in Pt(u))}}function Wp(i){var o=Oo(i,function(d){return u.size===f&&u.clear(),d}),u=o.cache;return o}function zp(i,o){var u=i[1],d=o[1],m=u|d,E=m<(R|T|z),C=d==z&&u==b||d==z&&u==B&&i[7].length<=o[8]||d==(z|B)&&o[7].length<=o[8]&&u==b;if(!(E||C))return i;d&R&&(i[2]=o[2],m|=u&R?0:S);var I=o[3];if(I){var L=i[3];i[3]=L?_c(L,I,o[4]):I,i[4]=L?hi(i[3],g):o[4]}return I=o[5],I&&(L=i[5],i[5]=L?mc(L,I,o[6]):I,i[6]=L?hi(i[5],g):o[6]),I=o[7],I&&(i[7]=I),d&z&&(i[8]=i[8]==null?o[8]:he(i[8],o[8])),i[9]==null&&(i[9]=o[9]),i[0]=o[0],i[1]=m,i}function Xp(i){var o=[];if(i!=null)for(var u in Pt(i))o.push(u);return o}function Bp(i){return io.call(i)}function Dc(i,o,u){return o=Qt(o===e?i.length-1:o,0),function(){for(var d=arguments,m=-1,E=Qt(d.length-o,0),C=P(E);++m<E;)C[m]=d[o+m];m=-1;for(var I=P(o+1);++m<o;)I[m]=d[m];return I[o]=u(C),Xe(i,this,I)}}function Fc(i,o){return o.length<2?i:Bi(i,en(o,0,-1))}function Yp(i,o){for(var u=i.length,d=he(o.length,u),m=Le(i);d--;){var E=o[d];i[d]=Wn(E,u)?m[E]:e}return i}function yl(i,o){if(!(o==="constructor"&&typeof i[o]=="function")&&o!="__proto__")return i[o]}var kc=Gc(sc),us=rm||function(i,o){return se.setTimeout(i,o)},xl=Gc(fp);function Nc(i,o,u){var d=o+"";return xl(i,Dp(d,Up(Mp(d),u)))}function Gc(i){var o=0,u=0;return function(){var d=lm(),m=ut-(d-u);if(u=d,m>0){if(++o>=_t)return arguments[0]}else o=0;return i.apply(e,arguments)}}function Ao(i,o){var u=-1,d=i.length,m=d-1;for(o=o===e?d:o;++u<o;){var E=el(u,m),C=i[E];i[E]=i[u],i[u]=C}return i.length=o,i}var Wc=Wp(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(or,function(u,d,m,E){o.push(m?E.replace(Xg,"$1"):d||u)}),o});function In(i){if(typeof i=="string"||Ue(i))return i;var o=i+"";return o=="0"&&1/i==-U?"-0":o}function Ui(i){if(i!=null){try{return no.call(i)}catch{}try{return i+""}catch{}}return""}function Up(i,o){return je(mt,function(u){var d="_."+u[0];o&u[1]&&!js(i,d)&&i.push(d)}),i.sort()}function zc(i){if(i instanceof pt)return i.clone();var o=new Qe(i.__wrapped__,i.__chain__);return o.__actions__=Le(i.__actions__),o.__index__=i.__index__,o.__values__=i.__values__,o}function Zp(i,o,u){(u?Te(i,o,u):o===e)?o=1:o=Qt(at(o),0);var d=i==null?0:i.length;if(!d||o<1)return[];for(var m=0,E=0,C=P(ho(d/o));m<d;)C[E++]=en(i,m,m+=o);return C}function Kp(i){for(var o=-1,u=i==null?0:i.length,d=0,m=[];++o<u;){var E=i[o];E&&(m[d++]=E)}return m}function Vp(){var i=arguments.length;if(!i)return[];for(var o=P(i-1),u=arguments[0],d=i;d--;)o[d-1]=arguments[d];return li(st(u)?Le(u):[u],oe(o,1))}var Hp=ct(function(i,o){return Ut(i)?rs(i,oe(o,1,Ut,!0)):[]}),qp=ct(function(i,o){var u=nn(o);return Ut(u)&&(u=e),Ut(i)?rs(i,oe(o,1,Ut,!0),Q(u,2)):[]}),$p=ct(function(i,o){var u=nn(o);return Ut(u)&&(u=e),Ut(i)?rs(i,oe(o,1,Ut,!0),e,u):[]});function jp(i,o,u){var d=i==null?0:i.length;return d?(o=u||o===e?1:at(o),en(i,o<0?0:o,d)):[]}function Jp(i,o,u){var d=i==null?0:i.length;return d?(o=u||o===e?1:at(o),o=d-o,en(i,0,o<0?0:o)):[]}function Qp(i,o){return i&&i.length?Eo(i,Q(o,3),!0,!0):[]}function t0(i,o){return i&&i.length?Eo(i,Q(o,3),!0):[]}function e0(i,o,u,d){var m=i==null?0:i.length;return m?(u&&typeof u!="number"&&Te(i,o,u)&&(u=0,d=m),Vm(i,o,u,d)):[]}function Xc(i,o,u){var d=i==null?0:i.length;if(!d)return-1;var m=u==null?0:at(u);return m<0&&(m=Qt(d+m,0)),Js(i,Q(o,3),m)}function Bc(i,o,u){var d=i==null?0:i.length;if(!d)return-1;var m=d-1;return u!==e&&(m=at(u),m=u<0?Qt(d+m,0):he(m,d-1)),Js(i,Q(o,3),m,!0)}function Yc(i){var o=i==null?0:i.length;return o?oe(i,1):[]}function n0(i){var o=i==null?0:i.length;return o?oe(i,U):[]}function i0(i,o){var u=i==null?0:i.length;return u?(o=o===e?1:at(o),oe(i,o)):[]}function r0(i){for(var o=-1,u=i==null?0:i.length,d={};++o<u;){var m=i[o];d[m[0]]=m[1]}return d}function Uc(i){return i&&i.length?i[0]:e}function s0(i,o,u){var d=i==null?0:i.length;if(!d)return-1;var m=u==null?0:at(u);return m<0&&(m=Qt(d+m,0)),lr(i,o,m)}function o0(i){var o=i==null?0:i.length;return o?en(i,0,-1):[]}var a0=ct(function(i){var o=Wt(i,ol);return o.length&&o[0]===i[0]?$a(o):[]}),l0=ct(function(i){var o=nn(i),u=Wt(i,ol);return o===nn(u)?o=e:u.pop(),u.length&&u[0]===i[0]?$a(u,Q(o,2)):[]}),h0=ct(function(i){var o=nn(i),u=Wt(i,ol);return o=typeof o=="function"?o:e,o&&u.pop(),u.length&&u[0]===i[0]?$a(u,e,o):[]});function u0(i,o){return i==null?"":om.call(i,o)}function nn(i){var o=i==null?0:i.length;return o?i[o-1]:e}function c0(i,o,u){var d=i==null?0:i.length;if(!d)return-1;var m=d;return u!==e&&(m=at(u),m=m<0?Qt(d+m,0):he(m,d-1)),o===o?U_(i,o,m):Js(i,Ru,m,!0)}function f0(i,o){return i&&i.length?ec(i,at(o)):e}var d0=ct(Zc);function Zc(i,o){return i&&i.length&&o&&o.length?tl(i,o):i}function g0(i,o,u){return i&&i.length&&o&&o.length?tl(i,o,Q(u,2)):i}function _0(i,o,u){return i&&i.length&&o&&o.length?tl(i,o,e,u):i}var m0=Gn(function(i,o){var u=i==null?0:i.length,d=Ka(i,o);return rc(i,Wt(o,function(m){return Wn(m,u)?+m:m}).sort(gc)),d});function p0(i,o){var u=[];if(!(i&&i.length))return u;var d=-1,m=[],E=i.length;for(o=Q(o,3);++d<E;){var C=i[d];o(C,d,i)&&(u.push(C),m.push(d))}return rc(i,m),u}function El(i){return i==null?i:um.call(i)}function y0(i,o,u){var d=i==null?0:i.length;return d?(u&&typeof u!="number"&&Te(i,o,u)?(o=0,u=d):(o=o==null?0:at(o),u=u===e?d:at(u)),en(i,o,u)):[]}function x0(i,o){return xo(i,o)}function E0(i,o,u){return il(i,o,Q(u,2))}function v0(i,o){var u=i==null?0:i.length;if(u){var d=xo(i,o);if(d<u&&_n(i[d],o))return d}return-1}function w0(i,o){return xo(i,o,!0)}function C0(i,o,u){return il(i,o,Q(u,2),!0)}function R0(i,o){var u=i==null?0:i.length;if(u){var d=xo(i,o,!0)-1;if(_n(i[d],o))return d}return-1}function T0(i){return i&&i.length?oc(i):[]}function I0(i,o){return i&&i.length?oc(i,Q(o,2)):[]}function S0(i){var o=i==null?0:i.length;return o?en(i,1,o):[]}function A0(i,o,u){return i&&i.length?(o=u||o===e?1:at(o),en(i,0,o<0?0:o)):[]}function L0(i,o,u){var d=i==null?0:i.length;return d?(o=u||o===e?1:at(o),o=d-o,en(i,o<0?0:o,d)):[]}function b0(i,o){return i&&i.length?Eo(i,Q(o,3),!1,!0):[]}function M0(i,o){return i&&i.length?Eo(i,Q(o,3)):[]}var O0=ct(function(i){return fi(oe(i,1,Ut,!0))}),P0=ct(function(i){var o=nn(i);return Ut(o)&&(o=e),fi(oe(i,1,Ut,!0),Q(o,2))}),D0=ct(function(i){var o=nn(i);return o=typeof o=="function"?o:e,fi(oe(i,1,Ut,!0),e,o)});function F0(i){return i&&i.length?fi(i):[]}function k0(i,o){return i&&i.length?fi(i,Q(o,2)):[]}function N0(i,o){return o=typeof o=="function"?o:e,i&&i.length?fi(i,e,o):[]}function vl(i){if(!(i&&i.length))return[];var o=0;return i=ai(i,function(u){if(Ut(u))return o=Qt(u.length,o),!0}),Ga(o,function(u){return Wt(i,Fa(u))})}function Kc(i,o){if(!(i&&i.length))return[];var u=vl(i);return o==null?u:Wt(u,function(d){return Xe(o,e,d)})}var G0=ct(function(i,o){return Ut(i)?rs(i,o):[]}),W0=ct(function(i){return sl(ai(i,Ut))}),z0=ct(function(i){var o=nn(i);return Ut(o)&&(o=e),sl(ai(i,Ut),Q(o,2))}),X0=ct(function(i){var o=nn(i);return o=typeof o=="function"?o:e,sl(ai(i,Ut),e,o)}),B0=ct(vl);function Y0(i,o){return uc(i||[],o||[],is)}function U0(i,o){return uc(i||[],o||[],as)}var Z0=ct(function(i){var o=i.length,u=o>1?i[o-1]:e;return u=typeof u=="function"?(i.pop(),u):e,Kc(i,u)});function Vc(i){var o=y(i);return o.__chain__=!0,o}function K0(i,o){return o(i),i}function Lo(i,o){return o(i)}var V0=Gn(function(i){var o=i.length,u=o?i[0]:0,d=this.__wrapped__,m=function(E){return Ka(E,i)};return o>1||this.__actions__.length||!(d instanceof pt)||!Wn(u)?this.thru(m):(d=d.slice(u,+u+(o?1:0)),d.__actions__.push({func:Lo,args:[m],thisArg:e}),new Qe(d,this.__chain__).thru(function(E){return o&&!E.length&&E.push(e),E}))});function H0(){return Vc(this)}function q0(){return new Qe(this.value(),this.__chain__)}function $0(){this.__values__===e&&(this.__values__=lf(this.value()));var i=this.__index__>=this.__values__.length,o=i?e:this.__values__[this.__index__++];return{done:i,value:o}}function j0(){return this}function J0(i){for(var o,u=this;u instanceof go;){var d=zc(u);d.__index__=0,d.__values__=e,o?m.__wrapped__=d:o=d;var m=d;u=u.__wrapped__}return m.__wrapped__=i,o}function Q0(){var i=this.__wrapped__;if(i instanceof pt){var o=i;return this.__actions__.length&&(o=new pt(this)),o=o.reverse(),o.__actions__.push({func:Lo,args:[El],thisArg:e}),new Qe(o,this.__chain__)}return this.thru(El)}function ty(){return hc(this.__wrapped__,this.__actions__)}var ey=vo(function(i,o,u){bt.call(i,u)?++i[u]:kn(i,u,1)});function ny(i,o,u){var d=st(i)?wu:Km;return u&&Te(i,o,u)&&(o=e),d(i,Q(o,3))}function iy(i,o){var u=st(i)?ai:Ku;return u(i,Q(o,3))}var ry=Ec(Xc),sy=Ec(Bc);function oy(i,o){return oe(bo(i,o),1)}function ay(i,o){return oe(bo(i,o),U)}function ly(i,o,u){return u=u===e?1:at(u),oe(bo(i,o),u)}function Hc(i,o){var u=st(i)?je:ci;return u(i,Q(o,3))}function qc(i,o){var u=st(i)?S_:Zu;return u(i,Q(o,3))}var hy=vo(function(i,o,u){bt.call(i,u)?i[u].push(o):kn(i,u,[o])});function uy(i,o,u,d){i=be(i)?i:Er(i),u=u&&!d?at(u):0;var m=i.length;return u<0&&(u=Qt(m+u,0)),Fo(i)?u<=m&&i.indexOf(o,u)>-1:!!m&&lr(i,o,u)>-1}var cy=ct(function(i,o,u){var d=-1,m=typeof o=="function",E=be(i)?P(i.length):[];return ci(i,function(C){E[++d]=m?Xe(o,C,u):ss(C,o,u)}),E}),fy=vo(function(i,o,u){kn(i,u,o)});function bo(i,o){var u=st(i)?Wt:Ju;return u(i,Q(o,3))}function dy(i,o,u,d){return i==null?[]:(st(o)||(o=o==null?[]:[o]),u=d?e:u,st(u)||(u=u==null?[]:[u]),nc(i,o,u))}var gy=vo(function(i,o,u){i[u?0:1].push(o)},function(){return[[],[]]});function _y(i,o,u){var d=st(i)?Pa:Iu,m=arguments.length<3;return d(i,Q(o,4),u,m,ci)}function my(i,o,u){var d=st(i)?A_:Iu,m=arguments.length<3;return d(i,Q(o,4),u,m,Zu)}function py(i,o){var u=st(i)?ai:Ku;return u(i,Po(Q(o,3)))}function yy(i){var o=st(i)?Xu:up;return o(i)}function xy(i,o,u){(u?Te(i,o,u):o===e)?o=1:o=at(o);var d=st(i)?Xm:cp;return d(i,o)}function Ey(i){var o=st(i)?Bm:dp;return o(i)}function vy(i){if(i==null)return 0;if(be(i))return Fo(i)?ur(i):i.length;var o=ue(i);return o==Vt||o==ye?i.size:Ja(i).length}function wy(i,o,u){var d=st(i)?Da:gp;return u&&Te(i,o,u)&&(o=e),d(i,Q(o,3))}var Cy=ct(function(i,o){if(i==null)return[];var u=o.length;return u>1&&Te(i,o[0],o[1])?o=[]:u>2&&Te(o[0],o[1],o[2])&&(o=[o[0]]),nc(i,oe(o,1),[])}),Mo=im||function(){return se.Date.now()};function Ry(i,o){if(typeof o!="function")throw new Je(l);return i=at(i),function(){if(--i<1)return o.apply(this,arguments)}}function $c(i,o,u){return o=u?e:o,o=i&&o==null?i.length:o,Nn(i,z,e,e,e,e,o)}function jc(i,o){var u;if(typeof o!="function")throw new Je(l);return i=at(i),function(){return--i>0&&(u=o.apply(this,arguments)),i<=1&&(o=e),u}}var wl=ct(function(i,o,u){var d=R;if(u.length){var m=hi(u,yr(wl));d|=M}return Nn(i,d,o,u,m)}),Jc=ct(function(i,o,u){var d=R|T;if(u.length){var m=hi(u,yr(Jc));d|=M}return Nn(o,d,i,u,m)});function Qc(i,o,u){o=u?e:o;var d=Nn(i,b,e,e,e,e,e,o);return d.placeholder=Qc.placeholder,d}function tf(i,o,u){o=u?e:o;var d=Nn(i,O,e,e,e,e,e,o);return d.placeholder=tf.placeholder,d}function ef(i,o,u){var d,m,E,C,I,L,k=0,N=!1,W=!1,Y=!0;if(typeof i!="function")throw new Je(l);o=rn(o)||0,Xt(u)&&(N=!!u.leading,W="maxWait"in u,E=W?Qt(rn(u.maxWait)||0,o):E,Y="trailing"in u?!!u.trailing:Y);function K(Zt){var mn=d,Bn=m;return d=m=e,k=Zt,C=i.apply(Bn,mn),C}function tt(Zt){return k=Zt,I=us(dt,o),N?K(Zt):C}function lt(Zt){var mn=Zt-L,Bn=Zt-k,vf=o-mn;return W?he(vf,E-Bn):vf}function et(Zt){var mn=Zt-L,Bn=Zt-k;return L===e||mn>=o||mn<0||W&&Bn>=E}function dt(){var Zt=Mo();if(et(Zt))return yt(Zt);I=us(dt,lt(Zt))}function yt(Zt){return I=e,Y&&d?K(Zt):(d=m=e,C)}function Ze(){I!==e&&cc(I),k=0,d=L=m=I=e}function Ie(){return I===e?C:yt(Mo())}function Ke(){var Zt=Mo(),mn=et(Zt);if(d=arguments,m=this,L=Zt,mn){if(I===e)return tt(L);if(W)return cc(I),I=us(dt,o),K(L)}return I===e&&(I=us(dt,o)),C}return Ke.cancel=Ze,Ke.flush=Ie,Ke}var Ty=ct(function(i,o){return Uu(i,1,o)}),Iy=ct(function(i,o,u){return Uu(i,rn(o)||0,u)});function Sy(i){return Nn(i,H)}function Oo(i,o){if(typeof i!="function"||o!=null&&typeof o!="function")throw new Je(l);var u=function(){var d=arguments,m=o?o.apply(this,d):d[0],E=u.cache;if(E.has(m))return E.get(m);var C=i.apply(this,d);return u.cache=E.set(m,C)||E,C};return u.cache=new(Oo.Cache||Fn),u}Oo.Cache=Fn;function Po(i){if(typeof i!="function")throw new Je(l);return function(){var o=arguments;switch(o.length){case 0:return!i.call(this);case 1:return!i.call(this,o[0]);case 2:return!i.call(this,o[0],o[1]);case 3:return!i.call(this,o[0],o[1],o[2])}return!i.apply(this,o)}}function Ay(i){return jc(2,i)}var Ly=_p(function(i,o){o=o.length==1&&st(o[0])?Wt(o[0],Be(Q())):Wt(oe(o,1),Be(Q()));var u=o.length;return ct(function(d){for(var m=-1,E=he(d.length,u);++m<E;)d[m]=o[m].call(this,d[m]);return Xe(i,this,d)})}),Cl=ct(function(i,o){var u=hi(o,yr(Cl));return Nn(i,M,e,o,u)}),nf=ct(function(i,o){var u=hi(o,yr(nf));return Nn(i,F,e,o,u)}),by=Gn(function(i,o){return Nn(i,B,e,e,e,o)});function My(i,o){if(typeof i!="function")throw new Je(l);return o=o===e?o:at(o),ct(i,o)}function Oy(i,o){if(typeof i!="function")throw new Je(l);return o=o==null?0:Qt(at(o),0),ct(function(u){var d=u[o],m=gi(u,0,o);return d&&li(m,d),Xe(i,this,m)})}function Py(i,o,u){var d=!0,m=!0;if(typeof i!="function")throw new Je(l);return Xt(u)&&(d="leading"in u?!!u.leading:d,m="trailing"in u?!!u.trailing:m),ef(i,o,{leading:d,maxWait:o,trailing:m})}function Dy(i){return $c(i,1)}function Fy(i,o){return Cl(al(o),i)}function ky(){if(!arguments.length)return[];var i=arguments[0];return st(i)?i:[i]}function Ny(i){return tn(i,x)}function Gy(i,o){return o=typeof o=="function"?o:e,tn(i,x,o)}function Wy(i){return tn(i,_|x)}function zy(i,o){return o=typeof o=="function"?o:e,tn(i,_|x,o)}function Xy(i,o){return o==null||Yu(i,o,te(o))}function _n(i,o){return i===o||i!==i&&o!==o}var By=To(qa),Yy=To(function(i,o){return i>=o}),Zi=qu(function(){return arguments}())?qu:function(i){return Bt(i)&&bt.call(i,"callee")&&!Fu.call(i,"callee")},st=P.isArray,Uy=mu?Be(mu):Jm;function be(i){return i!=null&&Do(i.length)&&!zn(i)}function Ut(i){return Bt(i)&&be(i)}function Zy(i){return i===!0||i===!1||Bt(i)&&Re(i)==me}var _i=sm||Dl,Ky=pu?Be(pu):Qm;function Vy(i){return Bt(i)&&i.nodeType===1&&!cs(i)}function Hy(i){if(i==null)return!0;if(be(i)&&(st(i)||typeof i=="string"||typeof i.splice=="function"||_i(i)||xr(i)||Zi(i)))return!i.length;var o=ue(i);if(o==Vt||o==ye)return!i.size;if(hs(i))return!Ja(i).length;for(var u in i)if(bt.call(i,u))return!1;return!0}function qy(i,o){return os(i,o)}function $y(i,o,u){u=typeof u=="function"?u:e;var d=u?u(i,o):e;return d===e?os(i,o,e,u):!!d}function Rl(i){if(!Bt(i))return!1;var o=Re(i);return o==Pn||o==ti||typeof i.message=="string"&&typeof i.name=="string"&&!cs(i)}function jy(i){return typeof i=="number"&&Nu(i)}function zn(i){if(!Xt(i))return!1;var o=Re(i);return o==hn||o==Oi||o==ie||o==ir}function rf(i){return typeof i=="number"&&i==at(i)}function Do(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=nt}function Xt(i){var o=typeof i;return i!=null&&(o=="object"||o=="function")}function Bt(i){return i!=null&&typeof i=="object"}var sf=yu?Be(yu):ep;function Jy(i,o){return i===o||ja(i,o,gl(o))}function Qy(i,o,u){return u=typeof u=="function"?u:e,ja(i,o,gl(o),u)}function t1(i){return of(i)&&i!=+i}function e1(i){if(Gp(i))throw new rt(a);return $u(i)}function n1(i){return i===null}function i1(i){return i==null}function of(i){return typeof i=="number"||Bt(i)&&Re(i)==un}function cs(i){if(!Bt(i)||Re(i)!=Ae)return!1;var o=oo(i);if(o===null)return!0;var u=bt.call(o,"constructor")&&o.constructor;return typeof u=="function"&&u instanceof u&&no.call(u)==Q_}var Tl=xu?Be(xu):np;function r1(i){return rf(i)&&i>=-nt&&i<=nt}var af=Eu?Be(Eu):ip;function Fo(i){return typeof i=="string"||!st(i)&&Bt(i)&&Re(i)==Ht}function Ue(i){return typeof i=="symbol"||Bt(i)&&Re(i)==re}var xr=vu?Be(vu):rp;function s1(i){return i===e}function o1(i){return Bt(i)&&ue(i)==xe}function a1(i){return Bt(i)&&Re(i)==ei}var l1=To(Qa),h1=To(function(i,o){return i<=o});function lf(i){if(!i)return[];if(be(i))return Fo(i)?dn(i):Le(i);if(Jr&&i[Jr])return X_(i[Jr]());var o=ue(i),u=o==Vt?za:o==ye?Qs:Er;return u(i)}function Xn(i){if(!i)return i===0?i:0;if(i=rn(i),i===U||i===-U){var o=i<0?-1:1;return o*St}return i===i?i:0}function at(i){var o=Xn(i),u=o%1;return o===o?u?o-u:o:0}function hf(i){return i?Xi(at(i),0,Ot):0}function rn(i){if(typeof i=="number")return i;if(Ue(i))return xt;if(Xt(i)){var o=typeof i.valueOf=="function"?i.valueOf():i;i=Xt(o)?o+"":o}if(typeof i!="string")return i===0?i:+i;i=Su(i);var u=Ug.test(i);return u||Kg.test(i)?R_(i.slice(2),u?2:8):Yg.test(i)?xt:+i}function uf(i){return Tn(i,Me(i))}function u1(i){return i?Xi(at(i),-nt,nt):i===0?i:0}function At(i){return i==null?"":Ye(i)}var c1=mr(function(i,o){if(hs(o)||be(o)){Tn(o,te(o),i);return}for(var u in o)bt.call(o,u)&&is(i,u,o[u])}),cf=mr(function(i,o){Tn(o,Me(o),i)}),ko=mr(function(i,o,u,d){Tn(o,Me(o),i,d)}),f1=mr(function(i,o,u,d){Tn(o,te(o),i,d)}),d1=Gn(Ka);function g1(i,o){var u=_r(i);return o==null?u:Bu(u,o)}var _1=ct(function(i,o){i=Pt(i);var u=-1,d=o.length,m=d>2?o[2]:e;for(m&&Te(o[0],o[1],m)&&(d=1);++u<d;)for(var E=o[u],C=Me(E),I=-1,L=C.length;++I<L;){var k=C[I],N=i[k];(N===e||_n(N,fr[k])&&!bt.call(i,k))&&(i[k]=E[k])}return i}),m1=ct(function(i){return i.push(e,Sc),Xe(ff,e,i)});function p1(i,o){return Cu(i,Q(o,3),Rn)}function y1(i,o){return Cu(i,Q(o,3),Ha)}function x1(i,o){return i==null?i:Va(i,Q(o,3),Me)}function E1(i,o){return i==null?i:Vu(i,Q(o,3),Me)}function v1(i,o){return i&&Rn(i,Q(o,3))}function w1(i,o){return i&&Ha(i,Q(o,3))}function C1(i){return i==null?[]:po(i,te(i))}function R1(i){return i==null?[]:po(i,Me(i))}function Il(i,o,u){var d=i==null?e:Bi(i,o);return d===e?u:d}function T1(i,o){return i!=null&&bc(i,o,Hm)}function Sl(i,o){return i!=null&&bc(i,o,qm)}var I1=wc(function(i,o,u){o!=null&&typeof o.toString!="function"&&(o=io.call(o)),i[o]=u},Ll(Oe)),S1=wc(function(i,o,u){o!=null&&typeof o.toString!="function"&&(o=io.call(o)),bt.call(i,o)?i[o].push(u):i[o]=[u]},Q),A1=ct(ss);function te(i){return be(i)?zu(i):Ja(i)}function Me(i){return be(i)?zu(i,!0):sp(i)}function L1(i,o){var u={};return o=Q(o,3),Rn(i,function(d,m,E){kn(u,o(d,m,E),d)}),u}function b1(i,o){var u={};return o=Q(o,3),Rn(i,function(d,m,E){kn(u,m,o(d,m,E))}),u}var M1=mr(function(i,o,u){yo(i,o,u)}),ff=mr(function(i,o,u,d){yo(i,o,u,d)}),O1=Gn(function(i,o){var u={};if(i==null)return u;var d=!1;o=Wt(o,function(E){return E=di(E,i),d||(d=E.length>1),E}),Tn(i,fl(i),u),d&&(u=tn(u,_|p|x,Ip));for(var m=o.length;m--;)rl(u,o[m]);return u});function P1(i,o){return df(i,Po(Q(o)))}var D1=Gn(function(i,o){return i==null?{}:ap(i,o)});function df(i,o){if(i==null)return{};var u=Wt(fl(i),function(d){return[d]});return o=Q(o),ic(i,u,function(d,m){return o(d,m[0])})}function F1(i,o,u){o=di(o,i);var d=-1,m=o.length;for(m||(m=1,i=e);++d<m;){var E=i==null?e:i[In(o[d])];E===e&&(d=m,E=u),i=zn(E)?E.call(i):E}return i}function k1(i,o,u){return i==null?i:as(i,o,u)}function N1(i,o,u,d){return d=typeof d=="function"?d:e,i==null?i:as(i,o,u,d)}var gf=Tc(te),_f=Tc(Me);function G1(i,o,u){var d=st(i),m=d||_i(i)||xr(i);if(o=Q(o,4),u==null){var E=i&&i.constructor;m?u=d?new E:[]:Xt(i)?u=zn(E)?_r(oo(i)):{}:u={}}return(m?je:Rn)(i,function(C,I,L){return o(u,C,I,L)}),u}function W1(i,o){return i==null?!0:rl(i,o)}function z1(i,o,u){return i==null?i:lc(i,o,al(u))}function X1(i,o,u,d){return d=typeof d=="function"?d:e,i==null?i:lc(i,o,al(u),d)}function Er(i){return i==null?[]:Wa(i,te(i))}function B1(i){return i==null?[]:Wa(i,Me(i))}function Y1(i,o,u){return u===e&&(u=o,o=e),u!==e&&(u=rn(u),u=u===u?u:0),o!==e&&(o=rn(o),o=o===o?o:0),Xi(rn(i),o,u)}function U1(i,o,u){return o=Xn(o),u===e?(u=o,o=0):u=Xn(u),i=rn(i),$m(i,o,u)}function Z1(i,o,u){if(u&&typeof u!="boolean"&&Te(i,o,u)&&(o=u=e),u===e&&(typeof o=="boolean"?(u=o,o=e):typeof i=="boolean"&&(u=i,i=e)),i===e&&o===e?(i=0,o=1):(i=Xn(i),o===e?(o=i,i=0):o=Xn(o)),i>o){var d=i;i=o,o=d}if(u||i%1||o%1){var m=Gu();return he(i+m*(o-i+C_("1e-"+((m+"").length-1))),o)}return el(i,o)}var K1=pr(function(i,o,u){return o=o.toLowerCase(),i+(u?mf(o):o)});function mf(i){return Al(At(i).toLowerCase())}function pf(i){return i=At(i),i&&i.replace(Hg,k_).replace(d_,"")}function V1(i,o,u){i=At(i),o=Ye(o);var d=i.length;u=u===e?d:Xi(at(u),0,d);var m=u;return u-=o.length,u>=0&&i.slice(u,m)==o}function H1(i){return i=At(i),i&&Vs.test(i)?i.replace(ri,N_):i}function q1(i){return i=At(i),i&&ae.test(i)?i.replace(oi,"\\$&"):i}var $1=pr(function(i,o,u){return i+(u?"-":"")+o.toLowerCase()}),j1=pr(function(i,o,u){return i+(u?" ":"")+o.toLowerCase()}),J1=xc("toLowerCase");function Q1(i,o,u){i=At(i),o=at(o);var d=o?ur(i):0;if(!o||d>=o)return i;var m=(o-d)/2;return Ro(uo(m),u)+i+Ro(ho(m),u)}function tx(i,o,u){i=At(i),o=at(o);var d=o?ur(i):0;return o&&d<o?i+Ro(o-d,u):i}function ex(i,o,u){i=At(i),o=at(o);var d=o?ur(i):0;return o&&d<o?Ro(o-d,u)+i:i}function nx(i,o,u){return u||o==null?o=0:o&&(o=+o),hm(At(i).replace(le,""),o||0)}function ix(i,o,u){return(u?Te(i,o,u):o===e)?o=1:o=at(o),nl(At(i),o)}function rx(){var i=arguments,o=At(i[0]);return i.length<3?o:o.replace(i[1],i[2])}var sx=pr(function(i,o,u){return i+(u?"_":"")+o.toLowerCase()});function ox(i,o,u){return u&&typeof u!="number"&&Te(i,o,u)&&(o=u=e),u=u===e?Ot:u>>>0,u?(i=At(i),i&&(typeof o=="string"||o!=null&&!Tl(o))&&(o=Ye(o),!o&&hr(i))?gi(dn(i),0,u):i.split(o,u)):[]}var ax=pr(function(i,o,u){return i+(u?" ":"")+Al(o)});function lx(i,o,u){return i=At(i),u=u==null?0:Xi(at(u),0,i.length),o=Ye(o),i.slice(u,u+o.length)==o}function hx(i,o,u){var d=y.templateSettings;u&&Te(i,o,u)&&(o=e),i=At(i),o=ko({},o,d,Ic);var m=ko({},o.imports,d.imports,Ic),E=te(m),C=Wa(m,E),I,L,k=0,N=o.interpolate||Hs,W="__p += '",Y=Xa((o.escape||Hs).source+"|"+N.source+"|"+(N===we?Bg:Hs).source+"|"+(o.evaluate||Hs).source+"|$","g"),K="//# sourceURL="+(bt.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++y_+"]")+`
`;i.replace(Y,function(et,dt,yt,Ze,Ie,Ke){return yt||(yt=Ze),W+=i.slice(k,Ke).replace(qg,G_),dt&&(I=!0,W+=`' +
__e(`+dt+`) +
'`),Ie&&(L=!0,W+=`';
`+Ie+`;
__p += '`),yt&&(W+=`' +
((__t = (`+yt+`)) == null ? '' : __t) +
'`),k=Ke+et.length,et}),W+=`';
`;var tt=bt.call(o,"variable")&&o.variable;if(!tt)W=`with (obj) {
`+W+`
}
`;else if(zg.test(tt))throw new rt(h);W=(L?W.replace(Zs,""):W).replace($r,"$1").replace(ki,"$1;"),W="function("+(tt||"obj")+`) {
`+(tt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(I?", __e = _.escape":"")+(L?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+W+`return __p
}`;var lt=xf(function(){return Rt(E,K+"return "+W).apply(e,C)});if(lt.source=W,Rl(lt))throw lt;return lt}function ux(i){return At(i).toLowerCase()}function cx(i){return At(i).toUpperCase()}function fx(i,o,u){if(i=At(i),i&&(u||o===e))return Su(i);if(!i||!(o=Ye(o)))return i;var d=dn(i),m=dn(o),E=Au(d,m),C=Lu(d,m)+1;return gi(d,E,C).join("")}function dx(i,o,u){if(i=At(i),i&&(u||o===e))return i.slice(0,Mu(i)+1);if(!i||!(o=Ye(o)))return i;var d=dn(i),m=Lu(d,dn(o))+1;return gi(d,0,m).join("")}function gx(i,o,u){if(i=At(i),i&&(u||o===e))return i.replace(le,"");if(!i||!(o=Ye(o)))return i;var d=dn(i),m=Au(d,dn(o));return gi(d,m).join("")}function _x(i,o){var u=it,d=gt;if(Xt(o)){var m="separator"in o?o.separator:m;u="length"in o?at(o.length):u,d="omission"in o?Ye(o.omission):d}i=At(i);var E=i.length;if(hr(i)){var C=dn(i);E=C.length}if(u>=E)return i;var I=u-ur(d);if(I<1)return d;var L=C?gi(C,0,I).join(""):i.slice(0,I);if(m===e)return L+d;if(C&&(I+=L.length-I),Tl(m)){if(i.slice(I).search(m)){var k,N=L;for(m.global||(m=Xa(m.source,At(qh.exec(m))+"g")),m.lastIndex=0;k=m.exec(N);)var W=k.index;L=L.slice(0,W===e?I:W)}}else if(i.indexOf(Ye(m),I)!=I){var Y=L.lastIndexOf(m);Y>-1&&(L=L.slice(0,Y))}return L+d}function mx(i){return i=At(i),i&&Ks.test(i)?i.replace(ii,Z_):i}var px=pr(function(i,o,u){return i+(u?" ":"")+o.toUpperCase()}),Al=xc("toUpperCase");function yf(i,o,u){return i=At(i),o=u?e:o,o===e?z_(i)?H_(i):M_(i):i.match(o)||[]}var xf=ct(function(i,o){try{return Xe(i,e,o)}catch(u){return Rl(u)?u:new rt(u)}}),yx=Gn(function(i,o){return je(o,function(u){u=In(u),kn(i,u,wl(i[u],i))}),i});function xx(i){var o=i==null?0:i.length,u=Q();return i=o?Wt(i,function(d){if(typeof d[1]!="function")throw new Je(l);return[u(d[0]),d[1]]}):[],ct(function(d){for(var m=-1;++m<o;){var E=i[m];if(Xe(E[0],this,d))return Xe(E[1],this,d)}})}function Ex(i){return Zm(tn(i,_))}function Ll(i){return function(){return i}}function vx(i,o){return i==null||i!==i?o:i}var wx=vc(),Cx=vc(!0);function Oe(i){return i}function bl(i){return ju(typeof i=="function"?i:tn(i,_))}function Rx(i){return Qu(tn(i,_))}function Tx(i,o){return tc(i,tn(o,_))}var Ix=ct(function(i,o){return function(u){return ss(u,i,o)}}),Sx=ct(function(i,o){return function(u){return ss(i,u,o)}});function Ml(i,o,u){var d=te(o),m=po(o,d);u==null&&!(Xt(o)&&(m.length||!d.length))&&(u=o,o=i,i=this,m=po(o,te(o)));var E=!(Xt(u)&&"chain"in u)||!!u.chain,C=zn(i);return je(m,function(I){var L=o[I];i[I]=L,C&&(i.prototype[I]=function(){var k=this.__chain__;if(E||k){var N=i(this.__wrapped__),W=N.__actions__=Le(this.__actions__);return W.push({func:L,args:arguments,thisArg:i}),N.__chain__=k,N}return L.apply(i,li([this.value()],arguments))})}),i}function Ax(){return se._===this&&(se._=tm),this}function Ol(){}function Lx(i){return i=at(i),ct(function(o){return ec(o,i)})}var bx=hl(Wt),Mx=hl(wu),Ox=hl(Da);function Ef(i){return ml(i)?Fa(In(i)):lp(i)}function Px(i){return function(o){return i==null?e:Bi(i,o)}}var Dx=Cc(),Fx=Cc(!0);function Pl(){return[]}function Dl(){return!1}function kx(){return{}}function Nx(){return""}function Gx(){return!0}function Wx(i,o){if(i=at(i),i<1||i>nt)return[];var u=Ot,d=he(i,Ot);o=Q(o),i-=Ot;for(var m=Ga(d,o);++u<i;)o(u);return m}function zx(i){return st(i)?Wt(i,In):Ue(i)?[i]:Le(Wc(At(i)))}function Xx(i){var o=++J_;return At(i)+o}var Bx=Co(function(i,o){return i+o},0),Yx=ul("ceil"),Ux=Co(function(i,o){return i/o},1),Zx=ul("floor");function Kx(i){return i&&i.length?mo(i,Oe,qa):e}function Vx(i,o){return i&&i.length?mo(i,Q(o,2),qa):e}function Hx(i){return Tu(i,Oe)}function qx(i,o){return Tu(i,Q(o,2))}function $x(i){return i&&i.length?mo(i,Oe,Qa):e}function jx(i,o){return i&&i.length?mo(i,Q(o,2),Qa):e}var Jx=Co(function(i,o){return i*o},1),Qx=ul("round"),tE=Co(function(i,o){return i-o},0);function eE(i){return i&&i.length?Na(i,Oe):0}function nE(i,o){return i&&i.length?Na(i,Q(o,2)):0}return y.after=Ry,y.ary=$c,y.assign=c1,y.assignIn=cf,y.assignInWith=ko,y.assignWith=f1,y.at=d1,y.before=jc,y.bind=wl,y.bindAll=yx,y.bindKey=Jc,y.castArray=ky,y.chain=Vc,y.chunk=Zp,y.compact=Kp,y.concat=Vp,y.cond=xx,y.conforms=Ex,y.constant=Ll,y.countBy=ey,y.create=g1,y.curry=Qc,y.curryRight=tf,y.debounce=ef,y.defaults=_1,y.defaultsDeep=m1,y.defer=Ty,y.delay=Iy,y.difference=Hp,y.differenceBy=qp,y.differenceWith=$p,y.drop=jp,y.dropRight=Jp,y.dropRightWhile=Qp,y.dropWhile=t0,y.fill=e0,y.filter=iy,y.flatMap=oy,y.flatMapDeep=ay,y.flatMapDepth=ly,y.flatten=Yc,y.flattenDeep=n0,y.flattenDepth=i0,y.flip=Sy,y.flow=wx,y.flowRight=Cx,y.fromPairs=r0,y.functions=C1,y.functionsIn=R1,y.groupBy=hy,y.initial=o0,y.intersection=a0,y.intersectionBy=l0,y.intersectionWith=h0,y.invert=I1,y.invertBy=S1,y.invokeMap=cy,y.iteratee=bl,y.keyBy=fy,y.keys=te,y.keysIn=Me,y.map=bo,y.mapKeys=L1,y.mapValues=b1,y.matches=Rx,y.matchesProperty=Tx,y.memoize=Oo,y.merge=M1,y.mergeWith=ff,y.method=Ix,y.methodOf=Sx,y.mixin=Ml,y.negate=Po,y.nthArg=Lx,y.omit=O1,y.omitBy=P1,y.once=Ay,y.orderBy=dy,y.over=bx,y.overArgs=Ly,y.overEvery=Mx,y.overSome=Ox,y.partial=Cl,y.partialRight=nf,y.partition=gy,y.pick=D1,y.pickBy=df,y.property=Ef,y.propertyOf=Px,y.pull=d0,y.pullAll=Zc,y.pullAllBy=g0,y.pullAllWith=_0,y.pullAt=m0,y.range=Dx,y.rangeRight=Fx,y.rearg=by,y.reject=py,y.remove=p0,y.rest=My,y.reverse=El,y.sampleSize=xy,y.set=k1,y.setWith=N1,y.shuffle=Ey,y.slice=y0,y.sortBy=Cy,y.sortedUniq=T0,y.sortedUniqBy=I0,y.split=ox,y.spread=Oy,y.tail=S0,y.take=A0,y.takeRight=L0,y.takeRightWhile=b0,y.takeWhile=M0,y.tap=K0,y.throttle=Py,y.thru=Lo,y.toArray=lf,y.toPairs=gf,y.toPairsIn=_f,y.toPath=zx,y.toPlainObject=uf,y.transform=G1,y.unary=Dy,y.union=O0,y.unionBy=P0,y.unionWith=D0,y.uniq=F0,y.uniqBy=k0,y.uniqWith=N0,y.unset=W1,y.unzip=vl,y.unzipWith=Kc,y.update=z1,y.updateWith=X1,y.values=Er,y.valuesIn=B1,y.without=G0,y.words=yf,y.wrap=Fy,y.xor=W0,y.xorBy=z0,y.xorWith=X0,y.zip=B0,y.zipObject=Y0,y.zipObjectDeep=U0,y.zipWith=Z0,y.entries=gf,y.entriesIn=_f,y.extend=cf,y.extendWith=ko,Ml(y,y),y.add=Bx,y.attempt=xf,y.camelCase=K1,y.capitalize=mf,y.ceil=Yx,y.clamp=Y1,y.clone=Ny,y.cloneDeep=Wy,y.cloneDeepWith=zy,y.cloneWith=Gy,y.conformsTo=Xy,y.deburr=pf,y.defaultTo=vx,y.divide=Ux,y.endsWith=V1,y.eq=_n,y.escape=H1,y.escapeRegExp=q1,y.every=ny,y.find=ry,y.findIndex=Xc,y.findKey=p1,y.findLast=sy,y.findLastIndex=Bc,y.findLastKey=y1,y.floor=Zx,y.forEach=Hc,y.forEachRight=qc,y.forIn=x1,y.forInRight=E1,y.forOwn=v1,y.forOwnRight=w1,y.get=Il,y.gt=By,y.gte=Yy,y.has=T1,y.hasIn=Sl,y.head=Uc,y.identity=Oe,y.includes=uy,y.indexOf=s0,y.inRange=U1,y.invoke=A1,y.isArguments=Zi,y.isArray=st,y.isArrayBuffer=Uy,y.isArrayLike=be,y.isArrayLikeObject=Ut,y.isBoolean=Zy,y.isBuffer=_i,y.isDate=Ky,y.isElement=Vy,y.isEmpty=Hy,y.isEqual=qy,y.isEqualWith=$y,y.isError=Rl,y.isFinite=jy,y.isFunction=zn,y.isInteger=rf,y.isLength=Do,y.isMap=sf,y.isMatch=Jy,y.isMatchWith=Qy,y.isNaN=t1,y.isNative=e1,y.isNil=i1,y.isNull=n1,y.isNumber=of,y.isObject=Xt,y.isObjectLike=Bt,y.isPlainObject=cs,y.isRegExp=Tl,y.isSafeInteger=r1,y.isSet=af,y.isString=Fo,y.isSymbol=Ue,y.isTypedArray=xr,y.isUndefined=s1,y.isWeakMap=o1,y.isWeakSet=a1,y.join=u0,y.kebabCase=$1,y.last=nn,y.lastIndexOf=c0,y.lowerCase=j1,y.lowerFirst=J1,y.lt=l1,y.lte=h1,y.max=Kx,y.maxBy=Vx,y.mean=Hx,y.meanBy=qx,y.min=$x,y.minBy=jx,y.stubArray=Pl,y.stubFalse=Dl,y.stubObject=kx,y.stubString=Nx,y.stubTrue=Gx,y.multiply=Jx,y.nth=f0,y.noConflict=Ax,y.noop=Ol,y.now=Mo,y.pad=Q1,y.padEnd=tx,y.padStart=ex,y.parseInt=nx,y.random=Z1,y.reduce=_y,y.reduceRight=my,y.repeat=ix,y.replace=rx,y.result=F1,y.round=Qx,y.runInContext=A,y.sample=yy,y.size=vy,y.snakeCase=sx,y.some=wy,y.sortedIndex=x0,y.sortedIndexBy=E0,y.sortedIndexOf=v0,y.sortedLastIndex=w0,y.sortedLastIndexBy=C0,y.sortedLastIndexOf=R0,y.startCase=ax,y.startsWith=lx,y.subtract=tE,y.sum=eE,y.sumBy=nE,y.template=hx,y.times=Wx,y.toFinite=Xn,y.toInteger=at,y.toLength=hf,y.toLower=ux,y.toNumber=rn,y.toSafeInteger=u1,y.toString=At,y.toUpper=cx,y.trim=fx,y.trimEnd=dx,y.trimStart=gx,y.truncate=_x,y.unescape=mx,y.uniqueId=Xx,y.upperCase=px,y.upperFirst=Al,y.each=Hc,y.eachRight=qc,y.first=Uc,Ml(y,function(){var i={};return Rn(y,function(o,u){bt.call(y.prototype,u)||(i[u]=o)}),i}(),{chain:!1}),y.VERSION=n,je(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){y[i].placeholder=y}),je(["drop","take"],function(i,o){pt.prototype[i]=function(u){u=u===e?1:Qt(at(u),0);var d=this.__filtered__&&!o?new pt(this):this.clone();return d.__filtered__?d.__takeCount__=he(u,d.__takeCount__):d.__views__.push({size:he(u,Ot),type:i+(d.__dir__<0?"Right":"")}),d},pt.prototype[i+"Right"]=function(u){return this.reverse()[i](u).reverse()}}),je(["filter","map","takeWhile"],function(i,o){var u=o+1,d=u==Gt||u==J;pt.prototype[i]=function(m){var E=this.clone();return E.__iteratees__.push({iteratee:Q(m,3),type:u}),E.__filtered__=E.__filtered__||d,E}}),je(["head","last"],function(i,o){var u="take"+(o?"Right":"");pt.prototype[i]=function(){return this[u](1).value()[0]}}),je(["initial","tail"],function(i,o){var u="drop"+(o?"":"Right");pt.prototype[i]=function(){return this.__filtered__?new pt(this):this[u](1)}}),pt.prototype.compact=function(){return this.filter(Oe)},pt.prototype.find=function(i){return this.filter(i).head()},pt.prototype.findLast=function(i){return this.reverse().find(i)},pt.prototype.invokeMap=ct(function(i,o){return typeof i=="function"?new pt(this):this.map(function(u){return ss(u,i,o)})}),pt.prototype.reject=function(i){return this.filter(Po(Q(i)))},pt.prototype.slice=function(i,o){i=at(i);var u=this;return u.__filtered__&&(i>0||o<0)?new pt(u):(i<0?u=u.takeRight(-i):i&&(u=u.drop(i)),o!==e&&(o=at(o),u=o<0?u.dropRight(-o):u.take(o-i)),u)},pt.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},pt.prototype.toArray=function(){return this.take(Ot)},Rn(pt.prototype,function(i,o){var u=/^(?:filter|find|map|reject)|While$/.test(o),d=/^(?:head|last)$/.test(o),m=y[d?"take"+(o=="last"?"Right":""):o],E=d||/^find/.test(o);m&&(y.prototype[o]=function(){var C=this.__wrapped__,I=d?[1]:arguments,L=C instanceof pt,k=I[0],N=L||st(C),W=function(dt){var yt=m.apply(y,li([dt],I));return d&&Y?yt[0]:yt};N&&u&&typeof k=="function"&&k.length!=1&&(L=N=!1);var Y=this.__chain__,K=!!this.__actions__.length,tt=E&&!Y,lt=L&&!K;if(!E&&N){C=lt?C:new pt(this);var et=i.apply(C,I);return et.__actions__.push({func:Lo,args:[W],thisArg:e}),new Qe(et,Y)}return tt&&lt?i.apply(this,I):(et=this.thru(W),tt?d?et.value()[0]:et.value():et)})}),je(["pop","push","shift","sort","splice","unshift"],function(i){var o=to[i],u=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",d=/^(?:pop|shift)$/.test(i);y.prototype[i]=function(){var m=arguments;if(d&&!this.__chain__){var E=this.value();return o.apply(st(E)?E:[],m)}return this[u](function(C){return o.apply(st(C)?C:[],m)})}}),Rn(pt.prototype,function(i,o){var u=y[o];if(u){var d=u.name+"";bt.call(gr,d)||(gr[d]=[]),gr[d].push({name:o,func:u})}}),gr[wo(e,T).name]=[{name:"wrapper",func:e}],pt.prototype.clone=mm,pt.prototype.reverse=pm,pt.prototype.value=ym,y.prototype.at=V0,y.prototype.chain=H0,y.prototype.commit=q0,y.prototype.next=$0,y.prototype.plant=J0,y.prototype.reverse=Q0,y.prototype.toJSON=y.prototype.valueOf=y.prototype.value=ty,y.prototype.first=y.prototype.head,Jr&&(y.prototype[Jr]=j0),y},cr=q_();Ni?((Ni.exports=cr)._=cr,ba._=cr):se._=cr}).call(fs)})(qo,qo.exports);var uE=qo.exports;class Qn{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const Gr={PROPERTYCHANGE:"propertychange"};class gh{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function cE(r,t,e){let n,s;e=e||Si;let a=0,l=r.length,h=!1;for(;a<l;)n=a+(l-a>>1),s=+e(r[n],t),s<0?a=n+1:(l=n,h=!s);return h?a:~a}function Si(r,t){return r>t?1:r<t?-1:0}function _h(r,t,e){if(r[0]<=t)return 0;const n=r.length;if(t<=r[n-1])return n-1;if(typeof e=="function"){for(let s=1;s<n;++s){const a=r[s];if(a===t)return s;if(a<t)return e(t,r[s-1],a)>0?s-1:s}return n-1}if(e>0){for(let s=1;s<n;++s)if(r[s]<t)return s-1;return n-1}if(e<0){for(let s=1;s<n;++s)if(r[s]<=t)return s;return n-1}for(let s=1;s<n;++s){if(r[s]==t)return s;if(r[s]<t)return r[s-1]-t<t-r[s]?s-1:s}return n-1}function fE(r,t,e){for(;t<e;){const n=r[t];r[t]=r[e],r[e]=n,++t,--e}}function mh(r,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let s=0;s<n;s++)r[r.length]=e[s]}function bi(r,t){const e=r.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(r[n]!==t[n])return!1;return!0}function dE(r,t,e){const n=t||Si;return r.every(function(s,a){if(a===0)return!0;const l=n(r[a-1],s);return!(l>0||l===0)})}function ws(){return!0}function aa(){return!1}function Wr(){}function Td(r){let t=!1,e,n,s;return function(){const a=Array.prototype.slice.call(arguments);return(!t||this!==s||!bi(a,n))&&(t=!0,s=this,n=a,e=r.apply(this,arguments)),e}}function Fs(r){for(const t in r)delete r[t]}function zr(r){let t;for(t in r)return!1;return!t}class la extends gh{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),s=n[t]||(n[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const a=e?new Qn(t):t;a.target||(a.target=this.eventTarget_||this);const l=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});n in l||(l[n]=0,h[n]=0),++l[n];let c;for(let f=0,g=s.length;f<g;++f)if("handleEvent"in s[f]?c=s[f].handleEvent(a):c=s[f].call(this,a),c===!1||a.propagationStopped){c=!1;break}if(--l[n]===0){let f=h[n];for(delete h[n];f--;)this.removeEventListener(n,Wr);delete l[n]}return c}disposeInternal(){this.listeners_&&Fs(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const s=n.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[s]=Wr,++this.pendingRemovals_[t]):(n.splice(s,1),n.length===0&&delete this.listeners_[t]))}}const ht={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function Ct(r,t,e,n,s){if(n&&n!==r&&(e=e.bind(n)),s){const l=e;e=function(){r.removeEventListener(t,e),l.apply(this,arguments)}}const a={target:r,type:t,listener:e};return r.addEventListener(t,e),a}function $o(r,t,e,n){return Ct(r,t,e,n,!0)}function zt(r){r&&r.target&&(r.target.removeEventListener(r.type,r.listener),Fs(r))}class ks extends la{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ht.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Ct(this,t[a],e);return s}return Ct(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const s=t.length;n=new Array(s);for(let a=0;a<s;++a)n[a]=$o(this,t[a],e)}else n=$o(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)gE(n);else if(Array.isArray(t))for(let s=0,a=t.length;s<a;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}}ks.prototype.on;ks.prototype.once;ks.prototype.un;function gE(r){if(Array.isArray(r))for(let t=0,e=r.length;t<e;++t)zt(r[t]);else zt(r)}function wt(){throw new Error("Unimplemented abstract method.")}let _E=0;function It(r){return r.ol_uid||(r.ol_uid=String(++_E))}class Rf extends Qn{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}}class On extends ks{constructor(t){super(),this.on,this.once,this.un,It(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Rf(n,t,e)),n=Gr.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Rf(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const s=this.values_||(this.values_={});if(n)s[t]=e;else{const a=s[t];s[t]=e,a!==e&&this.notify(t,a)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],zr(this.values_)&&(this.values_=null),e||this.notify(t,n)}}}const De={ADD:"add",REMOVE:"remove"},Tf={LENGTH:"length"};class No extends Qn{constructor(t,e,n){super(t),this.element=e,this.index=n}}class An extends On{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let n=0,s=this.array_.length;n<s;++n)this.assertUnique_(this.array_[n],n);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,n=t.length;e<n;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let n=0,s=e.length;n<s;++n)t(e[n],n,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Tf.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new No(De.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let n=0,s=e.length;n<s;++n)if(e[n]===t)return this.removeAt(n)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new No(De.REMOVE,e,t)),e}setAt(t,e){const n=this.getLength();if(t>=n){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const s=this.array_[t];this.array_[t]=e,this.dispatchEvent(new No(De.REMOVE,s,t)),this.dispatchEvent(new No(De.ADD,e,t))}updateLength_(){this.set(Tf.LENGTH,this.array_.length)}assertUnique_(t,e){for(let n=0,s=this.array_.length;n<s;++n)if(this.array_[n]===t&&n!==e)throw new Error("Duplicate item added to a unique collection")}}function vt(r,t){if(!r)throw new Error(t)}class ph extends On{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new ph(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const n=this.getStyle();return n&&t.setStyle(n),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(zt(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Ct(t,ht.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?mE(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function mE(r){if(typeof r=="function")return r;let t;return Array.isArray(r)?t=r:(vt(typeof r.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[r]),function(){return t}}const Ai=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",pE=Ai.includes("firefox"),yE=Ai.includes("safari")&&!Ai.includes("chrom");yE&&(Ai.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Ai));const xE=Ai.includes("webkit")&&!Ai.includes("edge"),Id=Ai.includes("macintosh"),Sd=typeof devicePixelRatio<"u"?devicePixelRatio:1,yh=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,Ad=typeof Image<"u"&&Image.prototype.decode,Ld=function(){let r=!1;try{const t=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return r}();new Array(6);function vn(){return[1,0,0,1,0,0]}function EE(r,t,e,n,s,a,l){return r[0]=t,r[1]=e,r[2]=n,r[3]=s,r[4]=a,r[5]=l,r}function vE(r,t){return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r}function ne(r,t){const e=t[0],n=t[1];return t[0]=r[0]*e+r[2]*n+r[4],t[1]=r[1]*e+r[3]*n+r[5],t}function wE(r,t,e){return EE(r,t,0,0,e,0,0)}function $n(r,t,e,n,s,a,l,h){const c=Math.sin(a),f=Math.cos(a);return r[0]=n*f,r[1]=s*c,r[2]=-n*c,r[3]=s*f,r[4]=l*n*f-h*n*c+t,r[5]=l*s*c+h*s*f+e,r}function xh(r,t){const e=CE(t);vt(e!==0,"Transformation matrix cannot be inverted");const n=t[0],s=t[1],a=t[2],l=t[3],h=t[4],c=t[5];return r[0]=l/e,r[1]=-s/e,r[2]=-a/e,r[3]=n/e,r[4]=(a*c-l*h)/e,r[5]=-(n*c-s*h)/e,r}function CE(r){return r[0]*r[3]-r[1]*r[2]}let If;function bd(r){const t="matrix("+r.join(", ")+")";if(yh)return t;const e=If||(If=document.createElement("div"));return e.style.transform=t,e.style.transform}const ee={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Sf(r){const t=an();for(let e=0,n=r.length;e<n;++e)Es(t,r[e]);return t}function RE(r,t,e){const n=Math.min.apply(null,r),s=Math.min.apply(null,t),a=Math.max.apply(null,r),l=Math.max.apply(null,t);return jn(n,s,a,l,e)}function Eh(r,t,e){return e?(e[0]=r[0]-t,e[1]=r[1]-t,e[2]=r[2]+t,e[3]=r[3]+t,e):[r[0]-t,r[1]-t,r[2]+t,r[3]+t]}function Md(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r.slice()}function Od(r,t,e){let n,s;return t<r[0]?n=r[0]-t:r[2]<t?n=t-r[2]:n=0,e<r[1]?s=r[1]-e:r[3]<e?s=e-r[3]:s=0,n*n+s*s}function ha(r,t){return Pd(r,t[0],t[1])}function Mr(r,t){return r[0]<=t[0]&&t[2]<=r[2]&&r[1]<=t[1]&&t[3]<=r[3]}function Pd(r,t,e){return r[0]<=t&&t<=r[2]&&r[1]<=e&&e<=r[3]}function Ql(r,t){const e=r[0],n=r[1],s=r[2],a=r[3],l=t[0],h=t[1];let c=ee.UNKNOWN;return l<e?c=c|ee.LEFT:l>s&&(c=c|ee.RIGHT),h<n?c=c|ee.BELOW:h>a&&(c=c|ee.ABOVE),c===ee.UNKNOWN&&(c=ee.INTERSECTING),c}function an(){return[1/0,1/0,-1/0,-1/0]}function jn(r,t,e,n,s){return s?(s[0]=r,s[1]=t,s[2]=e,s[3]=n,s):[r,t,e,n]}function Ns(r){return jn(1/0,1/0,-1/0,-1/0,r)}function Dd(r,t){const e=r[0],n=r[1];return jn(e,n,e,n,t)}function vh(r,t,e,n,s){const a=Ns(s);return Fd(a,r,t,e,n)}function Cs(r,t){return r[0]==t[0]&&r[2]==t[2]&&r[1]==t[1]&&r[3]==t[3]}function TE(r,t){return t[0]<r[0]&&(r[0]=t[0]),t[2]>r[2]&&(r[2]=t[2]),t[1]<r[1]&&(r[1]=t[1]),t[3]>r[3]&&(r[3]=t[3]),r}function Es(r,t){t[0]<r[0]&&(r[0]=t[0]),t[0]>r[2]&&(r[2]=t[0]),t[1]<r[1]&&(r[1]=t[1]),t[1]>r[3]&&(r[3]=t[1])}function Fd(r,t,e,n,s){for(;e<n;e+=s)IE(r,t[e],t[e+1]);return r}function IE(r,t,e){r[0]=Math.min(r[0],t),r[1]=Math.min(r[1],e),r[2]=Math.max(r[2],t),r[3]=Math.max(r[3],e)}function kd(r,t){let e;return e=t(ua(r)),e||(e=t(ca(r)),e)||(e=t(fa(r)),e)||(e=t(nr(r)),e)?e:!1}function th(r){let t=0;return Gs(r)||(t=kt(r)*He(r)),t}function ua(r){return[r[0],r[1]]}function ca(r){return[r[2],r[1]]}function er(r){return[(r[0]+r[2])/2,(r[1]+r[3])/2]}function SE(r,t){let e;if(t==="bottom-left")e=ua(r);else if(t==="bottom-right")e=ca(r);else if(t==="top-left")e=nr(r);else if(t==="top-right")e=fa(r);else throw new Error("Invalid corner");return e}function eh(r,t,e,n,s){const[a,l,h,c,f,g,_,p]=nh(r,t,e,n);return jn(Math.min(a,h,f,_),Math.min(l,c,g,p),Math.max(a,h,f,_),Math.max(l,c,g,p),s)}function nh(r,t,e,n){const s=t*n[0]/2,a=t*n[1]/2,l=Math.cos(e),h=Math.sin(e),c=s*l,f=s*h,g=a*l,_=a*h,p=r[0],x=r[1];return[p-c+_,x-f-g,p-c-_,x-f+g,p+c-_,x+f+g,p+c+_,x+f-g,p-c+_,x-f-g]}function He(r){return r[3]-r[1]}function vs(r,t,e){const n=e||an();return ke(r,t)?(r[0]>t[0]?n[0]=r[0]:n[0]=t[0],r[1]>t[1]?n[1]=r[1]:n[1]=t[1],r[2]<t[2]?n[2]=r[2]:n[2]=t[2],r[3]<t[3]?n[3]=r[3]:n[3]=t[3]):Ns(n),n}function nr(r){return[r[0],r[3]]}function fa(r){return[r[2],r[3]]}function kt(r){return r[2]-r[0]}function ke(r,t){return r[0]<=t[2]&&r[2]>=t[0]&&r[1]<=t[3]&&r[3]>=t[1]}function Gs(r){return r[2]<r[0]||r[3]<r[1]}function AE(r,t){return t?(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t):r}function LE(r,t,e){let n=!1;const s=Ql(r,t),a=Ql(r,e);if(s===ee.INTERSECTING||a===ee.INTERSECTING)n=!0;else{const l=r[0],h=r[1],c=r[2],f=r[3],g=t[0],_=t[1],p=e[0],x=e[1],v=(x-_)/(p-g);let w,R;a&ee.ABOVE&&!(s&ee.ABOVE)&&(w=p-(x-f)/v,n=w>=l&&w<=c),!n&&a&ee.RIGHT&&!(s&ee.RIGHT)&&(R=x-(p-c)*v,n=R>=h&&R<=f),!n&&a&ee.BELOW&&!(s&ee.BELOW)&&(w=p-(x-h)/v,n=w>=l&&w<=c),!n&&a&ee.LEFT&&!(s&ee.LEFT)&&(R=x-(p-l)*v,n=R>=h&&R<=f)}return n}function bE(r,t,e,n){if(Gs(r))return Ns(e);let s=[];s=[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]],t(s,s,2);const a=[],l=[];for(let h=0,c=s.length;h<c;h+=2)a.push(s[h]),l.push(s[h+1]);return RE(a,l,e)}function Nd(r,t){const e=t.getExtent(),n=er(r);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const s=kt(e),l=Math.floor((n[0]-e[0])/s)*s;r[0]-=l,r[2]-=l}return r}function ME(r,t){if(t.canWrapX()){const e=t.getExtent();if(!isFinite(r[0])||!isFinite(r[2]))return[[e[0],r[1],e[2],r[3]]];Nd(r,t);const n=kt(e);if(kt(r)>n)return[[e[0],r[1],e[2],r[3]]];if(r[0]<e[0])return[[r[0]+n,r[1],e[2],r[3]],[e[0],r[1],r[2],r[3]]];if(r[2]>e[2])return[[r[0],r[1],e[2],r[3]],[e[0],r[1],r[2]-n,r[3]]]}return[r]}const wh={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class Gd{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||wh[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const Ws=6378137,Or=Math.PI*Ws,OE=[-Or,-Or,Or,Or],PE=[-180,-85,180,85],Go=Ws*Math.log(Math.tan(Math.PI/2));class vr extends Gd{constructor(t){super({code:t,units:"m",extent:OE,global:!0,worldExtent:PE,getPointResolution:function(e,n){return e/Math.cosh(n[1]/Ws)}})}}const Af=[new vr("EPSG:3857"),new vr("EPSG:102100"),new vr("EPSG:102113"),new vr("EPSG:900913"),new vr("http://www.opengis.net/def/crs/EPSG/0/3857"),new vr("http://www.opengis.net/gml/srs/epsg.xml#3857")];function DE(r,t,e){const n=r.length;e=e>1?e:2,t===void 0&&(e>2?t=r.slice():t=new Array(n));for(let s=0;s<n;s+=e){t[s]=Or*r[s]/180;let a=Ws*Math.log(Math.tan(Math.PI*(+r[s+1]+90)/360));a>Go?a=Go:a<-Go&&(a=-Go),t[s+1]=a}return t}function FE(r,t,e){const n=r.length;e=e>1?e:2,t===void 0&&(e>2?t=r.slice():t=new Array(n));for(let s=0;s<n;s+=e)t[s]=180*r[s]/Or,t[s+1]=360*Math.atan(Math.exp(r[s+1]/Ws))/Math.PI-90;return t}const kE=6378137,Lf=[-180,-90,180,90],NE=Math.PI*kE/180;class Ki extends Gd{constructor(t,e){super({code:t,units:"degrees",extent:Lf,axisOrientation:e,global:!0,metersPerUnit:NE,worldExtent:Lf})}}const bf=[new Ki("CRS:84"),new Ki("EPSG:4326","neu"),new Ki("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ki("urn:ogc:def:crs:OGC:2:84"),new Ki("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Ki("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ki("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ih={};function GE(r){return ih[r]||ih[r.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function WE(r,t){ih[r]=t}let Fr={};function jo(r,t,e){const n=r.getCode(),s=t.getCode();n in Fr||(Fr[n]={}),Fr[n][s]=e}function zE(r,t){let e;return r in Fr&&t in Fr[r]&&(e=Fr[r][t]),e}function qt(r,t,e){return Math.min(Math.max(r,t),e)}function XE(r,t,e,n,s,a){const l=s-e,h=a-n;if(l!==0||h!==0){const c=((r-e)*l+(t-n)*h)/(l*l+h*h);c>1?(e=s,n=a):c>0&&(e+=l*c,n+=h*c)}return kr(r,t,e,n)}function kr(r,t,e,n){const s=e-r,a=n-t;return s*s+a*a}function BE(r){const t=r.length;for(let n=0;n<t;n++){let s=n,a=Math.abs(r[n][n]);for(let h=n+1;h<t;h++){const c=Math.abs(r[h][n]);c>a&&(a=c,s=h)}if(a===0)return null;const l=r[s];r[s]=r[n],r[n]=l;for(let h=n+1;h<t;h++){const c=-r[h][n]/r[n][n];for(let f=n;f<t+1;f++)n==f?r[h][f]=0:r[h][f]+=c*r[n][f]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=r[n][t]/r[n][n];for(let s=n-1;s>=0;s--)r[s][t]-=r[s][n]*e[n]}return e}function Ho(r){return r*Math.PI/180}function tr(r,t){const e=r%t;return e*t<0?e+t:e}function on(r,t,e){return r+e*(t-r)}function Ch(r,t){const e=Math.pow(10,t);return Math.round(r*e)/e}function Wo(r,t){return Math.floor(Ch(r,t))}function zo(r,t){return Math.ceil(Ch(r,t))}function YE(r,t){return r[0]+=+t[0],r[1]+=+t[1],r}function Jo(r,t){let e=!0;for(let n=r.length-1;n>=0;--n)if(r[n]!=t[n]){e=!1;break}return e}function Rh(r,t){const e=Math.cos(t),n=Math.sin(t),s=r[0]*e-r[1]*n,a=r[1]*e+r[0]*n;return r[0]=s,r[1]=a,r}function UE(r,t){return r[0]*=t,r[1]*=t,r}function Wd(r,t){if(t.canWrapX()){const e=kt(t.getExtent()),n=ZE(r,t,e);n&&(r[0]-=n*e)}return r}function ZE(r,t,e){const n=t.getExtent();let s=0;return t.canWrapX()&&(r[0]<n[0]||r[0]>n[2])&&(e=e||kt(n),s=Math.floor((r[0]-n[0])/e)),s}const KE=63710088e-1;function Mf(r,t,e){e=e||KE;const n=Ho(r[1]),s=Ho(t[1]),a=(s-n)/2,l=Ho(t[0]-r[0])/2,h=Math.sin(a)*Math.sin(a)+Math.sin(l)*Math.sin(l)*Math.cos(n)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function zd(...r){console.warn(...r)}let rh=!0;function Xd(r){rh=!1}function Th(r,t){if(t!==void 0){for(let e=0,n=r.length;e<n;++e)t[e]=r[e];t=t}else t=r.slice();return t}function Bd(r,t){if(t!==void 0&&r!==t){for(let e=0,n=r.length;e<n;++e)t[e]=r[e];r=t}return r}function VE(r){WE(r.getCode(),r),jo(r,r,Th)}function HE(r){r.forEach(VE)}function ln(r){return typeof r=="string"?GE(r):r||null}function Of(r,t,e,n){r=ln(r);let s;const a=r.getPointResolutionFunc();if(a)s=a(t,e);else{const l=r.getUnits();if(l=="degrees"&&!n||n=="degrees")s=t;else{const h=Sh(r,ln("EPSG:4326"));if(h===Bd&&l!=="degrees")s=t*r.getMetersPerUnit();else{let f=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];f=h(f,f,2);const g=Mf(f.slice(0,2),f.slice(2,4)),_=Mf(f.slice(4,6),f.slice(6,8));s=(g+_)/2}const c=r.getMetersPerUnit();c!==void 0&&(s/=c)}}return s}function Pf(r){HE(r),r.forEach(function(t){r.forEach(function(e){t!==e&&jo(t,e,Th)})})}function qE(r,t,e,n){r.forEach(function(s){t.forEach(function(a){jo(s,a,e),jo(a,s,n)})})}function Ih(r,t){return r?typeof r=="string"?ln(r):r:ln(t)}function kl(r,t){return Xd(),Ah(r,"EPSG:4326","EPSG:3857")}function Df(r,t){const e=Ah(r,"EPSG:3857","EPSG:4326"),n=e[0];return(n<-180||n>180)&&(e[0]=tr(n+180,360)-180),e}function Ir(r,t){if(r===t)return!0;const e=r.getUnits()===t.getUnits();return(r.getCode()===t.getCode()||Sh(r,t)===Th)&&e}function Sh(r,t){const e=r.getCode(),n=t.getCode();let s=zE(e,n);return s||(s=Bd),s}function Rs(r,t){const e=ln(r),n=ln(t);return Sh(e,n)}function Ah(r,t,e){return Rs(t,e)(r,void 0,r.length)}function $E(r,t,e,n){const s=Rs(t,e);return bE(r,s,void 0)}function sh(r,t){return r}function Zn(r,t){return rh&&!Jo(r,[0,0])&&r[0]>=-180&&r[0]<=180&&r[1]>=-90&&r[1]<=90&&(rh=!1,zd("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),r}function Yd(r,t){return r}function $i(r,t){return r}function jE(){Pf(Af),Pf(bf),qE(bf,Af,DE,FE)}jE();function Ii(r,t,e,n,s,a){a=a||[];let l=0;for(let h=t;h<e;h+=n){const c=r[h],f=r[h+1];a[l++]=s[0]*c+s[2]*f+s[4],a[l++]=s[1]*c+s[3]*f+s[5]}return a&&a.length!=l&&(a.length=l),a}function Ud(r,t,e,n,s,a,l){l=l||[];const h=Math.cos(s),c=Math.sin(s),f=a[0],g=a[1];let _=0;for(let p=t;p<e;p+=n){const x=r[p]-f,v=r[p+1]-g;l[_++]=f+x*h-v*c,l[_++]=g+x*c+v*h;for(let w=p+2;w<p+n;++w)l[_++]=r[w]}return l&&l.length!=_&&(l.length=_),l}function JE(r,t,e,n,s,a,l,h){h=h||[];const c=l[0],f=l[1];let g=0;for(let _=t;_<e;_+=n){const p=r[_]-c,x=r[_+1]-f;h[g++]=c+s*p,h[g++]=f+a*x;for(let v=_+2;v<_+n;++v)h[g++]=r[v]}return h&&h.length!=g&&(h.length=g),h}function QE(r,t,e,n,s,a,l){l=l||[];let h=0;for(let c=t;c<e;c+=n){l[h++]=r[c]+s,l[h++]=r[c+1]+a;for(let f=c+2;f<c+n;++f)l[h++]=r[f]}return l&&l.length!=h&&(l.length=h),l}const Ff=vn();class tv extends On{constructor(){super(),this.extent_=an(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Td((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return wt()}closestPointXY(t,e,n,s){return wt()}containsXY(t,e){const n=this.getClosestPoint([t,e]);return n[0]===t&&n[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return wt()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&Ns(e),this.extentRevision_=this.getRevision()}return AE(this.extent_,t)}rotate(t,e){wt()}scale(t,e,n){wt()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return wt()}getType(){return wt()}applyTransform(t){wt()}intersectsExtent(t){return wt()}translate(t,e){wt()}transform(t,e){const n=ln(t),s=n.getUnits()=="tile-pixels"?function(a,l,h){const c=n.getExtent(),f=n.getWorldExtent(),g=He(f)/He(c);return $n(Ff,f[0],f[3],g,-g,0,0,0),Ii(a,0,a.length,h,Ff,l),Rs(n,e)(a,l,h)}:Rs(n,e);return this.applyTransform(s),this}}class Lh extends tv{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return vh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return wt()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=kf(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){wt()}setLayout(t,e,n){let s;if(t)s=kf(t);else{for(let a=0;a<n;++a){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=ev(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();Ud(n,0,n.length,s,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=er(this.getExtent()));const s=this.getFlatCoordinates();if(s){const a=this.getStride();JE(s,0,s.length,a,t,e,n,s),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();QE(n,0,n.length,s,t,e,n),this.changed()}}}function ev(r){let t;return r==2?t="XY":r==3?t="XYZ":r==4&&(t="XYZM"),t}function kf(r){let t;return r=="XY"?t=2:r=="XYZ"||r=="XYM"?t=3:r=="XYZM"&&(t=4),t}function nv(r,t,e){const n=r.getFlatCoordinates();if(!n)return null;const s=r.getStride();return Ii(n,0,n.length,s,t,e)}function Nf(r,t,e,n,s,a,l){const h=r[t],c=r[t+1],f=r[e]-h,g=r[e+1]-c;let _;if(f===0&&g===0)_=t;else{const p=((s-h)*f+(a-c)*g)/(f*f+g*g);if(p>1)_=e;else if(p>0){for(let x=0;x<n;++x)l[x]=on(r[t+x],r[e+x],p);l.length=n;return}else _=t}for(let p=0;p<n;++p)l[p]=r[_+p];l.length=n}function Zd(r,t,e,n,s){let a=r[t],l=r[t+1];for(t+=n;t<e;t+=n){const h=r[t],c=r[t+1],f=kr(a,l,h,c);f>s&&(s=f),a=h,l=c}return s}function iv(r,t,e,n,s){for(let a=0,l=e.length;a<l;++a){const h=e[a];s=Zd(r,t,h,n,s),t=h}return s}function Kd(r,t,e,n,s,a,l,h,c,f,g){if(t==e)return f;let _,p;if(s===0){if(p=kr(l,h,r[t],r[t+1]),p<f){for(_=0;_<n;++_)c[_]=r[t+_];return c.length=n,p}return f}g=g||[NaN,NaN];let x=t+n;for(;x<e;)if(Nf(r,x-n,x,n,l,h,g),p=kr(l,h,g[0],g[1]),p<f){for(f=p,_=0;_<n;++_)c[_]=g[_];c.length=n,x+=n}else x+=n*Math.max((Math.sqrt(p)-Math.sqrt(f))/s|0,1);if(Nf(r,e-n,t,n,l,h,g),p=kr(l,h,g[0],g[1]),p<f){for(f=p,_=0;_<n;++_)c[_]=g[_];c.length=n}return f}function rv(r,t,e,n,s,a,l,h,c,f,g){g=g||[NaN,NaN];for(let _=0,p=e.length;_<p;++_){const x=e[_];f=Kd(r,t,x,n,s,a,l,h,c,f,g),t=x}return f}function sv(r,t,e,n){for(let s=0,a=e.length;s<a;++s)r[t++]=e[s];return t}function Vd(r,t,e,n){for(let s=0,a=e.length;s<a;++s){const l=e[s];for(let h=0;h<n;++h)r[t++]=l[h]}return t}function ov(r,t,e,n,s){s=s||[];let a=0;for(let l=0,h=e.length;l<h;++l){const c=Vd(r,t,e[l],n);s[a++]=c,t=c}return s.length=a,s}function bh(r,t,e,n,s,a,l){const h=(e-t)/n;if(h<3){for(;t<e;t+=n)a[l++]=r[t],a[l++]=r[t+1];return l}const c=new Array(h);c[0]=1,c[h-1]=1;const f=[t,e-n];let g=0;for(;f.length>0;){const _=f.pop(),p=f.pop();let x=0;const v=r[p],w=r[p+1],R=r[_],T=r[_+1];for(let S=p+n;S<_;S+=n){const b=r[S],O=r[S+1],M=XE(b,O,v,w,R,T);M>x&&(g=S,x=M)}x>s&&(c[(g-t)/n]=1,p+n<g&&f.push(p,g),g+n<_&&f.push(g,_))}for(let _=0;_<h;++_)c[_]&&(a[l++]=r[t+_*n],a[l++]=r[t+_*n+1]);return l}function av(r,t,e,n,s,a,l,h){for(let c=0,f=e.length;c<f;++c){const g=e[c];l=bh(r,t,g,n,s,a,l),h.push(l),t=g}return l}function qi(r,t){return t*Math.round(r/t)}function lv(r,t,e,n,s,a,l){if(t==e)return l;let h=qi(r[t],s),c=qi(r[t+1],s);t+=n,a[l++]=h,a[l++]=c;let f,g;do if(f=qi(r[t],s),g=qi(r[t+1],s),t+=n,t==e)return a[l++]=f,a[l++]=g,l;while(f==h&&g==c);for(;t<e;){const _=qi(r[t],s),p=qi(r[t+1],s);if(t+=n,_==f&&p==g)continue;const x=f-h,v=g-c,w=_-h,R=p-c;if(x*R==v*w&&(x<0&&w<x||x==w||x>0&&w>x)&&(v<0&&R<v||v==R||v>0&&R>v)){f=_,g=p;continue}a[l++]=f,a[l++]=g,h=f,c=g,f=_,g=p}return a[l++]=f,a[l++]=g,l}function Hd(r,t,e,n,s,a,l,h){for(let c=0,f=e.length;c<f;++c){const g=e[c];l=lv(r,t,g,n,s,a,l),h.push(l),t=g}return l}function Pr(r,t,e,n,s){s=s!==void 0?s:[];let a=0;for(let l=t;l<e;l+=n)s[a++]=r.slice(l,l+n);return s.length=a,s}function Qo(r,t,e,n,s){s=s!==void 0?s:[];let a=0;for(let l=0,h=e.length;l<h;++l){const c=e[l];s[a++]=Pr(r,t,c,n,s[a]),t=c}return s.length=a,s}function Gf(r,t,e,n,s){s=s!==void 0?s:[];let a=0;for(let l=0,h=e.length;l<h;++l){const c=e[l];s[a++]=c.length===1&&c[0]===t?[]:Qo(r,t,c,n,s[a]),t=c[c.length-1]}return s.length=a,s}function qd(r,t,e,n){let s=0,a=r[e-n],l=r[e-n+1];for(;t<e;t+=n){const h=r[t],c=r[t+1];s+=l*h-a*c,a=h,l=c}return s/2}function hv(r,t,e,n){let s=0;for(let a=0,l=e.length;a<l;++a){const h=e[a];s+=qd(r,t,h,n),t=h}return s}class Ts extends Lh{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Ts(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,s){return s<Od(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Zd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Kd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,s))}getArea(){return qd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Pr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=bh(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ts(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vd(this.flatCoordinates,0,t,this.stride),this.changed()}}class da extends Lh{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new da(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){const a=this.flatCoordinates,l=kr(t,e,a[0],a[1]);if(l<s){const h=this.stride;for(let c=0;c<h;++c)n[c]=a[c];return n.length=h,l}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Dd(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Pd(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=sv(this.flatCoordinates,0,t,this.stride),this.changed()}}function uv(r,t,e,n,s){return!kd(s,function(l){return!ji(r,t,e,n,l[0],l[1])})}function ji(r,t,e,n,s,a){let l=0,h=r[e-n],c=r[e-n+1];for(;t<e;t+=n){const f=r[t],g=r[t+1];c<=a?g>a&&(f-h)*(a-c)-(s-h)*(g-c)>0&&l++:g<=a&&(f-h)*(a-c)-(s-h)*(g-c)<0&&l--,h=f,c=g}return l!==0}function $d(r,t,e,n,s,a){if(e.length===0||!ji(r,t,e[0],n,s,a))return!1;for(let l=1,h=e.length;l<h;++l)if(ji(r,e[l-1],e[l],n,s,a))return!1;return!0}function Mh(r,t,e,n,s,a,l){let h,c,f,g,_,p,x;const v=s[a+1],w=[];for(let S=0,b=e.length;S<b;++S){const O=e[S];for(g=r[O-n],p=r[O-n+1],h=t;h<O;h+=n)_=r[h],x=r[h+1],(v<=p&&x<=v||p<=v&&v<=x)&&(f=(v-p)/(x-p)*(_-g)+g,w.push(f)),g=_,p=x}let R=NaN,T=-1/0;for(w.sort(Si),g=w[0],h=1,c=w.length;h<c;++h){_=w[h];const S=Math.abs(_-g);S>T&&(f=(g+_)/2,$d(r,t,e,n,f,v)&&(R=f,T=S)),g=_}return isNaN(R)&&(R=s[a]),l?(l.push(R,v,T),l):[R,v,T]}function cv(r,t,e,n,s){let a=[];for(let l=0,h=e.length;l<h;++l){const c=e[l];a=Mh(r,t,c,n,s,2*l,a),t=c[c.length-1]}return a}function fv(r,t,e,n,s){let a;for(t+=n;t<e;t+=n)if(a=s(r.slice(t-n,t),r.slice(t,t+n)),a)return a;return!1}function jd(r,t,e,n,s){const a=Fd(an(),r,t,e,n);return ke(s,a)?Mr(s,a)||a[0]>=s[0]&&a[2]<=s[2]||a[1]>=s[1]&&a[3]<=s[3]?!0:fv(r,t,e,n,function(l,h){return LE(s,l,h)}):!1}function Jd(r,t,e,n,s){return!!(jd(r,t,e,n,s)||ji(r,t,e,n,s[0],s[1])||ji(r,t,e,n,s[0],s[3])||ji(r,t,e,n,s[2],s[1])||ji(r,t,e,n,s[2],s[3]))}function dv(r,t,e,n,s){if(!Jd(r,t,e[0],n,s))return!1;if(e.length===1)return!0;for(let a=1,l=e.length;a<l;++a)if(uv(r,e[a-1],e[a],n,s)&&!jd(r,e[a-1],e[a],n,s))return!1;return!0}function gv(r,t,e,n){for(;t<e-n;){for(let s=0;s<n;++s){const a=r[t+s];r[t+s]=r[e-n+s],r[e-n+s]=a}t+=n,e-=n}}function Oh(r,t,e,n){let s=0,a=r[e-n],l=r[e-n+1];for(;t<e;t+=n){const h=r[t],c=r[t+1];s+=(h-a)*(c+l),a=h,l=c}return s===0?void 0:s>0}function _v(r,t,e,n,s){s=s!==void 0?s:!1;for(let a=0,l=e.length;a<l;++a){const h=e[a],c=Oh(r,t,h,n);if(a===0){if(s&&c||!s&&!c)return!1}else if(s&&!c||!s&&c)return!1;t=h}return!0}function Wf(r,t,e,n,s){s=s!==void 0?s:!1;for(let a=0,l=e.length;a<l;++a){const h=e[a],c=Oh(r,t,h,n);(a===0?s&&c||!s&&!c:s&&!c||!s&&c)&&gv(r,t,h,n),t=h}return t}function mv(r,t){const e=[];let n=0,s=0,a;for(let l=0,h=t.length;l<h;++l){const c=t[l],f=Oh(r,n,c,2);if(a===void 0&&(a=f),f===a)e.push(t.slice(s,l+1));else{if(e.length===0)continue;e[e.length-1].push(t[s])}s=l+1,n=c}return e}class Is extends Lh{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?mh(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Is(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<Od(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(iv(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),rv(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return $d(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return hv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Wf(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Qo(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=er(this.getExtent());this.flatInteriorPoint_=Mh(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new da(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Ts(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,s=[];let a=0;for(let l=0,h=n.length;l<h;++l){const c=n[l],f=new Ts(e.slice(a,c),t);s.push(f),a=c}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;_v(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Wf(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Hd(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new Is(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return dv(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=ov(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function zf(r){if(Gs(r))throw new Error("Cannot create polygon from empty extent");const t=r[0],e=r[1],n=r[2],s=r[3],a=[t,e,t,s,n,s,n,e,t,e];return new Is(a,"XY",[a.length])}const bn={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class zs{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null}clone(){const t=this.getColor();return new zs({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){this.color_=t}}function Xf(r,t,e,n,s,a,l){let h,c;const f=(e-t)/n;if(f===1)h=t;else if(f===2)h=t,c=s;else if(f!==0){let g=r[t],_=r[t+1],p=0;const x=[0];for(let R=t+n;R<e;R+=n){const T=r[R],S=r[R+1];p+=Math.sqrt((T-g)*(T-g)+(S-_)*(S-_)),x.push(p),g=T,_=S}const v=s*p,w=cE(x,v);w<0?(c=(v-x[-w-2])/(x[-w-1]-x[-w-2]),h=t+(-w-2)*n):h=t+w*n}l=l>1?l:2,a=a||new Array(l);for(let g=0;g<l;++g)a[g]=h===void 0?NaN:c===void 0?r[h+g]:on(r[h+g],r[h+n+g],c);return a}function pv(r,t,e,n){let s=r[t],a=r[t+1],l=0;for(let h=t+n;h<e;h+=n){const c=r[h],f=r[h+1];l+=Math.sqrt((c-s)*(c-s)+(f-a)*(f-a)),s=c,a=f}return l}class ga{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new ga({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}const Ft={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function Bf(r){return r[0]>0&&r[1]>0}function yv(r,t,e){return e===void 0&&(e=[0,0]),e[0]=r[0]*t+.5|0,e[1]=r[1]*t+.5|0,e}function Ve(r,t){return Array.isArray(r)?r:(t===void 0?t=[r,r]:(t[0]=r,t[1]=r),t)}class _a{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Ve(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new _a({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return wt()}getImage(t){return wt()}getHitDetectionImage(){return wt()}getPixelRatio(t){return 1}getImageState(){return wt()}getImageSize(){return wt()}getOrigin(){return wt()}getSize(){return wt()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ve(t)}listenImageChange(t){wt()}load(){wt()}unlistenImageChange(t){wt()}}const Ss={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]},ge={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"],whitepoint:{2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}}};ge.max=ge.whitepoint[2].D65;ge.rgb=function(r,t){t=t||ge.whitepoint[2].E;var e=r[0]/t[0],n=r[1]/t[1],s=r[2]/t[2],a,l,h;return a=e*3.240969941904521+n*-1.537383177570093+s*-.498610760293,l=e*-.96924363628087+n*1.87596750150772+s*.041555057407175,h=e*.055630079696993+n*-.20397695888897+s*1.056971514242878,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,l=l>.0031308?1.055*Math.pow(l,1/2.4)-.055:l=l*12.92,h=h>.0031308?1.055*Math.pow(h,1/2.4)-.055:h=h*12.92,a=Math.min(Math.max(0,a),1),l=Math.min(Math.max(0,l),1),h=Math.min(Math.max(0,h),1),[a*255,l*255,h*255]};Ss.xyz=function(r,t){var e=r[0]/255,n=r[1]/255,s=r[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92,s=s>.04045?Math.pow((s+.055)/1.055,2.4):s/12.92;var a=e*.41239079926595+n*.35758433938387+s*.18048078840183,l=e*.21263900587151+n*.71516867876775+s*.072192315360733,h=e*.019330818715591+n*.11919477979462+s*.95053215224966;return t=t||ge.whitepoint[2].E,[a*t[0],l*t[1],h*t[2]]};var Ph={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(r,t,e){var n,s,a,l,h,c,f,g,_,p,x,v,w;if(a=r[0],l=r[1],h=r[2],a===0)return[0,0,0];var R=.0011070564598794539;return t=t||"D65",e=e||2,_=ge.whitepoint[e][t][0],p=ge.whitepoint[e][t][1],x=ge.whitepoint[e][t][2],v=4*_/(_+15*p+3*x),w=9*p/(_+15*p+3*x),n=l/(13*a)+v||0,s=h/(13*a)+w||0,f=a>8?p*Math.pow((a+16)/116,3):p*a*R,c=f*9*n/(4*s)||0,g=f*(12-3*n-20*s)/(4*s)||0,[c,f,g]}};ge.luv=function(r,t,e){var n,s,a,l,h,c,f,g,_,p,x,v,w,R=.008856451679035631,T=903.2962962962961;t=t||"D65",e=e||2,_=ge.whitepoint[e][t][0],p=ge.whitepoint[e][t][1],x=ge.whitepoint[e][t][2],v=4*_/(_+15*p+3*x),w=9*p/(_+15*p+3*x),c=r[0],f=r[1],g=r[2],n=4*c/(c+15*f+3*g)||0,s=9*f/(c+15*f+3*g)||0;var S=f/p;return a=S<=R?T*S:116*Math.pow(S,1/3)-16,l=13*a*(n-v),h=13*a*(s-w),[a,l,h]};var Qd={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(r){var t=r[0],e=r[1],n=r[2],s,a,l;return l=n/360*2*Math.PI,s=e*Math.cos(l),a=e*Math.sin(l),[t,s,a]},xyz:function(r){return Ph.xyz(Qd.luv(r))}};Ph.lchuv=function(r){var t=r[0],e=r[1],n=r[2],s=Math.sqrt(e*e+n*n),a=Math.atan2(n,e),l=a*360/2/Math.PI;return l<0&&(l+=360),[t,s,l]};ge.lchuv=function(r){return Ph.lchuv(ge.luv(r))};const Yf={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var Uf={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function xv(r){var g,_;var t,e=[],n=1,s;if(typeof r=="number")return{space:"rgb",values:[r>>>16,(r&65280)>>>8,r&255],alpha:1};if(typeof r=="number")return{space:"rgb",values:[r>>>16,(r&65280)>>>8,r&255],alpha:1};if(r=String(r).toLowerCase(),Yf[r])e=Yf[r].slice(),s="rgb";else if(r==="transparent")n=0,s="rgb",e=[0,0,0];else if(r[0]==="#"){var a=r.slice(1),l=a.length,h=l<=4;n=1,h?(e=[parseInt(a[0]+a[0],16),parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16)],l===4&&(n=parseInt(a[3]+a[3],16)/255)):(e=[parseInt(a[0]+a[1],16),parseInt(a[2]+a[3],16),parseInt(a[4]+a[5],16)],l===8&&(n=parseInt(a[6]+a[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),s="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(r)){var c=t[1];s=c.replace(/a$/,"");var f=s==="cmyk"?4:s==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),s==="color"&&(s=e.shift()),e=e.map(function(p,x){if(p[p.length-1]==="%")return p=parseFloat(p)/100,x===3?p:s==="rgb"?p*255:s[0]==="h"||s[0]==="l"&&!x?p*100:s==="lab"?p*125:s==="lch"?x<2?p*150:p*360:s[0]==="o"&&!x?p:s==="oklab"?p*.4:s==="oklch"?x<2?p*.4:p*360:p;if(s[x]==="h"||x===2&&s[s.length-1]==="h"){if(Uf[p]!==void 0)return Uf[p];if(p.endsWith("deg"))return parseFloat(p);if(p.endsWith("turn"))return parseFloat(p)*360;if(p.endsWith("grad"))return parseFloat(p)*360/400;if(p.endsWith("rad"))return parseFloat(p)*180/Math.PI}return p==="none"?0:parseFloat(p)}),n=e.length>f?e.pop():1}else/[0-9](?:\s|\/|,)/.test(r)&&(e=r.match(/([0-9]+)/g).map(function(p){return parseFloat(p)}),s=((_=(g=r.match(/([a-z])/ig))==null?void 0:g.join(""))==null?void 0:_.toLowerCase())||"rgb");return{space:s,values:e,alpha:n}}var Nl={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(r){var t=r[0]/360,e=r[1]/100,n=r[2]/100,s,a,l,h,c,f=0;if(e===0)return c=n*255,[c,c,c];for(a=n<.5?n*(1+e):n+e-n*e,s=2*n-a,h=[0,0,0];f<3;)l=t+1/3*-(f-1),l<0?l++:l>1&&l--,c=6*l<1?s+(a-s)*6*l:2*l<1?a:3*l<2?s+(a-s)*(2/3-l)*6:s,h[f++]=c*255;return h}};Ss.hsl=function(r){var t=r[0]/255,e=r[1]/255,n=r[2]/255,s=Math.min(t,e,n),a=Math.max(t,e,n),l=a-s,h,c,f;return a===s?h=0:t===a?h=(e-n)/l:e===a?h=2+(n-t)/l:n===a&&(h=4+(t-e)/l),h=Math.min(h*60,360),h<0&&(h+=360),f=(s+a)/2,a===s?c=0:f<=.5?c=l/(a+s):c=l/(2-a-s),[h,c*100,f*100]};function Ev(r){Array.isArray(r)&&r.raw&&(r=String.raw(...arguments)),r instanceof Number&&(r=+r);var t,e=xv(r);if(!e.space)return[];const n=e.space[0]==="h"?Nl.min:Ss.min,s=e.space[0]==="h"?Nl.max:Ss.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],n[0]),s[0]),t[1]=Math.min(Math.max(e.values[1],n[1]),s[1]),t[2]=Math.min(Math.max(e.values[2],n[2]),s[2]),e.space[0]==="h"&&(t=Nl.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}function tg(r){return typeof r=="string"?r:ng(r)}const vv=1024,ds={};let Gl=0;function wv(r){if(r.length===4)return r;const t=r.slice();return t[3]=1,t}function Zf(r){const t=ge.lchuv(Ss.xyz(r));return t[3]=r[3],t}function Cv(r){const t=ge.rgb(Qd.xyz(r));return t[3]=r[3],t}function Dh(r){if(ds.hasOwnProperty(r))return ds[r];if(Gl>=vv){let e=0;for(const n in ds)e++&3||(delete ds[n],--Gl)}const t=Ev(r);if(t.length!==4)throw new Error('Failed to parse "'+r+'" as color');for(const e of t)if(isNaN(e))throw new Error('Failed to parse "'+r+'" as color');return eg(t),ds[r]=t,++Gl,t}function ta(r){return Array.isArray(r)?r:Dh(r)}function eg(r){return r[0]=qt(r[0]+.5|0,0,255),r[1]=qt(r[1]+.5|0,0,255),r[2]=qt(r[2]+.5|0,0,255),r[3]=qt(r[3],0,1),r}function ng(r){let t=r[0];t!=(t|0)&&(t=t+.5|0);let e=r[1];e!=(e|0)&&(e=e+.5|0);let n=r[2];n!=(n|0)&&(n=n+.5|0);const s=r[3]===void 0?1:Math.round(r[3]*100)/100;return"rgba("+t+","+e+","+n+","+s+")"}function Rv(r){try{return Dh(r),!0}catch{return!1}}function Ln(r){return Array.isArray(r)?ng(r):r}function Se(r,t,e,n){let s;return e&&e.length?s=e.shift():yh?s=new OffscreenCanvas(r||300,t||300):s=document.createElement("canvas"),r&&(s.width=r),t&&(s.height=t),s.getContext("2d",n)}function ma(r){const t=r.canvas;t.width=1,t.height=1,r.clearRect(0,0,1,1)}function Kf(r,t){const e=t.parentNode;e&&e.replaceChild(r,t)}function oh(r){return r&&r.parentNode?r.parentNode.removeChild(r):null}function Tv(r){for(;r.lastChild;)r.removeChild(r.lastChild)}function Iv(r,t){const e=r.childNodes;for(let n=0;;++n){const s=e[n],a=t[n];if(!s&&!a)break;if(s!==a){if(!s){r.appendChild(a);continue}if(!a){r.removeChild(s),--n;continue}r.insertBefore(a,s)}}}const Xo="ol-hidden",pa="ol-unselectable",Fh="ol-control",Vf="ol-collapsed",Sv=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),Hf=["style","variant","weight","size","lineHeight","family"],ig=function(r){const t=r.match(Sv);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let n=0,s=Hf.length;n<s;++n){const a=t[n+1];a!==void 0&&(e[Hf[n]]=a)}return e.families=e.family.split(/,\s?/),e},rg="10px sans-serif",Fe="#000",Xr="round",Vn=[],Hn=0,Br="round",As=10,Ls="#000",bs="center",ea="middle",Ji=[0,0,0,0],Ms=1,Kn=new On;let Sr=null,ah;const lh={},Av=function(){const t="32px ",e=["monospace","serif"],n=e.length,s="wmytzilWMYTZIL@#/&?$%10";let a,l;function h(f,g,_){let p=!0;for(let x=0;x<n;++x){const v=e[x];if(l=na(f+" "+g+" "+t+v,s),_!=v){const w=na(f+" "+g+" "+t+_+","+v,s);p=p&&w!=l}}return!!p}function c(){let f=!0;const g=Kn.getKeys();for(let _=0,p=g.length;_<p;++_){const x=g[_];Kn.get(x)<100&&(h.apply(this,x.split(`
`))?(Fs(lh),Sr=null,ah=void 0,Kn.set(x,100)):(Kn.set(x,Kn.get(x)+1,!0),f=!1))}f&&(clearInterval(a),a=void 0)}return function(f){const g=ig(f);if(!g)return;const _=g.families;for(let p=0,x=_.length;p<x;++p){const v=_[p],w=g.style+`
`+g.weight+`
`+v;Kn.get(w)===void 0&&(Kn.set(w,100,!0),h(g.style,g.weight,v)||(Kn.set(w,0,!0),a===void 0&&(a=setInterval(c,32))))}}}(),Lv=function(){let r;return function(t){let e=lh[t];if(e==null){if(yh){const n=ig(t),s=sg(t,"Žg");e=(isNaN(Number(n.lineHeight))?1.2:Number(n.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else r||(r=document.createElement("div"),r.innerHTML="M",r.style.minHeight="0",r.style.maxHeight="none",r.style.height="auto",r.style.padding="0",r.style.border="none",r.style.position="absolute",r.style.display="block",r.style.left="-99999px"),r.style.font=t,document.body.appendChild(r),e=r.offsetHeight,document.body.removeChild(r);lh[t]=e}return e}}();function sg(r,t){return Sr||(Sr=Se(1,1)),r!=ah&&(Sr.font=r,ah=Sr.font),Sr.measureText(t)}function na(r,t){return sg(r,t).width}function qf(r,t,e){if(t in e)return e[t];const n=t.split(`
`).reduce((s,a)=>Math.max(s,na(r,a)),0);return e[t]=n,n}function bv(r,t){const e=[],n=[],s=[];let a=0,l=0,h=0,c=0;for(let f=0,g=t.length;f<=g;f+=2){const _=t[f];if(_===`
`||f===g){a=Math.max(a,l),s.push(l),l=0,h+=c;continue}const p=t[f+1]||r.font,x=na(p,_);e.push(x),l+=x;const v=Lv(p);n.push(v),c=Math.max(c,v)}return{width:a,height:h,widths:e,heights:n,lineWidths:s}}function Mv(r,t,e,n,s,a,l,h,c,f,g){r.save(),e!==1&&(r.globalAlpha*=e),t&&r.transform.apply(r,t),n.contextInstructions?(r.translate(c,f),r.scale(g[0],g[1]),Ov(n,r)):g[0]<0||g[1]<0?(r.translate(c,f),r.scale(g[0],g[1]),r.drawImage(n,s,a,l,h,0,0,l,h)):r.drawImage(n,s,a,l,h,c,f,l*g[0],h*g[1]),r.restore()}function Ov(r,t){const e=r.contextInstructions;for(let n=0,s=e.length;n<s;n+=2)Array.isArray(e[n+1])?t[e[n]].apply(t,e[n+1]):t[e[n]]=e[n+1]}class ya extends _a{constructor(t){const e=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:1,rotateWithView:e,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=t.radius!==void 0?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.render()}clone(){const t=this.getScale(),e=new ya({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),n=this.getScaleArray();return[t[0]/2-e[0]/n[0],t[1]/2+e[1]/n[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const n=this.renderOptions_,s=Se(n.size*t,n.size*t);this.draw_(n,s,t),e=s.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return Ft.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,n){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let s=this.radius_,a=this.radius2_===void 0?s:this.radius2_;if(s<a){const F=s;s=a,a=F}const l=this.radius2_===void 0?this.points_:this.points_*2,h=2*Math.PI/l,c=a*Math.sin(h),f=Math.sqrt(a*a-c*c),g=s-f,_=Math.sqrt(c*c+g*g),p=_/c;if(t==="miter"&&p<=n)return p*e;const x=e/2/p,v=e/2*(g/_),R=Math.sqrt((s+x)*(s+x)+v*v)-s;if(this.radius2_===void 0||t==="bevel")return R*2;const T=s*Math.sin(h),S=Math.sqrt(s*s-T*T),b=a-S,M=Math.sqrt(T*T+b*b)/T;if(M<=n){const F=M*e/2-a-s;return 2*Math.max(R,F)}return R*2}createRenderOptions(){let t=Xr,e=Br,n=0,s=null,a=0,l,h=0;this.stroke_&&(l=Ln(this.stroke_.getColor()??Ls),h=this.stroke_.getWidth()??Ms,s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Br,t=this.stroke_.getLineCap()??Xr,n=this.stroke_.getMiterLimit()??As);const c=this.calculateLineJoinSize_(e,h,n),f=Math.max(this.radius_,this.radius2_||0),g=Math.ceil(2*f+c);return{strokeStyle:l,strokeWidth:h,size:g,lineCap:t,lineDash:s,lineDashOffset:a,lineJoin:e,miterLimit:n}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,n){if(e.scale(n,n),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let s=this.fill_.getColor();s===null&&(s=Fe),e.fillStyle=Ln(s),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let n=this.fill_.getColor(),s=0;typeof n=="string"&&(n=ta(n)),n===null?s=1:Array.isArray(n)&&(s=n.length===4?n[3]:1),s===0&&(e=Se(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const n=this.radius_;if(e===1/0)t.arc(0,0,n,0,2*Math.PI);else{const s=this.radius2_===void 0?n:this.radius2_;this.radius2_!==void 0&&(e*=2);const a=this.angle_-Math.PI/2,l=2*Math.PI/e;for(let h=0;h<e;h++){const c=a+h*l,f=h%2===0?n:s;t.lineTo(f*Math.cos(c),f*Math.sin(c))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Fe,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}}class xa extends ya{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new xa({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius_=t,this.render()}}class qn{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=$f,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new qn({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=$f,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function Pv(r){let t;if(typeof r=="function")t=r;else{let e;Array.isArray(r)?e=r:(vt(typeof r.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[r]),t=function(){return e}}return t}let Wl=null;function Dv(r,t){if(!Wl){const e=new zs({color:"rgba(255,255,255,0.4)"}),n=new ga({color:"#3399CC",width:1.25});Wl=[new qn({image:new xa({fill:e,stroke:n,radius:5}),fill:e,stroke:n})]}return Wl}function $f(r){return r.getGeometry()}const Fv="#333";class kh{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Ve(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new zs({color:Fv}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding}clone(){const t=this.getScale();return new kh({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Ve(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}const Mt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class og extends On{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[Mt.OPACITY]=t.opacity!==void 0?t.opacity:1,vt(typeof e[Mt.OPACITY]=="number","Layer opacity must be a number"),e[Mt.VISIBLE]=t.visible!==void 0?t.visible:!0,e[Mt.Z_INDEX]=t.zIndex,e[Mt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[Mt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[Mt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[Mt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=qt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return wt()}getLayerStatesArray(t){return wt()}getExtent(){return this.get(Mt.EXTENT)}getMaxResolution(){return this.get(Mt.MAX_RESOLUTION)}getMinResolution(){return this.get(Mt.MIN_RESOLUTION)}getMinZoom(){return this.get(Mt.MIN_ZOOM)}getMaxZoom(){return this.get(Mt.MAX_ZOOM)}getOpacity(){return this.get(Mt.OPACITY)}getSourceState(){return wt()}getVisible(){return this.get(Mt.VISIBLE)}getZIndex(){return this.get(Mt.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(Mt.EXTENT,t)}setMaxResolution(t){this.set(Mt.MAX_RESOLUTION,t)}setMinResolution(t){this.set(Mt.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(Mt.MAX_ZOOM,t)}setMinZoom(t){this.set(Mt.MIN_ZOOM,t)}setOpacity(t){vt(typeof t=="number","Layer opacity must be a number"),this.set(Mt.OPACITY,t)}setVisible(t){this.set(Mt.VISIBLE,t)}setZIndex(t){this.set(Mt.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const fe={ANIMATING:0,INTERACTING:1},pn={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},kv=42,Nh=256;function jf(r,t,e){return function(n,s,a,l,h){if(!n)return;if(!s&&!t)return n;const c=t?0:a[0]*s,f=t?0:a[1]*s,g=h?h[0]:0,_=h?h[1]:0;let p=r[0]+c/2+g,x=r[2]-c/2+g,v=r[1]+f/2+_,w=r[3]-f/2+_;p>x&&(p=(x+p)/2,x=p),v>w&&(v=(w+v)/2,w=v);let R=qt(n[0],p,x),T=qt(n[1],v,w);if(l&&e&&s){const S=30*s;R+=-S*Math.log(1+Math.max(0,p-n[0])/S)+S*Math.log(1+Math.max(0,n[0]-x)/S),T+=-S*Math.log(1+Math.max(0,v-n[1])/S)+S*Math.log(1+Math.max(0,n[1]-w)/S)}return[R,T]}}function Nv(r){return r}function Gh(r,t,e,n){const s=kt(t)/e[0],a=He(t)/e[1];return n?Math.min(r,Math.max(s,a)):Math.min(r,Math.min(s,a))}function Wh(r,t,e){let n=Math.min(r,t);const s=50;return n*=Math.log(1+s*Math.max(0,r/t-1))/s+1,e&&(n=Math.max(n,e),n/=Math.log(1+s*Math.max(0,e/r-1))/s+1),qt(n,e/2,t*2)}function Gv(r,t,e,n){return t=t!==void 0?t:!0,function(s,a,l,h){if(s!==void 0){const c=r[0],f=r[r.length-1],g=e?Gh(c,e,l,n):c;if(h)return t?Wh(s,g,f):qt(s,f,g);const _=Math.min(g,s),p=Math.floor(_h(r,_,a));return r[p]>g&&p<r.length-1?r[p+1]:r[p]}}}function Wv(r,t,e,n,s,a){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(l,h,c,f){if(l!==void 0){const g=s?Gh(t,s,c,a):t;if(f)return n?Wh(l,g,e):qt(l,e,g);const _=1e-9,p=Math.ceil(Math.log(t/g)/Math.log(r)-_),x=-h*(.5-_)+.5,v=Math.min(g,l),w=Math.floor(Math.log(t/v)/Math.log(r)+x),R=Math.max(p,w),T=t/Math.pow(r,R);return qt(T,e,g)}}}function Jf(r,t,e,n,s){return e=e!==void 0?e:!0,function(a,l,h,c){if(a!==void 0){const f=n?Gh(r,n,h,s):r;return!e||!c?qt(a,t,f):Wh(a,f,t)}}}function zh(r){if(r!==void 0)return 0}function Qf(r){if(r!==void 0)return r}function zv(r){const t=2*Math.PI/r;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function Xv(r){const t=Ho(5);return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}function ag(r){return Math.pow(r,3)}function Ur(r){return 1-ag(1-r)}function Bv(r){return 3*r*r-2*r*r*r}function Yv(r){return r}const zl=0;class xn extends On{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ih(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Xd(),t.center&&(t.center=Zn(t.center,this.projection_)),t.extent&&(t.extent=$i(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const h in pn)delete e[h];this.setProperties(e,!0);const n=Zv(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const s=Uv(t),a=n.constraint,l=Kv(t);this.constraints_={center:s,resolution:a,rotation:l},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const s=t||[0,0,0,0];e=e||[0,0,0,0];const a=this.getResolution(),l=a/2*(s[3]-e[3]+e[1]-s[1]),h=a/2*(s[0]-e[0]+e[2]-s[2]);this.setCenterInternal([n[0]+l,n[1]-h])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let s=arguments[n];s.center&&(s=Object.assign({},s),s.center=Zn(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=Zn(s.anchor,this.getProjection())),e[n]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let s=0;for(;s<e&&!this.isDef();++s){const g=arguments[s];g.center&&this.setCenterInternal(g.center),g.zoom!==void 0?this.setZoom(g.zoom):g.resolution&&this.setResolution(g.resolution),g.rotation!==void 0&&this.setRotation(g.rotation)}if(s===e){n&&Bo(n,!0);return}let a=Date.now(),l=this.targetCenter_.slice(),h=this.targetResolution_,c=this.targetRotation_;const f=[];for(;s<e;++s){const g=arguments[s],_={start:a,complete:!1,anchor:g.anchor,duration:g.duration!==void 0?g.duration:1e3,easing:g.easing||Bv,callback:n};if(g.center&&(_.sourceCenter=l,_.targetCenter=g.center.slice(),l=_.targetCenter),g.zoom!==void 0?(_.sourceResolution=h,_.targetResolution=this.getResolutionForZoom(g.zoom),h=_.targetResolution):g.resolution&&(_.sourceResolution=h,_.targetResolution=g.resolution,h=_.targetResolution),g.rotation!==void 0){_.sourceRotation=c;const p=tr(g.rotation-c+Math.PI,2*Math.PI)-Math.PI;_.targetRotation=c+p,c=_.targetRotation}Vv(_)?_.complete=!0:a+=_.duration,f.push(_)}this.animations_.push(f),this.setHint(fe.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[fe.ANIMATING]>0}getInteracting(){return this.hints_[fe.INTERACTING]>0}cancelAnimations(){this.setHint(fe.ANIMATING,-this.hints_[fe.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const s=this.animations_[e];if(s[0].callback&&Bo(s[0].callback,!1),!t)for(let a=0,l=s.length;a<l;++a){const h=s[a];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const s=this.animations_[n];let a=!0;for(let l=0,h=s.length;l<h;++l){const c=s[l];if(c.complete)continue;const f=t-c.start;let g=c.duration>0?f/c.duration:1;g>=1?(c.complete=!0,g=1):a=!1;const _=c.easing(g);if(c.sourceCenter){const p=c.sourceCenter[0],x=c.sourceCenter[1],v=c.targetCenter[0],w=c.targetCenter[1];this.nextCenter_=c.targetCenter;const R=p+_*(v-p),T=x+_*(w-x);this.targetCenter_=[R,T]}if(c.sourceResolution&&c.targetResolution){const p=_===1?c.targetResolution:c.sourceResolution+_*(c.targetResolution-c.sourceResolution);if(c.anchor){const x=this.getViewportSize_(this.getRotation()),v=this.constraints_.resolution(p,0,x,!0);this.targetCenter_=this.calculateCenterZoom(v,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=p,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const p=_===1?tr(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+_*(c.targetRotation-c.sourceRotation);if(c.anchor){const x=this.constraints_.rotation(p,!0);this.targetCenter_=this.calculateCenterRotate(x,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=p}if(this.applyTargetState_(!0),e=!0,!c.complete)break}if(a){this.animations_[n]=null,this.setHint(fe.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const l=s[0].callback;l&&Bo(l,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const s=this.getCenterInternal();return s!==void 0&&(n=[s[0]-e[0],s[1]-e[1]],Rh(n,t-this.getRotation()),YE(n,e)),n}calculateCenterZoom(t,e){let n;const s=this.getCenterInternal(),a=this.getResolution();if(s!==void 0&&a!==void 0){const l=e[0]-t*(e[0]-s[0])/a,h=e[1]-t*(e[1]-s[1])/a;n=[l,h]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],s=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&sh(t,this.getProjection())}getCenterInternal(){return this.get(pn.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Yd(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();vt(e,"The view center is not defined");const n=this.getResolution();vt(n!==void 0,"The view resolution is not defined");const s=this.getRotation();return vt(s!==void 0,"The view rotation is not defined"),eh(e,n,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(pn.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal($i(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=kt(t)/e[0],s=He(t)/e[1];return Math.max(n,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(e/n)/Math.log(t);return function(a){return e/Math.pow(t,a*s)}}getRotation(){return this.get(pn.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,a=Math.log(n/s)/e;return function(l){return Math.log(n/l)/e/a}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let s=this.getCenterInternal();const a=this.padding_;if(a){const l=this.getViewportSizeMinusPadding_();s=Xl(s,this.getViewportSize_(),[l[0]/2+a[3],l[1]/2+a[0]],e,n)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,s;if(this.resolutions_){const a=_h(this.resolutions_,t,1);e=a,n=this.resolutions_[a],a==this.resolutions_.length-1?s=2:s=n/this.resolutions_[a+1]}else n=this.maxResolution_,s=this.zoomFactor_;return e+Math.log(n/t)/Math.log(s)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=qt(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,qt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(vt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){vt(!Gs(t),"Cannot fit empty extent provided as `geometry`");const s=$i(t,this.getProjection());n=zf(s)}else if(t.getType()==="Circle"){const s=$i(t.getExtent(),this.getProjection());n=zf(s),n.rotate(this.getRotation(),er(s))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),s=Math.sin(-e),a=t.getFlatCoordinates(),l=t.getStride();let h=1/0,c=1/0,f=-1/0,g=-1/0;for(let _=0,p=a.length;_<p;_+=l){const x=a[_]*n-a[_+1]*s,v=a[_]*s+a[_+1]*n;h=Math.min(h,x),c=Math.min(c,v),f=Math.max(f,x),g=Math.max(g,v)}return[h,c,f,g]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],a=e.nearest!==void 0?e.nearest:!1;let l;e.minResolution!==void 0?l=e.minResolution:e.maxZoom!==void 0?l=this.getResolutionForZoom(e.maxZoom):l=0;const h=this.rotatedExtentForGeometry(t);let c=this.getResolutionForExtentInternal(h,[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);c=isNaN(c)?l:Math.max(c,l),c=this.getConstrainedResolution(c,a?0:1);const f=this.getRotation(),g=Math.sin(f),_=Math.cos(f),p=er(h);p[0]+=(s[1]-s[3])/2*c,p[1]+=(s[0]-s[2])/2*c;const x=p[0]*_-p[1]*g,v=p[1]*_+p[0]*g,w=this.getConstrainedCenter([x,v],c),R=e.callback?e.callback:Wr;e.duration!==void 0?this.animateInternal({resolution:c,center:w,duration:e.duration,easing:e.easing},R):(this.targetResolution_=c,this.targetCenter_=w,this.applyTargetState_(!1,!0),Bo(R,!0))}centerOn(t,e,n){this.centerOnInternal(Zn(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(Xl(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,s){let a;const l=this.padding_;if(l&&t){const h=this.getViewportSizeMinusPadding_(-n),c=Xl(t,s,[h[0]/2+l[3],h[1]/2+l[0]],e,n);a=[t[0]-c[0],t[1]-c[1]]}return a}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=sh(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Zn(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*t,0,s,n);e&&(this.targetCenter_=this.calculateCenterZoom(a,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Zn(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Zn(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,n),a=this.getViewportSize_(s),l=this.constraints_.resolution(this.targetResolution_,0,a,n),h=this.constraints_.center(this.targetCenter_,l,a,n,this.calculateCenterShift(this.targetCenter_,l,s,a));this.get(pn.ROTATION)!==s&&this.set(pn.ROTATION,s),this.get(pn.RESOLUTION)!==l&&(this.set(pn.RESOLUTION,l),this.set("zoom",this.getZoom(),!0)),(!h||!this.get(pn.CENTER)||!Jo(this.get(pn.CENTER),h))&&this.set(pn.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const s=e||0,a=this.constraints_.rotation(this.targetRotation_),l=this.getViewportSize_(a),h=this.constraints_.resolution(this.targetResolution_,s,l),c=this.constraints_.center(this.targetCenter_,h,l,!1,this.calculateCenterShift(this.targetCenter_,h,a,l));if(t===0&&!this.cancelAnchor_){this.targetResolution_=h,this.targetRotation_=a,this.targetCenter_=c,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==h||this.getRotation()!==a||!this.getCenterInternal()||!Jo(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:a,center:c,resolution:h,duration:t,easing:Ur,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(fe.INTERACTING,1)}endInteraction(t,e,n){n=n&&Zn(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(fe.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function Bo(r,t){setTimeout(function(){r(t)},0)}function Uv(r){if(r.extent!==void 0){const e=r.smoothExtentConstraint!==void 0?r.smoothExtentConstraint:!0;return jf(r.extent,r.constrainOnlyCenter,e)}const t=Ih(r.projection,"EPSG:3857");if(r.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,jf(e,!1,!1)}return Nv}function Zv(r){let t,e,n,l=r.minZoom!==void 0?r.minZoom:zl,h=r.maxZoom!==void 0?r.maxZoom:28;const c=r.zoomFactor!==void 0?r.zoomFactor:2,f=r.multiWorld!==void 0?r.multiWorld:!1,g=r.smoothResolutionConstraint!==void 0?r.smoothResolutionConstraint:!0,_=r.showFullExtent!==void 0?r.showFullExtent:!1,p=Ih(r.projection,"EPSG:3857"),x=p.getExtent();let v=r.constrainOnlyCenter,w=r.extent;if(!f&&!w&&p.isGlobal()&&(v=!1,w=x),r.resolutions!==void 0){const R=r.resolutions;e=R[l],n=R[h]!==void 0?R[h]:R[R.length-1],r.constrainResolution?t=Gv(R,g,!v&&w,_):t=Jf(e,n,g,!v&&w,_)}else{const T=(x?Math.max(kt(x),He(x)):360*wh.degrees/p.getMetersPerUnit())/Nh/Math.pow(2,zl),S=T/Math.pow(2,28-zl);e=r.maxResolution,e!==void 0?l=0:e=T/Math.pow(c,l),n=r.minResolution,n===void 0&&(r.maxZoom!==void 0?r.maxResolution!==void 0?n=e/Math.pow(c,h):n=T/Math.pow(c,h):n=S),h=l+Math.floor(Math.log(e/n)/Math.log(c)),n=e/Math.pow(c,h-l),r.constrainResolution?t=Wv(c,e,n,g,!v&&w,_):t=Jf(e,n,g,!v&&w,_)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:l,zoomFactor:c}}function Kv(r){if(r.enableRotation!==void 0?r.enableRotation:!0){const e=r.constrainRotation;return e===void 0||e===!0?Xv():e===!1?Qf:typeof e=="number"?zv(e):Qf}return zh}function Vv(r){return!(r.sourceCenter&&r.targetCenter&&!Jo(r.sourceCenter,r.targetCenter)||r.sourceResolution!==r.targetResolution||r.sourceRotation!==r.targetRotation)}function Xl(r,t,e,n,s){const a=Math.cos(-s);let l=Math.sin(-s),h=r[0]*a-r[1]*l,c=r[1]*a+r[0]*l;h+=(t[0]/2-e[0])*n,c+=(e[1]-t[1]/2)*n,l=-l;const f=h*a-c*l,g=c*a+h*l;return[f,g]}class Ea extends og{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(Mt.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(Mt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(zt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Ct(t,ht.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof xn?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let s;e.layerStatesArray?s=e.layerStatesArray.find(l=>l.layer===this):s=this.getLayerState();const a=this.getExtent();return Xh(s,e.viewState)&&(!a||ke(a,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];let e;const n=this.getSource();if(n&&(e=n.getAttributions()),!e)return[];const s=t instanceof xn?t.getViewStateAndExtent():t;let a=e(s);return Array.isArray(a)||(a=[a]),a}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}setMapInternal(t){t||this.unrender(),this.set(Mt.MAP,t)}getMapInternal(){return this.get(Mt.MAP)}setMap(t){this.mapPrecomposeKey_&&(zt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(zt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Ct(t,bn.PRECOMPOSE,function(e){const s=e.frameState.layerStatesArray,a=this.getLayerState(!1);vt(!s.some(function(l){return l.layer===a.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),s.push(a)},this),this.mapRenderKey_=Ct(this,ht.CHANGE,t.render,t),this.changed())}setSource(t){this.set(Mt.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function Xh(r,t){if(!r.visible)return!1;const e=t.resolution;if(e<r.minResolution||e>=r.maxResolution)return!1;const n=t.zoom;return n>r.minZoom&&n<=r.maxZoom}function Hv(r,t,e,n,s){lg(r,t,e||0,n||r.length-1,s||qv)}function lg(r,t,e,n,s){for(;n>e;){if(n-e>600){var a=n-e+1,l=t-e+1,h=Math.log(a),c=.5*Math.exp(2*h/3),f=.5*Math.sqrt(h*c*(a-c)/a)*(l-a/2<0?-1:1),g=Math.max(e,Math.floor(t-l*c/a+f)),_=Math.min(n,Math.floor(t+(a-l)*c/a+f));lg(r,t,g,_,s)}var p=r[t],x=e,v=n;for(gs(r,e,t),s(r[n],p)>0&&gs(r,e,n);x<v;){for(gs(r,x,v),x++,v--;s(r[x],p)<0;)x++;for(;s(r[v],p)>0;)v--}s(r[e],p)===0?gs(r,e,v):(v++,gs(r,v,n)),v<=t&&(e=v+1),t<=v&&(n=v-1)}}function gs(r,t,e){var n=r[t];r[t]=r[e],r[e]=n}function qv(r,t){return r<t?-1:r>t?1:0}let hg=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const n=[];if(!Uo(t,e))return n;const s=this.toBBox,a=[];for(;e;){for(let l=0;l<e.children.length;l++){const h=e.children[l],c=e.leaf?s(h):h;Uo(t,c)&&(e.leaf?n.push(h):Yl(t,c)?this._all(h,n):a.push(h))}e=a.pop()}return n}collides(t){let e=this.data;if(!Uo(t,e))return!1;const n=[];for(;e;){for(let s=0;s<e.children.length;s++){const a=e.children[s],l=e.leaf?this.toBBox(a):a;if(Uo(t,l)){if(e.leaf||Yl(t,l))return!0;n.push(a)}}e=n.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let n=0;n<t.length;n++)this.insert(t[n]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const n=this.data;this.data=e,e=n}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Ar([]),this}remove(t,e){if(!t)return this;let n=this.data;const s=this.toBBox(t),a=[],l=[];let h,c,f;for(;n||a.length;){if(n||(n=a.pop(),c=a[a.length-1],h=l.pop(),f=!0),n.leaf){const g=$v(t,n.children,e);if(g!==-1)return n.children.splice(g,1),a.push(n),this._condense(a),this}!f&&!n.leaf&&Yl(n,s)?(a.push(n),l.push(h),h=0,c=n,n=n.children[0]):c?(h++,n=c.children[h],f=!1):n=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const n=[];for(;t;)t.leaf?e.push(...t.children):n.push(...t.children),t=n.pop();return e}_build(t,e,n,s){const a=n-e+1;let l=this._maxEntries,h;if(a<=l)return h=Ar(t.slice(e,n+1)),wr(h,this.toBBox),h;s||(s=Math.ceil(Math.log(a)/Math.log(l)),l=Math.ceil(a/Math.pow(l,s-1))),h=Ar([]),h.leaf=!1,h.height=s;const c=Math.ceil(a/l),f=c*Math.ceil(Math.sqrt(l));td(t,e,n,f,this.compareMinX);for(let g=e;g<=n;g+=f){const _=Math.min(g+f-1,n);td(t,g,_,c,this.compareMinY);for(let p=g;p<=_;p+=c){const x=Math.min(p+c-1,_);h.children.push(this._build(t,p,x,s-1))}}return wr(h,this.toBBox),h}_chooseSubtree(t,e,n,s){for(;s.push(e),!(e.leaf||s.length-1===n);){let a=1/0,l=1/0,h;for(let c=0;c<e.children.length;c++){const f=e.children[c],g=Bl(f),_=Qv(t,f)-g;_<l?(l=_,a=g<a?g:a,h=f):_===l&&g<a&&(a=g,h=f)}e=h||e.children[0]}return e}_insert(t,e,n){const s=n?t:this.toBBox(t),a=[],l=this._chooseSubtree(s,this.data,e,a);for(l.children.push(t),ys(l,s);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(s,a,e)}_split(t,e){const n=t[e],s=n.children.length,a=this._minEntries;this._chooseSplitAxis(n,a,s);const l=this._chooseSplitIndex(n,a,s),h=Ar(n.children.splice(l,n.children.length-l));h.height=n.height,h.leaf=n.leaf,wr(n,this.toBBox),wr(h,this.toBBox),e?t[e-1].children.push(h):this._splitRoot(n,h)}_splitRoot(t,e){this.data=Ar([t,e]),this.data.height=t.height+1,this.data.leaf=!1,wr(this.data,this.toBBox)}_chooseSplitIndex(t,e,n){let s,a=1/0,l=1/0;for(let h=e;h<=n-e;h++){const c=ps(t,0,h,this.toBBox),f=ps(t,h,n,this.toBBox),g=tw(c,f),_=Bl(c)+Bl(f);g<a?(a=g,s=h,l=_<l?_:l):g===a&&_<l&&(l=_,s=h)}return s||n-e}_chooseSplitAxis(t,e,n){const s=t.leaf?this.compareMinX:jv,a=t.leaf?this.compareMinY:Jv,l=this._allDistMargin(t,e,n,s),h=this._allDistMargin(t,e,n,a);l<h&&t.children.sort(s)}_allDistMargin(t,e,n,s){t.children.sort(s);const a=this.toBBox,l=ps(t,0,e,a),h=ps(t,n-e,n,a);let c=Yo(l)+Yo(h);for(let f=e;f<n-e;f++){const g=t.children[f];ys(l,t.leaf?a(g):g),c+=Yo(l)}for(let f=n-e-1;f>=e;f--){const g=t.children[f];ys(h,t.leaf?a(g):g),c+=Yo(h)}return c}_adjustParentBBoxes(t,e,n){for(let s=n;s>=0;s--)ys(e[s],t)}_condense(t){for(let e=t.length-1,n;e>=0;e--)t[e].children.length===0?e>0?(n=t[e-1].children,n.splice(n.indexOf(t[e]),1)):this.clear():wr(t[e],this.toBBox)}};function $v(r,t,e){if(!e)return t.indexOf(r);for(let n=0;n<t.length;n++)if(e(r,t[n]))return n;return-1}function wr(r,t){ps(r,0,r.children.length,t,r)}function ps(r,t,e,n,s){s||(s=Ar(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<e;a++){const l=r.children[a];ys(s,r.leaf?n(l):l)}return s}function ys(r,t){return r.minX=Math.min(r.minX,t.minX),r.minY=Math.min(r.minY,t.minY),r.maxX=Math.max(r.maxX,t.maxX),r.maxY=Math.max(r.maxY,t.maxY),r}function jv(r,t){return r.minX-t.minX}function Jv(r,t){return r.minY-t.minY}function Bl(r){return(r.maxX-r.minX)*(r.maxY-r.minY)}function Yo(r){return r.maxX-r.minX+(r.maxY-r.minY)}function Qv(r,t){return(Math.max(t.maxX,r.maxX)-Math.min(t.minX,r.minX))*(Math.max(t.maxY,r.maxY)-Math.min(t.minY,r.minY))}function tw(r,t){const e=Math.max(r.minX,t.minX),n=Math.max(r.minY,t.minY),s=Math.min(r.maxX,t.maxX),a=Math.min(r.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,a-n)}function Yl(r,t){return r.minX<=t.minX&&r.minY<=t.minY&&t.maxX<=r.maxX&&t.maxY<=r.maxY}function Uo(r,t){return t.minX<=r.maxX&&t.minY<=r.maxY&&t.maxX>=r.minX&&t.maxY>=r.minY}function Ar(r){return{children:r,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function td(r,t,e,n,s){const a=[t,e];for(;a.length;){if(e=a.pop(),t=a.pop(),e-t<=n)continue;const l=t+Math.ceil((e-t)/n/2)*n;Hv(r,l,t,e,s),a.push(t,l,l,e)}}function ew(r,t,e){const n=r;let s=!0,a=!1,l=!1;const h=[$o(n,ht.LOAD,function(){l=!0,a||t()})];return n.src&&Ad?(a=!0,n.decode().then(function(){s&&t()}).catch(function(c){s&&(l?t():e())})):h.push($o(n,ht.ERROR,e)),function(){s=!1,h.forEach(zt)}}function nw(r,t){return new Promise((e,n)=>{function s(){l(),e(r)}function a(){l(),n(new Error("Image load error"))}function l(){r.removeEventListener("load",s),r.removeEventListener("error",a)}r.addEventListener("load",s),r.addEventListener("error",a)})}function iw(r,t){return t&&(r.src=t),r.src&&Ad?new Promise((e,n)=>r.decode().then(()=>e(r)).catch(s=>r.complete&&r.width?e(r):n(s))):nw(r)}class rw{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const n=this.cache_[e];!(t++&3)&&!n.hasListener()&&(delete this.cache_[e],--this.cacheSize_)}}}get(t,e,n){const s=ed(t,e,n);return s in this.cache_?this.cache_[s]:null}set(t,e,n,s){const a=ed(t,e,n);this.cache_[a]=s,++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function ed(r,t,e){const n=e?tg(e):"null";return t+":"+r+":"+n}const ia=new rw;let _s=null;class sw extends la{constructor(t,e,n,s,a){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=n,this.canvas_={},this.color_=a,this.imageState_=s===void 0?Ft.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===Ft.LOADED){_s||(_s=Se(1,1,void 0,{willReadFrequently:!0})),_s.drawImage(this.image_,0,0);try{_s.getImageData(0,0,1,1),this.tainted_=!1}catch{_s=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(ht.CHANGE)}handleImageError_(){this.imageState_=Ft.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=Ft.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],n=Se(t,e);n.fillRect(0,0,t,e),this.hitDetectionImage_=n.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===Ft.IDLE){this.image_||this.initializeImage_(),this.imageState_=Ft.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&iw(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==Ft.LOADED)return;const e=this.image_,n=document.createElement("canvas");n.width=Math.ceil(e.width*t),n.height=Math.ceil(e.height*t);const s=n.getContext("2d");s.scale(t,t),s.drawImage(e,0,0),s.globalCompositeOperation="multiply",s.fillStyle=tg(this.color_),s.fillRect(0,0,n.width/t,n.height/t),s.globalCompositeOperation="destination-in",s.drawImage(e,0,0),this.canvas_[t]=n}}function ow(r,t,e,n,s){let a=t===void 0?void 0:ia.get(t,e,s);return a||(a=new sw(r,r instanceof HTMLImageElement?r.src||void 0:t,e,n,s),ia.set(t,e,s,a)),a}function nd(r,t,e,n){return e!==void 0&&n!==void 0?[e/r,n/t]:e!==void 0?e/r:n!==void 0?n/t:1}class Yr extends _a{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,n=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,a=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:n,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const l=t.img!==void 0?t.img:null;let h=t.src;vt(!(h!==void 0&&l),"`image` and `src` cannot be provided at the same time"),(h===void 0||h.length===0)&&l&&(h=l.src||It(l)),vt(h!==void 0&&h.length>0,"A defined and non-empty `src` or `image` must be provided"),vt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(t.src!==void 0?c=Ft.IDLE:l!==void 0&&(l instanceof HTMLImageElement?l.complete?c=l.src?Ft.LOADED:Ft.IDLE:c=Ft.LOADING:c=Ft.LOADED),this.color_=t.color!==void 0?ta(t.color):null,this.iconImage_=ow(l,h,this.crossOrigin_,c,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,t.width!==void 0||t.height!==void 0){let f,g;if(t.size)[f,g]=t.size;else{const _=this.getImage(1);if(_.width&&_.height)f=_.width,g=_.height;else if(_ instanceof HTMLImageElement){this.initialOptions_=t;const p=()=>{if(this.unlistenImageChange(p),!this.initialOptions_)return;const x=this.iconImage_.getSize();this.setScale(nd(x[0],x[1],t.width,t.height))};this.listenImageChange(p);return}}f!==void 0&&this.setScale(nd(f,g,t.width,t.height))}}clone(){let t,e,n;return this.initialOptions_?(e=this.initialOptions_.width,n=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new Yr({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:n,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),n=this.getScaleArray();return[t[0]-e[0]/n[0],t[1]+e[1]/n[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=n[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==Ft.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==Ft.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(ht.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(ht.CHANGE,t)}}let Zr=0;const Kr=0,Kt=1<<Zr++,q=1<<Zr++,En=1<<Zr++,de=1<<Zr++,Li=1<<Zr++,Pe=Math.pow(2,Zr)-1,ug={[Kt]:"boolean",[q]:"number",[En]:"string",[de]:"color",[Li]:"number[]"},aw=Object.keys(ug).map(Number).sort(Si);function _e(r){const t=[];for(const e of aw)lw(r,e)&&t.push(ug[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function lw(r,t){return(r&t)===t}function Mn(r,t){return!!(r&t)}function va(r,t){return r===t}class Ri{constructor(t,e){this.type=t,this.value=e}}class hw{constructor(t,e,...n){this.type=t,this.operator=e,this.args=n}}function cg(){return{variables:new Set,properties:new Set,featureId:!1,style:{}}}function uw(r){switch(r){case"string":return En;case"color":return de;case"number":return q;case"boolean":return Kt;case"number[]":return Li;default:throw new Error(`Unrecognized type hint: ${r}`)}}function Lt(r,t,e){switch(typeof r){case"boolean":return new Ri(Kt,r);case"number":return new Ri(q,r);case"string":{let s=En;return Rv(r)&&(s|=de),va(s&e,Kr)||(s&=e),new Ri(s,r)}}if(!Array.isArray(r))throw new Error("Expression must be an array or a primitive value");if(r.length===0)throw new Error("Empty expression");if(typeof r[0]=="string")return vw(r,t,e);for(const s of r)if(typeof s!="number")throw new Error("Expected an array of numbers");let n=Li;return(r.length===3||r.length===4)&&(n|=de),e&&(n&=e),new Ri(n,r)}const G={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette"},cw={[G.Get]:ot(([r,t])=>t!==void 0?uw(t.value):Pe,ft(1,2),fw),[G.Var]:ot(([r])=>r.type,ft(1,1),dw),[G.Id]:ot(q|En,ms,gw),[G.Concat]:ot(En,ft(2,1/0),Tt(Pe)),[G.GeometryType]:ot(En,ms),[G.Resolution]:ot(q,ms),[G.Zoom]:ot(q,ms),[G.Time]:ot(q,ms),[G.Any]:ot(Kt,ft(2,1/0),Tt(Kt)),[G.All]:ot(Kt,ft(2,1/0),Tt(Kt)),[G.Not]:ot(Kt,ft(1,1),Tt(Kt)),[G.Equal]:ot(Kt,ft(2,2),Tt(Pe),Vi),[G.NotEqual]:ot(Kt,ft(2,2),Tt(Pe),Vi),[G.GreaterThan]:ot(Kt,ft(2,2),Tt(Pe),Vi),[G.GreaterThanOrEqualTo]:ot(Kt,ft(2,2),Tt(Pe),Vi),[G.LessThan]:ot(Kt,ft(2,2),Tt(Pe),Vi),[G.LessThanOrEqualTo]:ot(Kt,ft(2,2),Tt(Pe),Vi),[G.Multiply]:ot(r=>{let t=q|de;for(let e=0;e<r.length;e++)t&=r[e].type;return t},ft(2,1/0),Tt(q|de),Vi),[G.Divide]:ot(q,ft(2,2),Tt(q)),[G.Add]:ot(q,ft(2,1/0),Tt(q)),[G.Subtract]:ot(q,ft(2,2),Tt(q)),[G.Clamp]:ot(q,ft(3,3),Tt(q)),[G.Mod]:ot(q,ft(2,2),Tt(q)),[G.Pow]:ot(q,ft(2,2),Tt(q)),[G.Abs]:ot(q,ft(1,1),Tt(q)),[G.Floor]:ot(q,ft(1,1),Tt(q)),[G.Ceil]:ot(q,ft(1,1),Tt(q)),[G.Round]:ot(q,ft(1,1),Tt(q)),[G.Sin]:ot(q,ft(1,1),Tt(q)),[G.Cos]:ot(q,ft(1,1),Tt(q)),[G.Atan]:ot(q,ft(1,2),Tt(q)),[G.Sqrt]:ot(q,ft(1,1),Tt(q)),[G.Match]:ot(r=>{let t=Pe;for(let e=2;e<r.length;e+=2)t&=r[e].type;return t&=r[r.length-1].type,t},ft(4,1/0),id,mw),[G.Between]:ot(Kt,ft(3,3),Tt(q)),[G.Interpolate]:ot(r=>{let t=de|q;for(let e=3;e<r.length;e+=2)t&=r[e].type;return t},ft(6,1/0),id,pw),[G.Case]:ot(r=>{let t=Pe;for(let e=1;e<r.length;e+=2)t&=r[e].type;return t&=r[r.length-1].type,t},ft(3,1/0),_w,yw),[G.In]:ot(Kt,ft(2,2),xw),[G.Number]:ot(q,ft(1,1/0),Tt(Pe)),[G.String]:ot(En,ft(1,1/0),Tt(Pe)),[G.Array]:ot(r=>r.length===3||r.length===4?Li|de:Li,ft(1,1/0),Tt(q)),[G.Color]:ot(de,ft(3,4),Tt(q)),[G.Band]:ot(q,ft(1,3),Tt(q)),[G.Palette]:ot(de,ft(2,2),Ew)};function fw(r,t){const e=Lt(r[1],t);if(!(e instanceof Ri))throw new Error("Expected a literal argument for get operation");if(typeof e.value!="string")throw new Error("Expected a string argument for get operation");if(t.properties.add(e.value),r.length===3){const n=Lt(r[2],t);return[e,n]}return[e]}function dw(r,t,e,n){const s=r[1];if(typeof s!="string")throw new Error("Expected a string argument for var operation");if(t.variables.add(s),!("variables"in t.style)||t.style.variables[s]===void 0)return[new Ri(Pe,s)];const a=t.style.variables[s],l=Lt(a,t);if(l.value=s,n&&!Mn(n,l.type))throw new Error(`The variable ${s} has type ${_e(l.type)} but the following type was expected: ${_e(n)}`);return[l]}function gw(r,t){t.featureId=!0}function ms(r,t){const e=r[0];if(r.length!==1)throw new Error(`Expected no arguments for ${e} operation`);return[]}function ft(r,t){return function(e,n){const s=e[0],a=e.length-1;if(r===t){if(a!==r){const l=r===1?"":"s";throw new Error(`Expected ${r} argument${l} for ${s}, got ${a}`)}}else if(a<r||a>t){const l=t===1/0?`${r} or more`:`${r} to ${t}`;throw new Error(`Expected ${l} arguments for ${s}, got ${a}`)}}}function Tt(r){return function(t,e){const n=t[0],s=t.length-1,a=new Array(s);for(let l=0;l<s;++l){const h=Lt(t[l+1],e);if(!Mn(r,h.type)){const c=_e(r),f=_e(h.type);throw new Error(`Unexpected type for argument ${l} of ${n} operation, got ${c} but expected ${f}`)}h.type&=r,a[l]=h}return a}}function Vi(r,t,e){const n=r[0],s=r.length-1;let a=Pe;for(let h=0;h<e.length;++h)a&=e[h].type;if(a===Kr)throw new Error(`No common type could be found for arguments of ${n} operation`);const l=new Array(s);for(let h=0;h<s;++h)l[h]=Lt(r[h+1],t,a);return l}function _w(r,t){const e=r[0],n=r.length-1;if(n%2===0)throw new Error(`An odd amount of arguments was expected for operation ${e}, got ${JSON.stringify(n)} instead`)}function id(r,t){const e=r[0],n=r.length-1;if(n%2===1)throw new Error(`An even amount of arguments was expected for operation ${e}, got ${JSON.stringify(n)} instead`)}function mw(r,t,e,n){const s=r.length-1;let l=Lt(r[1],t).type;const h=Lt(r[r.length-1],t);let c=n!==void 0?n&h.type:h.type;const f=new Array(s-2);for(let _=0;_<s-2;_+=2){const p=Lt(r[_+2],t),x=Lt(r[_+3],t);l&=p.type,c&=x.type,f[_]=p,f[_+1]=x}const g=En|q|Kt;if(!Mn(g,l))throw new Error(`Expected an input of type ${_e(g)} for the interpolate operation, got ${_e(l)} instead`);if(va(c,Kr))throw new Error("Could not find a common output type for the following match operation: "+JSON.stringify(r));for(let _=0;_<s-2;_+=2){const p=Lt(r[_+2],t,l),x=Lt(r[_+3],t,c);f[_]=p,f[_+1]=x}return[Lt(r[1],t,l),...f,Lt(r[r.length-1],t,c)]}function pw(r,t,e,n){const s=r[1];let a;switch(s[0]){case"linear":a=1;break;case"exponential":if(a=s[1],typeof a!="number")throw new Error(`Expected a number base for exponential interpolation, got ${JSON.stringify(a)} instead`);break;default:a=null}if(!a)throw new Error(`Invalid interpolation type: ${JSON.stringify(s)}`);a=Lt(a,t);let l=Lt(r[2],t);if(!Mn(q,l.type))throw new Error(`Expected an input of type number for the interpolate operation, got ${_e(l.type)} instead`);l=Lt(r[2],t,q);const h=new Array(r.length-3);for(let c=0;c<h.length;c+=2){let f=Lt(r[c+3],t);if(!Mn(q,f.type))throw new Error(`Expected all stop input values in the interpolate operation to be of type number, got ${_e(f.type)} at position ${c+2} instead`);let g=Lt(r[c+4],t);if(!Mn(q|de,g.type))throw new Error(`Expected all stop output values in the interpolate operation to be a number or color, got ${_e(g.type)} at position ${c+3} instead`);f=Lt(r[c+3],t,q),g=Lt(r[c+4],t,q|de),h[c]=f,h[c+1]=g}return[a,l,...h]}function yw(r,t,e,n){const s=Lt(r[r.length-1],t);let a=n!==void 0?n&s.type:s.type;const l=new Array(r.length-1);for(let h=0;h<l.length-1;h+=2){const c=Lt(r[h+1],t),f=Lt(r[h+2],t);if(!Mn(Kt,c.type))throw new Error(`Expected all conditions in the case operation to be of type boolean, got ${_e(c.type)} at position ${h} instead`);a&=f.type,l[h]=c,l[h+1]=f}if(va(a,Kr))throw new Error("Could not find a common output type for the following case operation: "+JSON.stringify(r));for(let h=0;h<l.length-1;h+=2)l[h+1]=Lt(r[h+2],t,a);return l[l.length-1]=Lt(r[r.length-1],t,a),l}function xw(r,t){let e=r[2];if(!Array.isArray(e))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');if(typeof e[0]=="string"){if(e[0]!=="literal")throw new Error('For the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions.');if(!Array.isArray(e[1]))throw new Error('The "in" operator was provided a literal value which was not an array as second argument.');e=e[1]}let n=En|q;const s=new Array(e.length);for(let l=0;l<s.length;l++){const h=Lt(e[l],t);n&=h.type,s[l]=h}if(va(n,Kr))throw new Error("Could not find a common type for the following in operation: "+JSON.stringify(r));return[Lt(r[1],t,n),...s]}function Ew(r,t){const e=Lt(r[1],t,q);if(e.type!==q)throw new Error(`The first argument of palette must be an number, got ${_e(e.type)} instead`);const n=r[2];if(!Array.isArray(n))throw new Error("The second argument of palette must be an array");const s=new Array(n.length);for(let a=0;a<s.length;a++){const l=Lt(n[a],t,de);if(!(l instanceof Ri))throw new Error(`The palette color at index ${a} must be a literal value`);if(!Mn(l.type,de))throw new Error(`The palette color at index ${a} should be of type color, got ${_e(l.type)} instead`);s[a]=l}return[e,...s]}function ot(r,...t){return function(e,n,s){const a=e[0];let l=[];for(let c=0;c<t.length;c++)l=t[c](e,n,l,s)||l;let h=typeof r=="function"?r(l):r;if(s!==void 0){if(!Mn(h,s))throw new Error(`The following expression was expected to return ${_e(s)}, but returns ${_e(h)} instead: ${JSON.stringify(e)}`);h&=s}if(h===Kr)throw new Error(`No matching type was found for the following expression: ${JSON.stringify(e)}`);return new hw(h,a,...l)}}function vw(r,t,e){const n=r[0],s=cw[n];if(!s)throw new Error(`Unknown operator: ${n}`);return s(r,t,e)}function fg(){return{variables:{},properties:{},resolution:NaN,featureId:null}}function Mi(r,t,e){const n=Lt(r,e);if(!Mn(t,n.type)){const s=_e(t),a=_e(n.type);throw new Error(`Expected expression to be of type ${s}, got ${a}`)}return Jn(n)}function Jn(r,t){if(r instanceof Ri){if(r.type===de&&typeof r.value=="string"){const n=Dh(r.value);return function(){return n}}return function(){return r.value}}const e=r.operator;switch(e){case G.Number:case G.String:return ww(r);case G.Get:case G.Var:return Cw(r);case G.Id:return n=>n.featureId;case G.Concat:{const n=r.args.map(s=>Jn(s));return s=>"".concat(...n.map(a=>a(s).toString()))}case G.Resolution:return n=>n.resolution;case G.Any:case G.All:case G.Not:return Tw(r);case G.Equal:case G.NotEqual:case G.LessThan:case G.LessThanOrEqualTo:case G.GreaterThan:case G.GreaterThanOrEqualTo:return Rw(r);case G.Multiply:case G.Divide:case G.Add:case G.Subtract:case G.Clamp:case G.Mod:case G.Pow:case G.Abs:case G.Floor:case G.Ceil:case G.Round:case G.Sin:case G.Cos:case G.Atan:case G.Sqrt:return Iw(r);case G.Match:return Sw(r);case G.Interpolate:return Aw(r);default:throw new Error(`Unsupported operator ${e}`)}}function ww(r,t){const e=r.operator,n=r.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Jn(r.args[a]);switch(e){case G.Number:case G.String:return a=>{for(let l=0;l<n;++l){const h=s[l](a);if(typeof h===e)return h}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Cw(r,t){const n=r.args[0].value;switch(r.operator){case G.Get:return s=>s.properties[n];case G.Var:return s=>s.variables[n];default:throw new Error(`Unsupported accessor operator ${r.operator}`)}}function Rw(r,t){const e=r.operator,n=Jn(r.args[0]),s=Jn(r.args[1]);switch(e){case G.Equal:return a=>n(a)===s(a);case G.NotEqual:return a=>n(a)!==s(a);case G.LessThan:return a=>n(a)<s(a);case G.LessThanOrEqualTo:return a=>n(a)<=s(a);case G.GreaterThan:return a=>n(a)>s(a);case G.GreaterThanOrEqualTo:return a=>n(a)>=s(a);default:throw new Error(`Unsupported comparison operator ${e}`)}}function Tw(r,t){const e=r.operator,n=r.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Jn(r.args[a]);switch(e){case G.Any:return a=>{for(let l=0;l<n;++l)if(s[l](a))return!0;return!1};case G.All:return a=>{for(let l=0;l<n;++l)if(!s[l](a))return!1;return!0};case G.Not:return a=>!s[0](a);default:throw new Error(`Unsupported logical operator ${e}`)}}function Iw(r,t){const e=r.operator,n=r.args.length,s=new Array(n);for(let a=0;a<n;++a)s[a]=Jn(r.args[a]);switch(e){case G.Multiply:return a=>{let l=1;for(let h=0;h<n;++h)l*=s[h](a);return l};case G.Divide:return a=>s[0](a)/s[1](a);case G.Add:return a=>{let l=0;for(let h=0;h<n;++h)l+=s[h](a);return l};case G.Subtract:return a=>s[0](a)-s[1](a);case G.Clamp:return a=>{const l=s[0](a),h=s[1](a);if(l<h)return h;const c=s[2](a);return l>c?c:l};case G.Mod:return a=>s[0](a)%s[1](a);case G.Pow:return a=>Math.pow(s[0](a),s[1](a));case G.Abs:return a=>Math.abs(s[0](a));case G.Floor:return a=>Math.floor(s[0](a));case G.Ceil:return a=>Math.ceil(s[0](a));case G.Round:return a=>Math.round(s[0](a));case G.Sin:return a=>Math.sin(s[0](a));case G.Cos:return a=>Math.cos(s[0](a));case G.Atan:return n===2?a=>Math.atan2(s[0](a),s[1](a)):a=>Math.atan(s[0](a));case G.Sqrt:return a=>Math.sqrt(s[0](a));default:throw new Error(`Unsupported numeric operator ${e}`)}}function Sw(r,t){const e=r.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Jn(r.args[s]);return s=>{const a=n[0](s);for(let l=1;l<e;l+=2)if(a===n[l](s))return n[l+1](s);return n[e-1](s)}}function Aw(r,t){const e=r.args.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=Jn(r.args[s]);return s=>{const a=n[0](s),l=n[1](s);let h,c;for(let f=2;f<e;f+=2){const g=n[f](s);let _=n[f+1](s);const p=Array.isArray(_);if(p&&(_=wv(_)),g>=l)return f===2?_:p?Lw(a,l,h,c,g,_):xs(a,l,h,c,g,_);h=g,c=_}return c}}function xs(r,t,e,n,s,a){const l=s-e;if(l===0)return n;const h=t-e,c=r===1?h/l:(Math.pow(r,h)-1)/(Math.pow(r,l)-1);return n+c*(a-n)}function Lw(r,t,e,n,s,a){if(s-e===0)return n;const h=Zf(n),c=Zf(a);let f=c[2]-h[2];f>180?f-=360:f<-180&&(f+=360);const g=[xs(r,t,e,h[0],s,c[0]),xs(r,t,e,h[1],s,c[1]),h[2]+xs(r,t,e,0,s,f),xs(r,t,e,n[3],s,a[3])];return eg(Cv(g))}function bw(r){return!0}function Mw(r){const t=cg(),e=Ow(r,t),n=fg();return function(s,a){if(n.properties=s.getPropertiesInternal(),n.resolution=a,t.featureId){const l=s.getId();l!==void 0?n.featureId=l:n.featureId=null}return e(n)}}function rd(r){const t=cg(),e=r.length,n=new Array(e);for(let l=0;l<e;++l)n[l]=hh(r[l],t);const s=fg(),a=new Array(e);return function(l,h){if(s.properties=l.getPropertiesInternal(),s.resolution=h,t.featureId){const f=l.getId();f!==void 0?s.featureId=f:s.featureId=null}let c=0;for(let f=0;f<e;++f){const g=n[f](s);g&&(a[c]=g,c+=1)}return a.length=c,a}}function Ow(r,t){const e=r.length,n=new Array(e);for(let s=0;s<e;++s){const a=r[s],l="filter"in a?Mi(a.filter,Kt,t):bw;let h;if(Array.isArray(a.style)){const c=a.style.length;h=new Array(c);for(let f=0;f<c;++f)h[f]=hh(a.style[f],t)}else h=[hh(a.style,t)];n[s]={filter:l,styles:h}}return function(s){const a=[];let l=!1;for(let h=0;h<e;++h){const c=n[h].filter;if(c(s)&&!(r[h].else&&l)){l=!0;for(const f of n[h].styles){const g=f(s);g&&a.push(g)}}}return a}}function hh(r,t){const e=Os(r,"",t),n=Ps(r,"",t),s=Pw(r,t),a=Dw(r,t),l=Ne(r,"z-index",t);if(!e&&!n&&!s&&!a&&!zr(r))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(r));const h=new qn;return function(c){let f=!0;if(e){const g=e(c);g&&(f=!1),h.setFill(g)}if(n){const g=n(c);g&&(f=!1),h.setStroke(g)}if(s){const g=s(c);g&&(f=!1),h.setText(g)}if(a){const g=a(c);g&&(f=!1),h.setImage(g)}return l&&h.setZIndex(l(c)),f?null:h}}function Os(r,t,e){const n=dg(r,t+"fill-color",e);if(!n)return null;const s=new zs;return function(a){const l=n(a);return l==="none"?null:(s.setColor(l),s)}}function Ps(r,t,e){const n=Ne(r,t+"stroke-width",e),s=dg(r,t+"stroke-color",e);if(!n&&!s)return null;const a=wi(r,t+"stroke-line-cap",e),l=wi(r,t+"stroke-line-join",e),h=gg(r,t+"stroke-line-dash",e),c=Ne(r,t+"stroke-line-dash-offset",e),f=Ne(r,t+"stroke-miter-limit",e),g=new ga;return function(_){if(s){const p=s(_);if(p==="none")return null;g.setColor(p)}if(n&&g.setWidth(n(_)),a){const p=a(_);if(p!=="butt"&&p!=="round"&&p!=="square")throw new Error("Expected butt, round, or square line cap");g.setLineCap(p)}if(l){const p=l(_);if(p!=="bevel"&&p!=="round"&&p!=="miter")throw new Error("Expected bevel, round, or miter line join");g.setLineJoin(p)}return h&&g.setLineDash(h(_)),c&&g.setLineDashOffset(c(_)),f&&g.setMiterLimit(f(_)),g}}function Pw(r,t){const e="text-",n=wi(r,e+"value",t);if(!n)return null;const s=Os(r,e,t),a=Os(r,e+"background-",t),l=Ps(r,e,t),h=Ps(r,e+"background-",t),c=wi(r,e+"font",t),f=Ne(r,e+"max-angle",t),g=Ne(r,e+"offset-x",t),_=Ne(r,e+"offset-y",t),p=Ds(r,e+"overflow",t),x=wi(r,e+"placement",t),v=Ne(r,e+"repeat",t),w=wa(r,e+"scale",t),R=Ds(r,e+"rotate-with-view",t),T=Ne(r,e+"rotation",t),S=wi(r,e+"align",t),b=wi(r,e+"justify",t),O=wi(r,e+"baseline",t),M=gg(r,e+"padding",t),F=new kh({});return function(z){if(F.setText(n(z)),s&&F.setFill(s(z)),a&&F.setBackgroundFill(a(z)),l&&F.setStroke(l(z)),h&&F.setBackgroundStroke(h(z)),c&&F.setFont(c(z)),f&&F.setMaxAngle(f(z)),g&&F.setOffsetX(g(z)),_&&F.setOffsetY(_(z)),p&&F.setOverflow(p(z)),x){const B=x(z);if(B!=="point"&&B!=="line")throw new Error("Expected point or line for text-placement");F.setPlacement(B)}if(v&&F.setRepeat(v(z)),w&&F.setScale(w(z)),R&&F.setRotateWithView(R(z)),T&&F.setRotation(T(z)),S){const B=S(z);if(B!=="left"&&B!=="center"&&B!=="right"&&B!=="end"&&B!=="start")throw new Error("Expected left, right, center, start, or end for text-align");F.setTextAlign(B)}if(b){const B=b(z);if(B!=="left"&&B!=="right"&&B!=="center")throw new Error("Expected left, right, or center for text-justify");F.setJustify(B)}if(O){const B=O(z);if(B!=="bottom"&&B!=="top"&&B!=="middle"&&B!=="alphabetic"&&B!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");F.setTextBaseline(B)}return M&&F.setPadding(M(z)),F}}function Dw(r,t){return"icon-src"in r?Fw(r,t):"shape-points"in r?kw(r,t):"circle-radius"in r?Nw(r,t):null}function Fw(r,t){const e="icon-",n=e+"src",s=_g(r[n],n),a=ra(r,e+"anchor",t),l=wa(r,e+"scale",t),h=Ne(r,e+"opacity",t),c=ra(r,e+"displacement",t),f=Ne(r,e+"rotation",t),g=Ds(r,e+"rotate-with-view",t),_=sd(r,e+"anchor-origin"),p=od(r,e+"anchor-x-units"),x=od(r,e+"anchor-y-units"),v=Xw(r,e+"color"),w=Ww(r,e+"cross-origin"),R=zw(r,e+"offset"),T=sd(r,e+"offset-origin"),S=Dr(r,e+"width"),b=Dr(r,e+"height"),O=Gw(r,e+"size"),M=Bh(r,e+"declutter"),F=new Yr({src:s,anchorOrigin:_,anchorXUnits:p,anchorYUnits:x,color:v,crossOrigin:w,offset:R,offsetOrigin:T,height:b,width:S,size:O,declutterMode:M});return function(z){return h&&F.setOpacity(h(z)),c&&F.setDisplacement(c(z)),f&&F.setRotation(f(z)),g&&F.setRotateWithView(g(z)),l&&F.setScale(l(z)),a&&F.setAnchor(a(z)),F}}function kw(r,t){const e="shape-",n=e+"points",s=mg(r[n],n),a=Os(r,e,t),l=Ps(r,e,t),h=wa(r,e+"scale",t),c=ra(r,e+"displacement",t),f=Ne(r,e+"rotation",t),g=Ds(r,e+"rotate-with-view",t),_=Dr(r,e+"radius"),p=Dr(r,e+"radius1"),x=Dr(r,e+"radius2"),v=Dr(r,e+"angle"),w=Bh(r,e+"declutter-mode"),R=new ya({points:s,radius:_,radius1:p,radius2:x,angle:v,declutterMode:w});return function(T){return a&&R.setFill(a(T)),l&&R.setStroke(l(T)),c&&R.setDisplacement(c(T)),f&&R.setRotation(f(T)),g&&R.setRotateWithView(g(T)),h&&R.setScale(h(T)),R}}function Nw(r,t){const e="circle-",n=Os(r,e,t),s=Ps(r,e,t),a=Ne(r,e+"radius",t),l=wa(r,e+"scale",t),h=ra(r,e+"displacement",t),c=Ne(r,e+"rotation",t),f=Ds(r,e+"rotate-with-view",t),g=Bh(r,e+"declutter-mode"),_=new xa({radius:5,declutterMode:g});return function(p){return a&&_.setRadius(a(p)),n&&_.setFill(n(p)),s&&_.setStroke(s(p)),h&&_.setDisplacement(h(p)),c&&_.setRotation(c(p)),f&&_.setRotateWithView(f(p)),l&&_.setScale(l(p)),_}}function Ne(r,t,e){if(!(t in r))return;const n=Mi(r[t],q,e);return function(s){return mg(n(s),t)}}function wi(r,t,e){if(!(t in r))return null;const n=Mi(r[t],En,e);return function(s){return _g(n(s),t)}}function Ds(r,t,e){if(!(t in r))return null;const n=Mi(r[t],Kt,e);return function(s){const a=n(s);if(typeof a!="boolean")throw new Error(`Expected a boolean for ${t}`);return a}}function dg(r,t,e){if(!(t in r))return null;const n=Mi(r[t],de|En,e);return function(s){return pg(n(s),t)}}function gg(r,t,e){if(!(t in r))return null;const n=Mi(r[t],Li,e);return function(s){return Xs(n(s),t)}}function ra(r,t,e){if(!(t in r))return null;const n=Mi(r[t],Li,e);return function(s){const a=Xs(n(s),t);if(a.length!==2)throw new Error(`Expected two numbers for ${t}`);return a}}function wa(r,t,e){if(!(t in r))return null;const n=Mi(r[t],Li|q,e);return function(s){return Bw(n(s),t)}}function Dr(r,t){const e=r[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function Gw(r,t){const e=r[t];if(e!==void 0){if(typeof e=="number")return Ve(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function Ww(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function sd(r,t){const e=r[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function od(r,t){const e=r[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function zw(r,t){const e=r[t];if(e!==void 0)return Xs(e,t)}function Bh(r,t){const e=r[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function Xw(r,t){const e=r[t];if(e!==void 0)return pg(e,t)}function Xs(r,t){if(!Array.isArray(r))throw new Error(`Expected an array for ${t}`);const e=r.length;for(let n=0;n<e;++n)if(typeof r[n]!="number")throw new Error(`Expected an array of numbers for ${t}`);return r}function _g(r,t){if(typeof r!="string")throw new Error(`Expected a string for ${t}`);return r}function mg(r,t){if(typeof r!="number")throw new Error(`Expected a number for ${t}`);return r}function pg(r,t){if(typeof r=="string")return r;const e=Xs(r,t),n=e.length;if(n<3||n>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function Bw(r,t){if(typeof r=="number")return r;const e=Xs(r,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}const ad={RENDER_ORDER:"renderOrder"};class Yw extends Ea{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter!==void 0?t.declutter:!1,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(ad.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t){t.declutterTree||(t.declutterTree=new hg(9)),this.getRenderer().renderDeclutter(t)}setRenderOrder(t){this.set(ad.RENDER_ORDER,t)}setStyle(t){this.style_=Uw(t),this.styleFunction_=t===null?void 0:Pv(this.style_),this.changed()}}function Uw(r){if(r===void 0)return Dv;if(!r)return null;if(typeof r=="function"||r instanceof qn)return r;if(!Array.isArray(r))return rd([r]);if(r.length===0)return[];const t=r.length,e=r[0];if(e instanceof qn){const s=new Array(t);for(let a=0;a<t;++a){const l=r[a];if(!(l instanceof qn))throw new Error("Expected a list of style instances");s[a]=l}return s}if("style"in e){const s=new Array(t);for(let a=0;a<t;++a){const l=r[a];if(!("style"in l))throw new Error("Expected a list of rules with a style property");s[a]=l}return Mw(s)}return rd(r)}const $={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Zo=[$.FILL],Ti=[$.STROKE],Qi=[$.BEGIN_PATH],ld=[$.CLOSE_PATH];class yg{drawCustom(t,e,n,s){}drawGeometry(t){}setStyle(t){}drawCircle(t,e){}drawFeature(t,e){}drawGeometryCollection(t,e){}drawLineString(t,e){}drawMultiLineString(t,e){}drawMultiPoint(t,e){}drawMultiPolygon(t,e){}drawPoint(t,e){}drawPolygon(t,e){}drawText(t,e){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class Bs extends yg{constructor(t,e,n,s){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=s,this.maxLineWidth=0,this.resolution=n,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(n){return n*e})}appendFlatPointCoordinates(t,e){const n=this.getBufferedMaxExtent(),s=this.tmpCoordinate_,a=this.coordinates;let l=a.length;for(let h=0,c=t.length;h<c;h+=e)s[0]=t[h],s[1]=t[h+1],ha(n,s)&&(a[l++]=s[0],a[l++]=s[1]);return l}appendFlatLineCoordinates(t,e,n,s,a,l){const h=this.coordinates;let c=h.length;const f=this.getBufferedMaxExtent();l&&(e+=s);let g=t[e],_=t[e+1];const p=this.tmpCoordinate_;let x=!0,v,w,R;for(v=e+s;v<n;v+=s)p[0]=t[v],p[1]=t[v+1],R=Ql(f,p),R!==w?(x&&(h[c++]=g,h[c++]=_,x=!1),h[c++]=p[0],h[c++]=p[1]):R===ee.INTERSECTING?(h[c++]=p[0],h[c++]=p[1],x=!1):x=!0,g=p[0],_=p[1],w=R;return(a&&x||v===e+s)&&(h[c++]=g,h[c++]=_),c}drawCustomCoordinates_(t,e,n,s,a){for(let l=0,h=n.length;l<h;++l){const c=n[l],f=this.appendFlatLineCoordinates(t,e,c,s,!1,!1);a.push(f),e=c}return e}drawCustom(t,e,n,s){this.beginGeometry(t,e);const a=t.getType(),l=t.getStride(),h=this.coordinates.length;let c,f,g,_,p;switch(a){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),_=[];const x=t.getEndss();p=0;for(let v=0,w=x.length;v<w;++v){const R=[];p=this.drawCustomCoordinates_(c,p,x[v],l,R),_.push(R)}this.instructions.push([$.CUSTOM,h,_,t,n,Gf]),this.hitDetectionInstructions.push([$.CUSTOM,h,_,t,s||n,Gf]);break;case"Polygon":case"MultiLineString":g=[],c=a=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),p=this.drawCustomCoordinates_(c,0,t.getEnds(),l,g),this.instructions.push([$.CUSTOM,h,g,t,n,Qo]),this.hitDetectionInstructions.push([$.CUSTOM,h,g,t,s||n,Qo]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),f=this.appendFlatLineCoordinates(c,0,c.length,l,!1,!1),this.instructions.push([$.CUSTOM,h,f,t,n,Pr]),this.hitDetectionInstructions.push([$.CUSTOM,h,f,t,s||n,Pr]);break;case"MultiPoint":c=t.getFlatCoordinates(),f=this.appendFlatPointCoordinates(c,l),f>h&&(this.instructions.push([$.CUSTOM,h,f,t,n,Pr]),this.hitDetectionInstructions.push([$.CUSTOM,h,f,t,s||n,Pr]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),f=this.coordinates.length,this.instructions.push([$.CUSTOM,h,f,t,n]),this.hitDetectionInstructions.push([$.CUSTOM,h,f,t,s||n]);break}this.endGeometry(e)}beginGeometry(t,e){this.beginGeometryInstruction1_=[$.BEGIN_GEOMETRY,e,0,t],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[$.BEGIN_GEOMETRY,e,0,t],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const n=t.length;let s,a,l=-1;for(e=0;e<n;++e)s=t[e],a=s[0],a==$.END_GEOMETRY?l=e:a==$.BEGIN_GEOMETRY&&(s[2]=e,fE(this.hitDetectionInstructions,l,e),l=-1)}setFillStrokeStyle(t,e){const n=this.state;if(t){const s=t.getColor();n.fillStyle=Ln(s||Fe)}else n.fillStyle=void 0;if(e){const s=e.getColor();n.strokeStyle=Ln(s||Ls);const a=e.getLineCap();n.lineCap=a!==void 0?a:Xr;const l=e.getLineDash();n.lineDash=l?l.slice():Vn;const h=e.getLineDashOffset();n.lineDashOffset=h||Hn;const c=e.getLineJoin();n.lineJoin=c!==void 0?c:Br;const f=e.getWidth();n.lineWidth=f!==void 0?f:Ms;const g=e.getMiterLimit();n.miterLimit=g!==void 0?g:As,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0}createFill(t){const e=t.fillStyle,n=[$.SET_FILL_STYLE,e];return typeof e!="string"&&n.push(!0),n}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[$.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const n=t.fillStyle;(typeof n!="string"||t.currentFillStyle!=n)&&(n!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=n)}updateStrokeStyle(t,e){const n=t.strokeStyle,s=t.lineCap,a=t.lineDash,l=t.lineDashOffset,h=t.lineJoin,c=t.lineWidth,f=t.miterLimit;(t.currentStrokeStyle!=n||t.currentLineCap!=s||a!=t.currentLineDash&&!bi(t.currentLineDash,a)||t.currentLineDashOffset!=l||t.currentLineJoin!=h||t.currentLineWidth!=c||t.currentMiterLimit!=f)&&(n!==void 0&&e.call(this,t),t.currentStrokeStyle=n,t.currentLineCap=s,t.currentLineDash=a,t.currentLineDashOffset=l,t.currentLineJoin=h,t.currentLineWidth=c,t.currentMiterLimit=f)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[$.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Md(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Eh(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class Zw extends Bs{constructor(t,e,n,s){super(t,e,n,s),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const n=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length,l=this.appendFlatPointCoordinates(n,s);this.instructions.push([$.DRAW_IMAGE,a,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([$.DRAW_IMAGE,a,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e){if(!this.image_)return;this.beginGeometry(t,e);const n=t.getFlatCoordinates(),s=t.getStride(),a=this.coordinates.length,l=this.appendFlatPointCoordinates(n,s);this.instructions.push([$.DRAW_IMAGE,a,l,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([$.DRAW_IMAGE,a,l,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const n=t.getAnchor(),s=t.getSize(),a=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=n[0],this.anchorY_=n[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=s[1],this.opacity_=t.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=s[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class Kw extends Bs{constructor(t,e,n,s){super(t,e,n,s)}drawFlatCoordinates_(t,e,n,s){const a=this.coordinates.length,l=this.appendFlatLineCoordinates(t,e,n,s,!1,!1),h=[$.MOVE_TO_LINE_TO,a,l];return this.instructions.push(h),this.hitDetectionInstructions.push(h),n}drawLineString(t,e){const n=this.state,s=n.strokeStyle,a=n.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Vn,Hn],Qi);const l=t.getFlatCoordinates(),h=t.getStride();this.drawFlatCoordinates_(l,0,l.length,h),this.hitDetectionInstructions.push(Ti),this.endGeometry(e)}drawMultiLineString(t,e){const n=this.state,s=n.strokeStyle,a=n.lineWidth;if(s===void 0||a===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e),this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Vn,Hn],Qi);const l=t.getEnds(),h=t.getFlatCoordinates(),c=t.getStride();let f=0;for(let g=0,_=l.length;g<_;++g)f=this.drawFlatCoordinates_(h,f,l[g],c);this.hitDetectionInstructions.push(Ti),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Ti),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Ti),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Qi)}}class hd extends Bs{constructor(t,e,n,s){super(t,e,n,s)}drawFlatCoordinatess_(t,e,n,s){const a=this.state,l=a.fillStyle!==void 0,h=a.strokeStyle!==void 0,c=n.length;this.instructions.push(Qi),this.hitDetectionInstructions.push(Qi);for(let f=0;f<c;++f){const g=n[f],_=this.coordinates.length,p=this.appendFlatLineCoordinates(t,e,g,s,!0,!h),x=[$.MOVE_TO_LINE_TO,_,p];this.instructions.push(x),this.hitDetectionInstructions.push(x),h&&(this.instructions.push(ld),this.hitDetectionInstructions.push(ld)),e=g}return l&&(this.instructions.push(Zo),this.hitDetectionInstructions.push(Zo)),h&&(this.instructions.push(Ti),this.hitDetectionInstructions.push(Ti)),e}drawCircle(t,e){const n=this.state,s=n.fillStyle,a=n.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_FILL_STYLE,Fe]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Vn,Hn]);const l=t.getFlatCoordinates(),h=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(l,0,l.length,h,!1,!1);const f=[$.CIRCLE,c];this.instructions.push(Qi,f),this.hitDetectionInstructions.push(Qi,f),n.fillStyle!==void 0&&(this.instructions.push(Zo),this.hitDetectionInstructions.push(Zo)),n.strokeStyle!==void 0&&(this.instructions.push(Ti),this.hitDetectionInstructions.push(Ti)),this.endGeometry(e)}drawPolygon(t,e){const n=this.state,s=n.fillStyle,a=n.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_FILL_STYLE,Fe]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Vn,Hn]);const l=t.getEnds(),h=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(h,0,l,c),this.endGeometry(e)}drawMultiPolygon(t,e){const n=this.state,s=n.fillStyle,a=n.strokeStyle;if(s===void 0&&a===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_FILL_STYLE,Fe]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([$.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Vn,Hn]);const l=t.getEndss(),h=t.getOrientedFlatCoordinates(),c=t.getStride();let f=0;for(let g=0,_=l.length;g<_;++g)f=this.drawFlatCoordinatess_(h,f,l[g],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let n=0,s=e.length;n<s;++n)e[n]=qi(e[n],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function Vw(r,t,e,n,s){const a=[];let l=e,h=0,c=t.slice(e,2);for(;h<r&&l+s<n;){const[f,g]=c.slice(-2),_=t[l+s],p=t[l+s+1],x=Math.sqrt((_-f)*(_-f)+(p-g)*(p-g));if(h+=x,h>=r){const v=(r-h+x)/x,w=on(f,_,v),R=on(g,p,v);c.push(w,R),a.push(c),c=[w,R],h==r&&(l+=s),h=0}else if(h<r)c.push(t[l+s],t[l+s+1]),l+=s;else{const v=x-h,w=on(f,_,v/x),R=on(g,p,v/x);c.push(w,R),a.push(c),c=[w,R],h=0,l+=s}}return h>0&&a.push(c),a}function Hw(r,t,e,n,s){let a=e,l=e,h=0,c=0,f=e,g,_,p,x,v,w,R,T,S,b;for(_=e;_<n;_+=s){const O=t[_],M=t[_+1];v!==void 0&&(S=O-v,b=M-w,x=Math.sqrt(S*S+b*b),R!==void 0&&(c+=p,g=Math.acos((R*S+T*b)/(p*x)),g>r&&(c>h&&(h=c,a=f,l=_),c=0,f=_-s)),p=x,R=S,T=b),v=O,w=M}return c+=x,c>h?[f,_]:[a,l]}const sa={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class qw extends Bs{constructor(t,e,n,s){super(t,e,n,s),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[Fe]={fillStyle:Fe},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e){const n=this.textFillState_,s=this.textStrokeState_,a=this.textState_;if(this.text_===""||!a||!n&&!s)return;const l=this.coordinates;let h=l.length;const c=t.getType();let f=null,g=t.getStride();if(a.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!ke(this.getBufferedMaxExtent(),t.getExtent()))return;let _;if(f=t.getFlatCoordinates(),c=="LineString")_=[f.length];else if(c=="MultiLineString")_=t.getEnds();else if(c=="Polygon")_=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const w=t.getEndss();_=[];for(let R=0,T=w.length;R<T;++R)_.push(w[R][0])}this.beginGeometry(t,e);const p=a.repeat,x=p?void 0:a.textAlign;let v=0;for(let w=0,R=_.length;w<R;++w){let T;p?T=Vw(p*this.resolution,f,v,_[w],g):T=[f.slice(v,_[w])];for(let S=0,b=T.length;S<b;++S){const O=T[S];let M=0,F=O.length;if(x==null){const B=Hw(a.maxAngle,O,0,O.length,2);M=B[0],F=B[1]}for(let B=M;B<F;B+=g)l.push(O[B],O[B+1]);const z=l.length;v=_[w],this.drawChars_(h,z),h=z}}this.endGeometry(e)}else{let _=a.overflow?null:[];switch(c){case"Point":case"MultiPoint":f=t.getFlatCoordinates();break;case"LineString":f=t.getFlatMidpoint();break;case"Circle":f=t.getCenter();break;case"MultiLineString":f=t.getFlatMidpoints(),g=2;break;case"Polygon":f=t.getFlatInteriorPoint(),a.overflow||_.push(f[2]/this.resolution),g=3;break;case"MultiPolygon":const T=t.getFlatInteriorPoints();f=[];for(let S=0,b=T.length;S<b;S+=3)a.overflow||_.push(T[S+2]/this.resolution),f.push(T[S],T[S+1]);if(f.length===0)return;g=2;break}const p=this.appendFlatPointCoordinates(f,g);if(p===h)return;if(_&&(p-h)/2!==f.length/g){let T=h/2;_=_.filter((S,b)=>{const O=l[(T+b)*2]===f[b*g]&&l[(T+b)*2+1]===f[b*g+1];return O||--T,O})}this.saveTextStates_(),(a.backgroundFill||a.backgroundStroke)&&(this.setFillStrokeStyle(a.backgroundFill,a.backgroundStroke),a.backgroundFill&&this.updateFillStyle(this.state,this.createFill),a.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e);let x=a.padding;if(x!=Ji&&(a.scale[0]<0||a.scale[1]<0)){let T=a.padding[0],S=a.padding[1],b=a.padding[2],O=a.padding[3];a.scale[0]<0&&(S=-S,O=-O),a.scale[1]<0&&(T=-T,b=-b),x=[T,S,b,O]}const v=this.pixelRatio;this.instructions.push([$.DRAW_IMAGE,h,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,x==Ji?Ji:x.map(function(T){return T*v}),!!a.backgroundFill,!!a.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]);const w=1/v,R=this.state.fillStyle;a.backgroundFill&&(this.state.fillStyle=Fe,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([$.DRAW_IMAGE,h,p,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[w,w],NaN,void 0,this.declutterImageWithText_,x,!!a.backgroundFill,!!a.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?Fe:this.fillKey_,this.textOffsetX_,this.textOffsetY_,_]),a.backgroundFill&&(this.state.fillStyle=R,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,n=this.textFillState_,s=this.strokeKey_;t&&(s in this.strokeStates||(this.strokeStates[s]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const a=this.textKey_;a in this.textStates||(this.textStates[a]={font:e.font,textAlign:e.textAlign||bs,justify:e.justify,textBaseline:e.textBaseline||ea,scale:e.scale});const l=this.fillKey_;n&&(l in this.fillStates||(this.fillStates[l]={fillStyle:n.fillStyle}))}drawChars_(t,e){const n=this.textStrokeState_,s=this.textState_,a=this.strokeKey_,l=this.textKey_,h=this.fillKey_;this.saveTextStates_();const c=this.pixelRatio,f=sa[s.textBaseline],g=this.textOffsetY_*c,_=this.text_,p=n?n.lineWidth*Math.abs(s.scale[0])/2:0;this.instructions.push([$.DRAW_CHARS,t,e,f,s.overflow,h,s.maxAngle,c,g,a,p*c,_,l,1]),this.hitDetectionInstructions.push([$.DRAW_CHARS,t,e,f,s.overflow,h&&Fe,s.maxAngle,c,g,a,p*c,_,l,1/c])}setTextStyle(t,e){let n,s,a;if(!t)this.text_="";else{const l=t.getFill();l?(s=this.textFillState_,s||(s={},this.textFillState_=s),s.fillStyle=Ln(l.getColor()||Fe)):(s=null,this.textFillState_=s);const h=t.getStroke();if(!h)a=null,this.textStrokeState_=a;else{a=this.textStrokeState_,a||(a={},this.textStrokeState_=a);const v=h.getLineDash(),w=h.getLineDashOffset(),R=h.getWidth(),T=h.getMiterLimit();a.lineCap=h.getLineCap()||Xr,a.lineDash=v?v.slice():Vn,a.lineDashOffset=w===void 0?Hn:w,a.lineJoin=h.getLineJoin()||Br,a.lineWidth=R===void 0?Ms:R,a.miterLimit=T===void 0?As:T,a.strokeStyle=Ln(h.getColor()||Ls)}n=this.textState_;const c=t.getFont()||rg;Av(c);const f=t.getScaleArray();n.overflow=t.getOverflow(),n.font=c,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.repeat=t.getRepeat(),n.justify=t.getJustify(),n.textBaseline=t.getTextBaseline()||ea,n.backgroundFill=t.getBackgroundFill(),n.backgroundStroke=t.getBackgroundStroke(),n.padding=t.getPadding()||Ji,n.scale=f===void 0?[1,1]:f;const g=t.getOffsetX(),_=t.getOffsetY(),p=t.getRotateWithView(),x=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=g===void 0?0:g,this.textOffsetY_=_===void 0?0:_,this.textRotateWithView_=p===void 0?!1:p,this.textRotation_=x===void 0?0:x,this.strokeKey_=a?(typeof a.strokeStyle=="string"?a.strokeStyle:It(a.strokeStyle))+a.lineCap+a.lineDashOffset+"|"+a.lineWidth+a.lineJoin+a.miterLimit+"["+a.lineDash.join()+"]":"",this.textKey_=n.font+n.scale+(n.textAlign||"?")+(n.repeat||"?")+(n.justify||"?")+(n.textBaseline||"?"),this.fillKey_=s?typeof s.fillStyle=="string"?s.fillStyle:"|"+It(s.fillStyle):""}this.declutterImageWithText_=e}}const $w={Circle:hd,Default:Bs,Image:Zw,LineString:Kw,Polygon:hd,Text:qw};class ud{constructor(t,e,n,s){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=s,this.resolution_=n,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const n=this.buildersByZIndex_[e];for(const s in n){const a=n[s].finish();t[e][s]=a}}return t}getBuilder(t,e){const n=t!==void 0?t.toString():"0";let s=this.buildersByZIndex_[n];s===void 0&&(s={},this.buildersByZIndex_[n]=s);let a=s[e];if(a===void 0){const l=$w[e];a=new l(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),s[e]=a}return a}}class jw extends ks{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.declutterExecutorGroup=null}getFeatures(t){return wt()}getData(t){return null}prepareFrame(t){return wt()}renderFrame(t,e){return wt()}loadedTileCallback(t,e,n){t[e]||(t[e]={}),t[e][n.tileCoord.toString()]=n}createLoadedTileFinder(t,e,n){return(s,a)=>{const l=this.loadedTileCallback.bind(this,n,s);return t.forEachLoadedTile(e,s,a,l)}}forEachFeatureAtCoordinate(t,e,n,s,a){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===Ft.LOADED||e.getState()===Ft.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=Ft.LOADED&&e!=Ft.ERROR&&t.addEventListener(ht.CHANGE,this.boundHandleImageChange_),e==Ft.IDLE&&(t.load(),e=t.getState()),e==Ft.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}class xg extends Qn{constructor(t,e,n,s){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=s}}const cd=[];let Lr=null;function Jw(){Lr=Se(1,1,void 0,{willReadFrequently:!0})}class Eg extends jw{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=vn(),this.pixelTransform=vn(),this.inversePixelTransform=vn(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(t,e,n){Lr||Jw(),Lr.clearRect(0,0,1,1);let s;try{Lr.drawImage(t,e,n,1,1,0,0,1,1),s=Lr.getImageData(0,0,1,1).data}catch{return Lr=null,null}return s}getBackground(t){let n=this.getLayer().getBackground();return typeof n=="function"&&(n=n(t.viewState.resolution)),n||void 0}useContainer(t,e,n){const s=this.getLayer().getClassName();let a,l;if(t&&t.className===s&&(!n||t&&t.style.backgroundColor&&bi(ta(t.style.backgroundColor),ta(n)))){const h=t.firstElementChild;h instanceof HTMLCanvasElement&&(l=h.getContext("2d"))}if(l&&l.canvas.style.transform===e?(this.container=t,this.context=l,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){a=document.createElement("div"),a.className=s;let h=a.style;h.position="absolute",h.width="100%",h.height="100%",l=Se();const c=l.canvas;a.appendChild(c),h=c.style,h.position="absolute",h.left="0",h.transformOrigin="top left",this.container=a,this.context=l}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const s=nr(n),a=fa(n),l=ca(n),h=ua(n);ne(e.coordinateToPixelTransform,s),ne(e.coordinateToPixelTransform,a),ne(e.coordinateToPixelTransform,l),ne(e.coordinateToPixelTransform,h);const c=this.inversePixelTransform;ne(c,s),ne(c,a),ne(c,l),ne(c,h),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(l[0]),Math.round(l[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.clip()}dispatchRenderEvent_(t,e,n){const s=this.getLayer();if(s.hasListener(t)){const a=new xg(t,this.inversePixelTransform,n,e);s.dispatchEvent(a)}}preRender(t,e){this.frameState=e,this.dispatchRenderEvent_(bn.PRERENDER,t,e)}postRender(t,e){this.dispatchRenderEvent_(bn.POSTRENDER,t,e)}getRenderTransform(t,e,n,s,a,l,h){const c=a/2,f=l/2,g=s/e,_=-g,p=-t[0]+h,x=-t[1];return $n(this.tempTransform,c,f,g,_,-n,p,x)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function Qw(r,t,e,n,s,a,l,h,c,f,g,_){let p=r[t],x=r[t+1],v=0,w=0,R=0,T=0;function S(){v=p,w=x,t+=n,p=r[t],x=r[t+1],T+=R,R=Math.sqrt((p-v)*(p-v)+(x-w)*(x-w))}do S();while(t<e-n&&T+R<a);let b=R===0?0:(a-T)/R;const O=on(v,p,b),M=on(w,x,b),F=t-n,z=T,B=a+h*c(f,s,g);for(;t<e-n&&T+R<B;)S();b=R===0?0:(B-T)/R;const H=on(v,p,b),it=on(w,x,b);let gt;if(_){const J=[O,M,H,it];Ud(J,0,4,2,_,J,J),gt=J[0]>J[2]}else gt=O>H;const _t=Math.PI,ut=[],Gt=F+n===t;t=F,R=0,T=z,p=r[t],x=r[t+1];let V;if(Gt){S(),V=Math.atan2(x-w,p-v),gt&&(V+=V>0?-_t:_t);const J=(H+O)/2,U=(it+M)/2;return ut[0]=[J,U,(B-a)/2,V,s],ut}s=s.replace(/\n/g," ");for(let J=0,U=s.length;J<U;){S();let nt=Math.atan2(x-w,p-v);if(gt&&(nt+=nt>0?-_t:_t),V!==void 0){let mt=nt-V;if(mt+=mt>_t?-2*_t:mt<-_t?2*_t:0,Math.abs(mt)>l)return null}V=nt;const St=J;let xt=0;for(;J<U;++J){const mt=gt?U-J-1:J,Et=h*c(f,s[mt],g);if(t+n<e&&T+R<a+xt+Et/2)break;xt+=Et}if(J===St)continue;const Ot=gt?s.substring(U-St,U-J):s.substring(St,J);b=R===0?0:(a+xt/2-T)/R;const X=on(v,p,b),$t=on(w,x,b);ut.push([X,$t,xt/2,nt,Ot]),a+=xt}return ut}const Cr=an(),mi=[],Yn=[],Un=[],pi=[];function fd(r){return r[3].declutterBox}const dd=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function Ul(r,t){return t==="start"?t=dd.test(r)?"right":"left":t==="end"&&(t=dd.test(r)?"left":"right"),sa[t]}function tC(r,t,e){return e>0&&r.push(`
`,""),r.push(t,""),r}class eC{constructor(t,e,n,s){this.overlaps=n,this.pixelRatio=e,this.resolution=t,this.alignFill_,this.instructions=s.instructions,this.coordinates=s.coordinates,this.coordinateCache_={},this.renderedTransform_=vn(),this.hitDetectionInstructions=s.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=s.fillStates||{},this.strokeStates=s.strokeStates||{},this.textStates=s.textStates||{},this.widths_={},this.labels_={}}createLabel(t,e,n,s){const a=t+e+n+s;if(this.labels_[a])return this.labels_[a];const l=s?this.strokeStates[s]:null,h=n?this.fillStates[n]:null,c=this.textStates[e],f=this.pixelRatio,g=[c.scale[0]*f,c.scale[1]*f],_=Array.isArray(t),p=c.justify?sa[c.justify]:Ul(Array.isArray(t)?t[0]:t,c.textAlign||bs),x=s&&l.lineWidth?l.lineWidth:0,v=_?t:t.split(`
`).reduce(tC,[]),{width:w,height:R,widths:T,heights:S,lineWidths:b}=bv(c,v),O=w+x,M=[],F=(O+2)*g[0],z=(R+x)*g[1],B={width:F<0?Math.floor(F):Math.ceil(F),height:z<0?Math.floor(z):Math.ceil(z),contextInstructions:M};(g[0]!=1||g[1]!=1)&&M.push("scale",g),s&&(M.push("strokeStyle",l.strokeStyle),M.push("lineWidth",x),M.push("lineCap",l.lineCap),M.push("lineJoin",l.lineJoin),M.push("miterLimit",l.miterLimit),M.push("setLineDash",[l.lineDash]),M.push("lineDashOffset",l.lineDashOffset)),n&&M.push("fillStyle",h.fillStyle),M.push("textBaseline","middle"),M.push("textAlign","center");const H=.5-p;let it=p*O+H*x;const gt=[],_t=[];let ut=0,Gt=0,V=0,J=0,U;for(let nt=0,St=v.length;nt<St;nt+=2){const xt=v[nt];if(xt===`
`){Gt+=ut,ut=0,it=p*O+H*x,++J;continue}const Ot=v[nt+1]||c.font;Ot!==U&&(s&&gt.push("font",Ot),n&&_t.push("font",Ot),U=Ot),ut=Math.max(ut,S[V]);const X=[xt,it+H*T[V]+p*(T[V]-b[J]),.5*(x+ut)+Gt];it+=T[V],s&&gt.push("strokeText",X),n&&_t.push("fillText",X),++V}return Array.prototype.push.apply(M,gt),Array.prototype.push.apply(M,_t),this.labels_[a]=B,B}replayTextBackground_(t,e,n,s,a,l,h){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,n),t.lineTo.apply(t,s),t.lineTo.apply(t,a),t.lineTo.apply(t,e),l&&(this.alignFill_=l[2],this.fill_(t)),h&&(this.setStrokeStyle_(t,h),t.stroke())}calculateImageOrLabelDimensions_(t,e,n,s,a,l,h,c,f,g,_,p,x,v,w,R){h*=p[0],c*=p[1];let T=n-h,S=s-c;const b=a+f>t?t-f:a,O=l+g>e?e-g:l,M=v[3]+b*p[0]+v[1],F=v[0]+O*p[1]+v[2],z=T-v[3],B=S-v[0];(w||_!==0)&&(mi[0]=z,pi[0]=z,mi[1]=B,Yn[1]=B,Yn[0]=z+M,Un[0]=Yn[0],Un[1]=B+F,pi[1]=Un[1]);let H;return _!==0?(H=$n(vn(),n,s,1,1,_,-n,-s),ne(H,mi),ne(H,Yn),ne(H,Un),ne(H,pi),jn(Math.min(mi[0],Yn[0],Un[0],pi[0]),Math.min(mi[1],Yn[1],Un[1],pi[1]),Math.max(mi[0],Yn[0],Un[0],pi[0]),Math.max(mi[1],Yn[1],Un[1],pi[1]),Cr)):jn(Math.min(z,z+M),Math.min(B,B+F),Math.max(z,z+M),Math.max(B,B+F),Cr),x&&(T=Math.round(T),S=Math.round(S)),{drawImageX:T,drawImageY:S,drawImageW:b,drawImageH:O,originX:f,originY:g,declutterBox:{minX:Cr[0],minY:Cr[1],maxX:Cr[2],maxY:Cr[3],value:R},canvasTransform:H,scale:p}}replayImageOrLabel_(t,e,n,s,a,l,h){const c=!!(l||h),f=s.declutterBox,g=t.canvas,_=h?h[2]*s.scale[0]/2:0;return f.minX-_<=g.width/e&&f.maxX+_>=0&&f.minY-_<=g.height/e&&f.maxY+_>=0&&(c&&this.replayTextBackground_(t,mi,Yn,Un,pi,l,h),Mv(t,s.canvasTransform,a,n,s.originX,s.originY,s.drawImageW,s.drawImageH,s.drawImageX,s.drawImageY,s.scale)),!0}fill_(t){if(this.alignFill_){const e=ne(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(e[0]%n,e[1]%n),t.rotate(this.viewRotation_)}t.fill(),this.alignFill_&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,n,s){const a=this.textStates[e],l=this.createLabel(t,e,s,n),h=this.strokeStates[n],c=this.pixelRatio,f=Ul(Array.isArray(t)?t[0]:t,a.textAlign||bs),g=sa[a.textBaseline||ea],_=h&&h.lineWidth?h.lineWidth:0,p=l.width/c-2*a.scale[0],x=f*p+2*(.5-f)*_,v=g*l.height/c+2*(.5-g)*_;return{label:l,anchorX:x,anchorY:v}}execute_(t,e,n,s,a,l,h,c){let f;this.pixelCoordinates_&&bi(n,this.renderedTransform_)?f=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),f=Ii(this.coordinates,0,this.coordinates.length,2,n,this.pixelCoordinates_),vE(this.renderedTransform_,n));let g=0;const _=s.length;let p=0,x,v,w,R,T,S,b,O,M,F,z,B,H=0,it=0,gt=null,_t=null;const ut=this.coordinateCache_,Gt=this.viewRotation_,V=Math.round(Math.atan2(-n[1],n[0])*1e12)/1e12,J={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Gt},U=this.instructions!=s||this.overlaps?0:200;let nt,St,xt,Ot;for(;g<_;){const X=s[g];switch(X[0]){case $.BEGIN_GEOMETRY:nt=X[1],Ot=X[3],nt.getGeometry()?h!==void 0&&!ke(h,Ot.getExtent())?g=X[2]+1:++g:g=X[2];break;case $.BEGIN_PATH:H>U&&(this.fill_(t),H=0),it>U&&(t.stroke(),it=0),!H&&!it&&(t.beginPath(),R=NaN,T=NaN),++g;break;case $.CIRCLE:p=X[1];const mt=f[p],Et=f[p+1],Ge=f[p+2],ie=f[p+3],me=Ge-mt,pe=ie-Et,ti=Math.sqrt(me*me+pe*pe);t.moveTo(mt+ti,Et),t.arc(mt,Et,ti,0,2*Math.PI,!0),++g;break;case $.CLOSE_PATH:t.closePath(),++g;break;case $.CUSTOM:p=X[1],x=X[2];const Pn=X[3],hn=X[4],Oi=X.length==6?X[5]:void 0;J.geometry=Pn,J.feature=nt,g in ut||(ut[g]=[]);const Vt=ut[g];Oi?Oi(f,p,x,2,Vt):(Vt[0]=f[p],Vt[1]=f[p+1],Vt.length=2),hn(Vt,J),++g;break;case $.DRAW_IMAGE:p=X[1],x=X[2],O=X[3],v=X[4],w=X[5];let un=X[6];const wn=X[7],Ae=X[8],Pi=X[9],ir=X[10];let qe=X[11];const ye=X[12];let Ht=X[13];const re=X[14],We=X[15];if(!O&&X.length>=20){M=X[19],F=X[20],z=X[21],B=X[22];const ve=this.drawLabelWithPointPlacement_(M,F,z,B);O=ve.label,X[3]=O;const si=X[23];v=(ve.anchorX-si)*this.pixelRatio,X[4]=v;const we=X[24];w=(ve.anchorY-we)*this.pixelRatio,X[5]=w,un=O.height,X[6]=un,Ht=O.width,X[13]=Ht}let xe;X.length>25&&(xe=X[25]);let ei,ze,Ee;X.length>17?(ei=X[16],ze=X[17],Ee=X[18]):(ei=Ji,ze=!1,Ee=!1),ir&&V?qe+=Gt:!ir&&!V&&(qe-=Gt);let Cn=0;for(;p<x;p+=2){if(xe&&xe[Cn++]<Ht/this.pixelRatio)continue;const ve=this.calculateImageOrLabelDimensions_(O.width,O.height,f[p],f[p+1],Ht,un,v,w,Ae,Pi,qe,ye,a,ei,ze||Ee,nt),si=[t,e,O,ve,wn,ze?gt:null,Ee?_t:null];if(c){if(re==="none")continue;if(re==="obstacle"){c.insert(ve.declutterBox);continue}else{let we,cn;if(We){const Ce=x-p;if(!We[Ce]){We[Ce]=si;continue}if(we=We[Ce],delete We[Ce],cn=fd(we),c.collides(cn))continue}if(c.collides(ve.declutterBox))continue;we&&(c.insert(cn),this.replayImageOrLabel_.apply(this,we)),c.insert(ve.declutterBox)}}this.replayImageOrLabel_.apply(this,si)}++g;break;case $.DRAW_CHARS:const ni=X[1],jt=X[2],Di=X[3],Hr=X[4];B=X[5];const qr=X[6],rr=X[7],sr=X[8];z=X[9];const Fi=X[10];M=X[11],F=X[12];const Zs=[X[13],X[13]],$r=this.textStates[F],ki=$r.font,ii=[$r.scale[0]*rr,$r.scale[1]*rr];let ri;ki in this.widths_?ri=this.widths_[ki]:(ri={},this.widths_[ki]=ri);const Ks=pv(f,ni,jt,2),Vs=Math.abs(ii[0])*qf(ki,M,ri);if(Hr||Vs<=Ks){const ve=this.textStates[F].textAlign,si=(Ks-Vs)*Ul(M,ve),we=Qw(f,ni,jt,2,M,si,qr,Math.abs(ii[0]),qf,ki,ri,V?0:this.viewRotation_);t:if(we){const cn=[];let Ce,or,oi,ae,le;if(z)for(Ce=0,or=we.length;Ce<or;++Ce){le=we[Ce],oi=le[4],ae=this.createLabel(oi,F,"",z),v=le[2]+(ii[0]<0?-Fi:Fi),w=Di*ae.height+(.5-Di)*2*Fi*ii[1]/ii[0]-sr;const fn=this.calculateImageOrLabelDimensions_(ae.width,ae.height,le[0],le[1],ae.width,ae.height,v,w,0,0,le[3],Zs,!1,Ji,!1,nt);if(c&&c.collides(fn.declutterBox))break t;cn.push([t,e,ae,fn,1,null,null])}if(B)for(Ce=0,or=we.length;Ce<or;++Ce){le=we[Ce],oi=le[4],ae=this.createLabel(oi,F,B,""),v=le[2],w=Di*ae.height-sr;const fn=this.calculateImageOrLabelDimensions_(ae.width,ae.height,le[0],le[1],ae.width,ae.height,v,w,0,0,le[3],Zs,!1,Ji,!1,nt);if(c&&c.collides(fn.declutterBox))break t;cn.push([t,e,ae,fn,1,null,null])}c&&c.load(cn.map(fd));for(let fn=0,Ra=cn.length;fn<Ra;++fn)this.replayImageOrLabel_.apply(this,cn[fn])}}++g;break;case $.END_GEOMETRY:if(l!==void 0){nt=X[1];const ve=l(nt,Ot);if(ve)return ve}++g;break;case $.FILL:U?H++:this.fill_(t),++g;break;case $.MOVE_TO_LINE_TO:for(p=X[1],x=X[2],St=f[p],xt=f[p+1],S=St+.5|0,b=xt+.5|0,(S!==R||b!==T)&&(t.moveTo(St,xt),R=S,T=b),p+=2;p<x;p+=2)St=f[p],xt=f[p+1],S=St+.5|0,b=xt+.5|0,(p==x-2||S!==R||b!==T)&&(t.lineTo(St,xt),R=S,T=b);++g;break;case $.SET_FILL_STYLE:gt=X,this.alignFill_=X[2],H&&(this.fill_(t),H=0,it&&(t.stroke(),it=0)),t.fillStyle=X[1],++g;break;case $.SET_STROKE_STYLE:_t=X,it&&(t.stroke(),it=0),this.setStrokeStyle_(t,X),++g;break;case $.STROKE:U?it++:t.stroke(),++g;break;default:++g;break}}H&&this.fill_(t),it&&t.stroke()}execute(t,e,n,s,a,l){this.viewRotation_=s,this.execute_(t,e,n,this.instructions,a,void 0,void 0,l)}executeHitDetection(t,e,n,s,a){return this.viewRotation_=n,this.execute_(t,1,e,this.hitDetectionInstructions,!0,s,a)}}const Zl=["Polygon","Circle","LineString","Image","Text","Default"];class gd{constructor(t,e,n,s,a,l){this.maxExtent_=t,this.overlaps_=s,this.pixelRatio_=n,this.resolution_=e,this.renderBuffer_=l,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=vn(),this.createExecutors_(a)}clip(t,e){const n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()}createExecutors_(t){for(const e in t){let n=this.executorsByZIndex_[e];n===void 0&&(n={},this.executorsByZIndex_[e]=n);const s=t[e];for(const a in s){const l=s[a];n[a]=new eC(this.resolution_,this.pixelRatio_,this.overlaps_,l)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const n=this.executorsByZIndex_[e];for(let s=0,a=t.length;s<a;++s)if(t[s]in n)return!0}return!1}forEachFeatureAtCoordinate(t,e,n,s,a,l){s=Math.round(s);const h=s*2+1,c=$n(this.hitDetectionTransform_,s+.5,s+.5,1/e,-1/e,-n,-t[0],-t[1]),f=!this.hitDetectionContext_;f&&(this.hitDetectionContext_=Se(h,h,void 0,{willReadFrequently:!0}));const g=this.hitDetectionContext_;g.canvas.width!==h||g.canvas.height!==h?(g.canvas.width=h,g.canvas.height=h):f||g.clearRect(0,0,h,h);let _;this.renderBuffer_!==void 0&&(_=an(),Es(_,t),Eh(_,e*(this.renderBuffer_+s),_));const p=nC(s);let x;function v(M,F){const z=g.getImageData(0,0,h,h).data;for(let B=0,H=p.length;B<H;B++)if(z[p[B]]>0){if(!l||x!=="Image"&&x!=="Text"||l.includes(M)){const it=(p[B]-3)/4,gt=s-it%h,_t=s-(it/h|0),ut=a(M,F,gt*gt+_t*_t);if(ut)return ut}g.clearRect(0,0,h,h);break}}const w=Object.keys(this.executorsByZIndex_).map(Number);w.sort(Si);let R,T,S,b,O;for(R=w.length-1;R>=0;--R){const M=w[R].toString();for(S=this.executorsByZIndex_[M],T=Zl.length-1;T>=0;--T)if(x=Zl[T],b=S[x],b!==void 0&&(O=b.executeHitDetection(g,c,n,v,_),O))return O}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const n=e[0],s=e[1],a=e[2],l=e[3],h=[n,s,n,l,a,l,a,s];return Ii(h,0,8,2,t,h),h}isEmpty(){return zr(this.executorsByZIndex_)}execute(t,e,n,s,a,l,h){const c=Object.keys(this.executorsByZIndex_).map(Number);c.sort(Si),this.maxExtent_&&(t.save(),this.clip(t,n)),l=l||Zl;let f,g,_,p,x,v;for(h&&c.reverse(),f=0,g=c.length;f<g;++f){const w=c[f].toString();for(x=this.executorsByZIndex_[w],_=0,p=l.length;_<p;++_){const R=l[_];v=x[R],v!==void 0&&v.execute(t,e,n,s,a,h)}}this.maxExtent_&&t.restore()}}const Kl={};function nC(r){if(Kl[r]!==void 0)return Kl[r];const t=r*2+1,e=r*r,n=new Array(e+1);for(let a=0;a<=r;++a)for(let l=0;l<=r;++l){const h=a*a+l*l;if(h>e)break;let c=n[h];c||(c=[],n[h]=c),c.push(((r+a)*t+(r+l))*4+3),a>0&&c.push(((r-a)*t+(r+l))*4+3),l>0&&(c.push(((r+a)*t+(r-l))*4+3),a>0&&c.push(((r-a)*t+(r-l))*4+3))}const s=[];for(let a=0,l=n.length;a<l;++a)n[a]&&s.push(...n[a]);return Kl[r]=s,s}class iC extends yg{constructor(t,e,n,s,a,l,h){super(),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=s,this.transformRotation_=s?Ch(Math.atan2(s[1],s[0]),10):0,this.viewRotation_=a,this.squaredTolerance_=l,this.userTransform_=h,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=vn()}drawImages_(t,e,n,s){if(!this.image_)return;const a=Ii(t,e,n,s,this.transform_,this.pixelCoordinates_),l=this.context_,h=this.tmpLocalTransform_,c=l.globalAlpha;this.imageOpacity_!=1&&(l.globalAlpha=c*this.imageOpacity_);let f=this.imageRotation_;this.transformRotation_===0&&(f-=this.viewRotation_),this.imageRotateWithView_&&(f+=this.viewRotation_);for(let g=0,_=a.length;g<_;g+=2){const p=a[g]-this.imageAnchorX_,x=a[g+1]-this.imageAnchorY_;if(f!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const v=p+this.imageAnchorX_,w=x+this.imageAnchorY_;$n(h,v,w,1,1,f,-v,-w),l.save(),l.transform.apply(l,h),l.translate(v,w),l.scale(this.imageScale_[0],this.imageScale_[1]),l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),l.restore()}else l.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,p,x,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(l.globalAlpha=c)}drawText_(t,e,n,s){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const a=Ii(t,e,n,s,this.transform_,this.pixelCoordinates_),l=this.context_;let h=this.textRotation_;for(this.transformRotation_===0&&(h-=this.viewRotation_),this.textRotateWithView_&&(h+=this.viewRotation_);e<n;e+=s){const c=a[e]+this.textOffsetX_,f=a[e+1]+this.textOffsetY_;h!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(l.save(),l.translate(c-this.textOffsetX_,f-this.textOffsetY_),l.rotate(h),l.translate(this.textOffsetX_,this.textOffsetY_),l.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&l.strokeText(this.text_,0,0),this.textFillState_&&l.fillText(this.text_,0,0),l.restore()):(this.textStrokeState_&&l.strokeText(this.text_,c,f),this.textFillState_&&l.fillText(this.text_,c,f))}}moveToLineTo_(t,e,n,s,a){const l=this.context_,h=Ii(t,e,n,s,this.transform_,this.pixelCoordinates_);l.moveTo(h[0],h[1]);let c=h.length;a&&(c-=2);for(let f=2;f<c;f+=2)l.lineTo(h[f],h[f+1]);return a&&l.closePath(),n}drawRings_(t,e,n,s){for(let a=0,l=n.length;a<l;++a)e=this.moveToLineTo_(t,e,n[a],s,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=nv(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],s=e[3]-e[1],a=Math.sqrt(n*n+s*s),l=this.context_;l.beginPath(),l.arc(e[0],e[1],a,0,2*Math.PI),this.fillState_&&l.fill(),this.strokeState_&&l.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const n=e.getGeometryFunction()(t);n&&(this.setStyle(e),this.drawGeometry(n))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let n=0,s=e.length;n<s;++n)this.drawGeometry(e[n])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),this.text_!==""&&this.drawText_(e,0,e.length,n)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(ke(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const n=this.context_,s=t.getFlatCoordinates();let a=0;const l=t.getEnds(),h=t.getStride();n.beginPath();for(let c=0,f=l.length;c<f;++c)a=this.moveToLineTo_(s,a,l[c],h,!1);n.stroke()}if(this.text_!==""){const n=t.getFlatMidpoints();this.drawText_(n,0,n.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!ke(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,n=t.getOrientedFlatCoordinates();let s=0;const a=t.getEndss(),l=t.getStride();e.beginPath();for(let h=0,c=a.length;h<c;++h){const f=a[h];s=this.drawRings_(n,s,f,l)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=t.lineCap,e.lineCap=t.lineCap),bi(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),n.lineJoin!=t.lineJoin&&(n.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,n=this.contextTextState_,s=t.textAlign?t.textAlign:bs;n?(n.font!=t.font&&(n.font=t.font,e.font=t.font),n.textAlign!=s&&(n.textAlign=s,e.textAlign=s),n.textBaseline!=t.textBaseline&&(n.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=s,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:s,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const n=t.getColor();this.fillState_={fillStyle:Ln(n||Fe)}}if(!e)this.strokeState_=null;else{const n=e.getColor(),s=e.getLineCap(),a=e.getLineDash(),l=e.getLineDashOffset(),h=e.getLineJoin(),c=e.getWidth(),f=e.getMiterLimit(),g=a||Vn;this.strokeState_={lineCap:s!==void 0?s:Xr,lineDash:this.pixelRatio_===1?g:g.map(_=>_*this.pixelRatio_),lineDashOffset:(l||Hn)*this.pixelRatio_,lineJoin:h!==void 0?h:Br,lineWidth:(c!==void 0?c:Ms)*this.pixelRatio_,miterLimit:f!==void 0?f:As,strokeStyle:Ln(n||Ls)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const n=t.getPixelRatio(this.pixelRatio_),s=t.getAnchor(),a=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=s[0]*n,this.imageAnchorY_=s[1]*n,this.imageHeight_=e[1]*n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=a[0],this.imageOriginY_=a[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const l=t.getScaleArray();this.imageScale_=[l[0]*this.pixelRatio_/n,l[1]*this.pixelRatio_/n],this.imageWidth_=e[0]*n}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const x=e.getColor();this.textFillState_={fillStyle:Ln(x||Fe)}}const n=t.getStroke();if(!n)this.textStrokeState_=null;else{const x=n.getColor(),v=n.getLineCap(),w=n.getLineDash(),R=n.getLineDashOffset(),T=n.getLineJoin(),S=n.getWidth(),b=n.getMiterLimit();this.textStrokeState_={lineCap:v!==void 0?v:Xr,lineDash:w||Vn,lineDashOffset:R||Hn,lineJoin:T!==void 0?T:Br,lineWidth:S!==void 0?S:Ms,miterLimit:b!==void 0?b:As,strokeStyle:Ln(x||Ls)}}const s=t.getFont(),a=t.getOffsetX(),l=t.getOffsetY(),h=t.getRotateWithView(),c=t.getRotation(),f=t.getScaleArray(),g=t.getText(),_=t.getTextAlign(),p=t.getTextBaseline();this.textState_={font:s!==void 0?s:rg,textAlign:_!==void 0?_:bs,textBaseline:p!==void 0?p:ea},this.text_=g!==void 0?Array.isArray(g)?g.reduce((x,v,w)=>x+=w%2?" ":v,""):g:"",this.textOffsetX_=a!==void 0?this.pixelRatio_*a:0,this.textOffsetY_=l!==void 0?this.pixelRatio_*l:0,this.textRotateWithView_=h!==void 0?h:!1,this.textRotation_=c!==void 0?c:0,this.textScale_=[this.pixelRatio_*f[0],this.pixelRatio_*f[1]]}}}const Sn=.5;function rC(r,t,e,n,s,a,l){const h=r[0]*Sn,c=r[1]*Sn,f=Se(h,c);f.imageSmoothingEnabled=!1;const g=f.canvas,_=new iC(f,Sn,s,null,l),p=e.length,x=Math.floor((256*256*256-1)/p),v={};for(let R=1;R<=p;++R){const T=e[R-1],S=T.getStyleFunction()||n;if(!S)continue;let b=S(T,a);if(!b)continue;Array.isArray(b)||(b=[b]);const M=(R*x).toString(16).padStart(7,"#00000");for(let F=0,z=b.length;F<z;++F){const B=b[F],H=B.getGeometryFunction()(T);if(!H||!ke(s,H.getExtent()))continue;const it=B.clone(),gt=it.getFill();gt&&gt.setColor(M);const _t=it.getStroke();_t&&(_t.setColor(M),_t.setLineDash(null)),it.setText(void 0);const ut=B.getImage();if(ut){const U=ut.getImageSize();if(!U)continue;const nt=Se(U[0],U[1],void 0,{alpha:!1}),St=nt.canvas;nt.fillStyle=M,nt.fillRect(0,0,St.width,St.height),it.setImage(new Yr({img:St,anchor:ut.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:ut.getOrigin(),opacity:1,size:ut.getSize(),scale:ut.getScale(),rotation:ut.getRotation(),rotateWithView:ut.getRotateWithView()}))}const Gt=it.getZIndex()||0;let V=v[Gt];V||(V={},v[Gt]=V,V.Polygon=[],V.Circle=[],V.LineString=[],V.Point=[]);const J=H.getType();if(J==="GeometryCollection"){const U=H.getGeometriesArrayRecursive();for(let nt=0,St=U.length;nt<St;++nt){const xt=U[nt];V[xt.getType().replace("Multi","")].push(xt,it)}}else V[J.replace("Multi","")].push(H,it)}}const w=Object.keys(v).map(Number).sort(Si);for(let R=0,T=w.length;R<T;++R){const S=v[w[R]];for(const b in S){const O=S[b];for(let M=0,F=O.length;M<F;M+=2){_.setStyle(O[M+1]);for(let z=0,B=t.length;z<B;++z)_.setTransform(t[z]),_.drawGeometry(O[M])}}}return f.getImageData(0,0,g.width,g.height)}function sC(r,t,e){const n=[];if(e){const s=Math.floor(Math.round(r[0])*Sn),a=Math.floor(Math.round(r[1])*Sn),l=(qt(s,0,e.width-1)+qt(a,0,e.height-1)*e.width)*4,h=e.data[l],c=e.data[l+1],g=e.data[l+2]+256*(c+256*h),_=Math.floor((256*256*256-1)/t.length);g&&g%_===0&&n.push(t[g/_-1])}return n}const oC=.5,vg={Point:_C,LineString:fC,Polygon:pC,MultiPoint:mC,MultiLineString:dC,MultiPolygon:gC,GeometryCollection:cC,Circle:hC};function aC(r,t){return parseInt(It(r),10)-parseInt(It(t),10)}function lC(r,t){const e=uh(r,t);return e*e}function uh(r,t){return oC*r/t}function hC(r,t,e,n,s){const a=e.getFill(),l=e.getStroke();if(a||l){const c=r.getBuilder(e.getZIndex(),"Circle");c.setFillStrokeStyle(a,l),c.drawCircle(t,n)}const h=e.getText();if(h&&h.getText()){const c=(s||r).getBuilder(e.getZIndex(),"Text");c.setTextStyle(h),c.drawText(t,n)}}function _d(r,t,e,n,s,a,l){let h=!1;const c=e.getImage();if(c){const f=c.getImageState();f==Ft.LOADED||f==Ft.ERROR?c.unlistenImageChange(s):(f==Ft.IDLE&&c.load(),c.listenImageChange(s),h=!0)}return uC(r,t,e,n,a,l),h}function uC(r,t,e,n,s,a){const l=e.getGeometryFunction()(t);if(!l)return;const h=l.simplifyTransformed(n,s);if(e.getRenderer())wg(r,h,e,t);else{const f=vg[h.getType()];f(r,h,e,t,a)}}function wg(r,t,e,n){if(t.getType()=="GeometryCollection"){const a=t.getGeometries();for(let l=0,h=a.length;l<h;++l)wg(r,a[l],e,n);return}r.getBuilder(e.getZIndex(),"Default").drawCustom(t,n,e.getRenderer(),e.getHitDetectionRenderer())}function cC(r,t,e,n,s){const a=t.getGeometriesArray();let l,h;for(l=0,h=a.length;l<h;++l){const c=vg[a[l].getType()];c(r,a[l],e,n,s)}}function fC(r,t,e,n,s){const a=e.getStroke();if(a){const h=r.getBuilder(e.getZIndex(),"LineString");h.setFillStrokeStyle(null,a),h.drawLineString(t,n)}const l=e.getText();if(l&&l.getText()){const h=(s||r).getBuilder(e.getZIndex(),"Text");h.setTextStyle(l),h.drawText(t,n)}}function dC(r,t,e,n,s){const a=e.getStroke();if(a){const h=r.getBuilder(e.getZIndex(),"LineString");h.setFillStrokeStyle(null,a),h.drawMultiLineString(t,n)}const l=e.getText();if(l&&l.getText()){const h=(s||r).getBuilder(e.getZIndex(),"Text");h.setTextStyle(l),h.drawText(t,n)}}function gC(r,t,e,n,s){const a=e.getFill(),l=e.getStroke();if(l||a){const c=r.getBuilder(e.getZIndex(),"Polygon");c.setFillStrokeStyle(a,l),c.drawMultiPolygon(t,n)}const h=e.getText();if(h&&h.getText()){const c=(s||r).getBuilder(e.getZIndex(),"Text");c.setTextStyle(h),c.drawText(t,n)}}function _C(r,t,e,n,s){const a=e.getImage(),l=e.getText();let h;if(a){if(a.getImageState()!=Ft.LOADED)return;let c=r;if(s){const g=a.getDeclutterMode();if(g!=="none")if(c=s,g==="obstacle"){const _=r.getBuilder(e.getZIndex(),"Image");_.setImageStyle(a,h),_.drawPoint(t,n)}else l&&l.getText()&&(h={})}const f=c.getBuilder(e.getZIndex(),"Image");f.setImageStyle(a,h),f.drawPoint(t,n)}if(l&&l.getText()){let c=r;s&&(c=s);const f=c.getBuilder(e.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(t,n)}}function mC(r,t,e,n,s){const a=e.getImage(),l=e.getText();let h;if(a){if(a.getImageState()!=Ft.LOADED)return;let c=r;if(s){const g=a.getDeclutterMode();if(g!=="none")if(c=s,g==="obstacle"){const _=r.getBuilder(e.getZIndex(),"Image");_.setImageStyle(a,h),_.drawMultiPoint(t,n)}else l&&l.getText()&&(h={})}const f=c.getBuilder(e.getZIndex(),"Image");f.setImageStyle(a,h),f.drawMultiPoint(t,n)}if(l&&l.getText()){let c=r;s&&(c=s);const f=c.getBuilder(e.getZIndex(),"Text");f.setTextStyle(l,h),f.drawText(t,n)}}function pC(r,t,e,n,s){const a=e.getFill(),l=e.getStroke();if(a||l){const c=r.getBuilder(e.getZIndex(),"Polygon");c.setFillStrokeStyle(a,l),c.drawPolygon(t,n)}const h=e.getText();if(h&&h.getText()){const c=(s||r).getBuilder(e.getZIndex(),"Text");c.setTextStyle(h),c.drawText(t,n)}}class yC extends Eg{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=an(),this.wrappedRenderedExtent_=an(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(t,e,n){const s=e.extent,a=e.viewState,l=a.center,h=a.resolution,c=a.projection,f=a.rotation,g=c.getExtent(),_=this.getLayer().getSource(),p=e.pixelRatio,x=e.viewHints,v=!(x[fe.ANIMATING]||x[fe.INTERACTING]),w=this.compositionContext_,R=Math.round(e.size[0]*p),T=Math.round(e.size[1]*p),S=_.getWrapX()&&c.canWrapX(),b=S?kt(g):null,O=S?Math.ceil((s[2]-g[2])/b)+1:1;let M=S?Math.floor((s[0]-g[0])/b):0;do{const F=this.getRenderTransform(l,h,f,p,R,T,M*b);t.execute(w,1,F,f,v,void 0,n)}while(++M<O)}setupCompositionContext_(){if(this.opacity_!==1){const t=Se(this.context.canvas.width,this.context.canvas.height,cd);this.compositionContext_=t}else this.compositionContext_=this.context}releaseCompositionContext_(){if(this.opacity_!==1){const t=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=t,ma(this.compositionContext_),cd.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(t){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,t,t.declutterTree),this.releaseCompositionContext_())}renderFrame(t,e){const n=t.pixelRatio,s=t.layerStatesArray[t.layerIndex];wE(this.pixelTransform,1/n,1/n),xh(this.inversePixelTransform,this.pixelTransform);const a=bd(this.pixelTransform);this.useContainer(e,a,this.getBackground(t));const l=this.context,h=l.canvas,c=this.replayGroup_,f=this.declutterExecutorGroup;let g=c&&!c.isEmpty()||f&&!f.isEmpty();if(!g&&!(this.getLayer().hasListener(bn.PRERENDER)||this.getLayer().hasListener(bn.POSTRENDER)))return null;const _=Math.round(t.size[0]*n),p=Math.round(t.size[1]*n);h.width!=_||h.height!=p?(h.width=_,h.height=p,h.style.transform!==a&&(h.style.transform=a)):this.containerReused||l.clearRect(0,0,_,p),this.preRender(l,t);const x=t.viewState;x.projection,this.opacity_=s.opacity,this.setupCompositionContext_();let v=!1;if(g&&s.extent&&this.clipping){const w=$i(s.extent);g=ke(w,t.extent),v=g&&!Mr(w,t.extent),v&&this.clipUnrotated(this.compositionContext_,t,w)}return g&&this.renderWorlds(c,t),v&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(l,t),this.renderedRotation_!==x.rotation&&(this.renderedRotation_=x.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(t){return new Promise(e=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const n=[this.context.canvas.width,this.context.canvas.height];ne(this.pixelTransform,n);const s=this.renderedCenter_,a=this.renderedResolution_,l=this.renderedRotation_,h=this.renderedProjection_,c=this.wrappedRenderedExtent_,f=this.getLayer(),g=[],_=n[0]*Sn,p=n[1]*Sn;g.push(this.getRenderTransform(s,a,l,Sn,_,p,0).slice());const x=f.getSource(),v=h.getExtent();if(x.getWrapX()&&h.canWrapX()&&!Mr(v,c)){let w=c[0];const R=kt(v);let T=0,S;for(;w<v[0];)--T,S=R*T,g.push(this.getRenderTransform(s,a,l,Sn,_,p,S).slice()),w+=R;for(T=0,w=c[2];w>v[2];)++T,S=R*T,g.push(this.getRenderTransform(s,a,l,Sn,_,p,S).slice()),w-=R}this.hitDetectionImageData_=rC(n,g,this.renderedFeatures_,f.getStyleFunction(),c,a,l)}e(sC(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,n,s,a){if(!this.replayGroup_)return;const l=e.viewState.resolution,h=e.viewState.rotation,c=this.getLayer(),f={},g=function(x,v,w){const R=It(x),T=f[R];if(T){if(T!==!0&&w<T.distanceSq){if(w===0)return f[R]=!0,a.splice(a.lastIndexOf(T),1),s(x,c,v);T.geometry=v,T.distanceSq=w}}else{if(w===0)return f[R]=!0,s(x,c,v);a.push(f[R]={feature:x,layer:c,geometry:v,distanceSq:w,callback:s})}};let _;const p=[this.replayGroup_];return this.declutterExecutorGroup&&p.push(this.declutterExecutorGroup),p.some(x=>_=x.forEachFeatureAtCoordinate(t,l,h,n,g,x===this.declutterExecutorGroup&&e.declutterTree?e.declutterTree.all().map(v=>v.value):null)),_}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),n=e.getSource();if(!n)return!1;const s=t.viewHints[fe.ANIMATING],a=t.viewHints[fe.INTERACTING],l=e.getUpdateWhileAnimating(),h=e.getUpdateWhileInteracting();if(this.ready&&!l&&s||!h&&a)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const c=t.extent,f=t.viewState,g=f.projection,_=f.resolution,p=t.pixelRatio,x=e.getRevision(),v=e.getRenderBuffer();let w=e.getRenderOrder();w===void 0&&(w=aC);const R=f.center.slice(),T=Eh(c,v*_),S=T.slice(),b=[T.slice()],O=g.getExtent();if(n.getWrapX()&&g.canWrapX()&&!Mr(O,t.extent)){const V=kt(O),J=Math.max(kt(T)/2,V);T[0]=O[0]-J,T[2]=O[2]+J,Wd(R,g);const U=Nd(b[0],g);U[0]<O[0]&&U[2]<O[2]?b.push([U[0]+V,U[1],U[2]+V,U[3]]):U[0]>O[0]&&U[2]>O[2]&&b.push([U[0]-V,U[1],U[2]-V,U[3]])}if(this.ready&&this.renderedResolution_==_&&this.renderedRevision_==x&&this.renderedRenderOrder_==w&&Mr(this.wrappedRenderedExtent_,T))return bi(this.renderedExtent_,S)||(this.hitDetectionImageData_=null,this.renderedExtent_=S),this.renderedCenter_=R,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const M=new ud(uh(_,p),T,_,p);let F;this.getLayer().getDeclutter()&&(F=new ud(uh(_,p),T,_,p));let z;for(let V=0,J=b.length;V<J;++V)n.loadFeatures(b[V],_,g);const B=lC(_,p);let H=!0;const it=V=>{let J;const U=V.getStyleFunction()||e.getStyleFunction();if(U&&(J=U(V,_)),J){const nt=this.renderFeature(V,B,J,M,z,F);H=H&&!nt}},gt=Yd(T),_t=n.getFeaturesInExtent(gt);w&&_t.sort(w);for(let V=0,J=_t.length;V<J;++V)it(_t[V]);this.renderedFeatures_=_t,this.ready=H;const ut=M.finish(),Gt=new gd(T,_,p,n.getOverlaps(),ut,e.getRenderBuffer());return F&&(this.declutterExecutorGroup=new gd(T,_,p,n.getOverlaps(),F.finish(),e.getRenderBuffer())),this.renderedResolution_=_,this.renderedRevision_=x,this.renderedRenderOrder_=w,this.renderedExtent_=S,this.wrappedRenderedExtent_=T,this.renderedCenter_=R,this.renderedProjection_=g,this.replayGroup_=Gt,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,n,s,a,l){if(!n)return!1;let h=!1;if(Array.isArray(n))for(let c=0,f=n.length;c<f;++c)h=_d(s,t,n[c],e,this.boundHandleStyleImageChange_,a,l)||h;else h=_d(s,t,n,e,this.boundHandleStyleImageChange_,a,l);return h}}class xC extends Yw{constructor(t){super(t)}createRenderer(){return new yC(this)}}class md{constructor(t){this.rbush_=new hg(t),this.items_={}}insert(t,e){const n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[It(e)]=n}load(t,e){const n=new Array(e.length);for(let s=0,a=e.length;s<a;s++){const l=t[s],h=e[s],c={minX:l[0],minY:l[1],maxX:l[2],maxY:l[3],value:h};n[s]=c,this.items_[It(h)]=c}this.rbush_.load(n)}remove(t){const e=It(t),n=this.items_[e];return delete this.items_[e],this.rbush_.remove(n)!==null}update(t,e){const n=this.items_[It(e)],s=[n.minX,n.minY,n.maxX,n.maxY];Cs(s,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(s){return s.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let n;for(let s=0,a=t.length;s<a;s++)if(n=e(t[s]),n)return n;return n}isEmpty(){return zr(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return jn(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}function EC(r,t,e,n){const s=[];let a=an();for(let l=0,h=e.length;l<h;++l){const c=e[l];a=vh(r,t,c[0],n),s.push((a[0]+a[2])/2,(a[1]+a[3])/2),t=c[c.length-1]}return s}const pd=vn();class sn{constructor(t,e,n,s,a,l){this.styleFunction,this.extent_,this.id_=l,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=n,this.properties_=a,this.squaredTolerance_,this.stride_=s,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Dd(this.flatCoordinates_):vh(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=er(this.getExtent());this.flatInteriorPoints_=Mh(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=mv(this.flatCoordinates_,this.ends_),e=EC(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=cv(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Xf(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const n=this.ends_;for(let s=0,a=n.length;s<a;++s){const l=n[s],h=Xf(t,e,l,2,.5);mh(this.flatMidpoints_,h),e=l}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=ln(t);const e=t.getExtent(),n=t.getWorldExtent();if(e&&n){const s=He(n)/He(e);$n(pd,n[0],n[3],s,-s,0,0,0),Ii(this.flatCoordinates_,0,this.flatCoordinates_.length,2,pd,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){return new sn(this.type_,this.flatCoordinates_.slice(),this.ends_.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Td((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const n=this.simplifiedGeometry_.getFlatCoordinates();let s;switch(this.type_){case"LineString":n.length=bh(n,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,n,0),s=[n.length];break;case"MultiLineString":s=[],n.length=av(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,n,0,s);break;case"Polygon":s=[],n.length=Hd(n,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),n,0,s);break}return s&&(this.simplifiedGeometry_=new sn(this.type_,n,s,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}sn.prototype.getFlatCoordinates=sn.prototype.getOrientedFlatCoordinates;class Cg extends On{constructor(t){super(),this.projection=ln(t.projection),this.attributions_=yd(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible!==void 0?t.attributionsCollapsible:!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(n,s){e.viewResolver=n,e.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=yd(t),this.changed()}setState(t){this.state_=t,this.changed()}}function yd(r){return r?Array.isArray(r)?function(t){return r}:typeof r=="function"?r:function(t){return[r]}:null}const yn={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function vC(r,t){return[[-1/0,-1/0,1/0,1/0]]}let wC=!1;function CC(r,t,e,n,s,a,l){const h=new XMLHttpRequest;h.open("GET",typeof r=="function"?r(e,n,s):r,!0),t.getType()=="arraybuffer"&&(h.responseType="arraybuffer"),h.withCredentials=wC,h.onload=function(c){if(!h.status||h.status>=200&&h.status<300){const f=t.getType();let g;f=="json"?g=JSON.parse(h.responseText):f=="text"?g=h.responseText:f=="xml"?(g=h.responseXML,g||(g=new DOMParser().parseFromString(h.responseText,"application/xml"))):f=="arraybuffer"&&(g=h.response),g?a(t.readFeatures(g,{extent:e,featureProjection:s}),t.readProjection(g)):l()}else l()},h.onerror=l,h.send()}function xd(r,t){return function(e,n,s,a,l){const h=this;CC(r,t,e,n,s,function(c,f){h.addFeatures(c),a!==void 0&&a(c)},l||Wr)}}class yi extends Qn{constructor(t,e,n){super(t),this.feature=e,this.features=n}}class RC extends Cg{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Wr,this.format_=t.format,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(vt(this.format_,"`format` must be set when `url` is set"),this.loader_=xd(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:vC;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new md:null,this.loadedExtentsRtree_=new md,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let n,s;Array.isArray(t.features)?s=t.features:t.features&&(n=t.features,s=n.getArray()),!e&&n===void 0&&(n=new An(s)),s!==void 0&&this.addFeaturesInternal(s),n!==void 0&&this.bindFeaturesCollection_(n)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=It(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const n=t.getGeometry();if(n){const s=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(s,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new yi(yn.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof sn||(this.featureChangeKeys_[t]=[Ct(e,ht.CHANGE,this.handleFeatureChange_,this),Ct(e,Gr.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let n=!0;if(e.getId()!==void 0){const s=String(e.getId());if(!(s in this.idIndex_))this.idIndex_[s]=e;else if(e instanceof sn){const a=this.idIndex_[s];a instanceof sn?Array.isArray(a)?a.push(e):this.idIndex_[s]=[a,e]:n=!1}else n=!1}return n&&(vt(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),n}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],n=[],s=[];for(let a=0,l=t.length;a<l;a++){const h=t[a],c=It(h);this.addToIndex_(c,h)&&n.push(h)}for(let a=0,l=n.length;a<l;a++){const h=n[a],c=It(h);this.setupChangeEvents_(c,h);const f=h.getGeometry();if(f){const g=f.getExtent();e.push(g),s.push(h)}else this.nullGeometryFeatures_[c]=h}if(this.featuresRtree_&&this.featuresRtree_.load(e,s),this.hasListener(yn.ADDFEATURE))for(let a=0,l=n.length;a<l;a++)this.dispatchEvent(new yi(yn.ADDFEATURE,n[a]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(yn.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),this.addEventListener(yn.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),t.addEventListener(De.ADD,n=>{e||(e=!0,this.addFeature(n.element),e=!1)}),t.addEventListener(De.REMOVE,n=>{e||(e=!0,this.removeFeature(n.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const n in this.featureChangeKeys_)this.featureChangeKeys_[n].forEach(zt);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const n=s=>{this.removeFeatureInternal(s)};this.featuresRtree_.forEach(n);for(const s in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[s])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new yi(yn.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const n=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(n,function(s){const a=s.getGeometry();if(a instanceof sn||a.intersectsCoordinate(t))return e(s)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(n){const s=n.getGeometry();if(s instanceof sn||s.intersectsExtent(t)){const a=e(n);if(a)return a}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),zr(this.nullGeometryFeatures_)||mh(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(n){e.push(n)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const s=ME(t,e);return[].concat(...s.map(a=>this.featuresRtree_.getInExtent(a)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const n=t[0],s=t[1];let a=null;const l=[NaN,NaN];let h=1/0;const c=[-1/0,-1/0,1/0,1/0];return e=e||ws,this.featuresRtree_.forEachInExtent(c,function(f){if(e(f)){const g=f.getGeometry(),_=h;if(h=g instanceof sn?0:g.closestPointXY(n,s,l,h),h<_){a=f;const p=Math.sqrt(h);c[0]=n-p,c[1]=s-p,c[2]=n+p,c[3]=s+p}}}),a}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,n=It(e),s=e.getGeometry();if(!s)n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);else{const l=s.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(l,e)):this.featuresRtree_&&this.featuresRtree_.update(l,e)}const a=e.getId();if(a!==void 0){const l=a.toString();this.idIndex_[l]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[l]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[n]=e;this.changed(),this.dispatchEvent(new yi(yn.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:It(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&zr(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,n){const s=this.loadedExtentsRtree_,a=this.strategy_(t,e,n);for(let l=0,h=a.length;l<h;++l){const c=a[l];s.forEachInExtent(c,function(g){return Mr(g.extent,c)})||(++this.loadingExtentsCount_,this.dispatchEvent(new yi(yn.FEATURESLOADSTART)),this.loader_.call(this,c,e,n,g=>{--this.loadingExtentsCount_,this.dispatchEvent(new yi(yn.FEATURESLOADEND,void 0,g))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new yi(yn.FEATURESLOADERROR))}),s.insert(c,{extent:c.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let n;e.forEachInExtent(t,function(s){if(Cs(s.extent,t))return n=s,!0}),n&&e.remove(n)}removeFeature(t){if(!t)return;const e=It(t);e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=It(t),n=this.featureChangeKeys_[e];if(!n)return;n.forEach(zt),delete this.featureChangeKeys_[e];const s=t.getId();return s!==void 0&&delete this.idIndex_[s.toString()],delete this.uidIndex_[e],this.dispatchEvent(new yi(yn.REMOVEFEATURE,t)),t}removeFromIdIndex_(t){let e=!1;for(const n in this.idIndex_){const s=this.idIndex_[n];if(t instanceof sn&&Array.isArray(s)&&s.includes(t))s.splice(s.indexOf(t),1);else if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}}return e}setLoader(t){this.loader_=t}setUrl(t){vt(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(xd(t,this.format_))}}const j={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class Rg extends la{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(ht.CHANGE)}release(){this.state===j.ERROR&&this.setState(j.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){let t=this.interimTile;if(!t)return this;do{if(t.getState()==j.LOADED)return this.transition_=0,t;t=t.interimTile}while(t);return this}refreshInterimChain(){let t=this.interimTile;if(!t)return;let e=this;do{if(t.getState()==j.LOADED){t.interimTile=null;break}t.getState()==j.LOADING?e=t:t.getState()==j.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==j.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){wt()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const s=e-n+1e3/60;return s>=this.transition_?1:ag(s/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}class Tg extends Rg{constructor(t,e,n,s,a,l){super(t,e,l),this.crossOrigin_=s,this.src_=n,this.key=n,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=a}getImage(){return this.image_}setImage(t){this.image_=t,this.state=j.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=j.ERROR,this.unlistenImage_(),this.image_=TC(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=j.LOADED:this.state=j.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==j.ERROR&&(this.state=j.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==j.IDLE&&(this.state=j.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=ew(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function TC(){const r=Se(1,1);return r.fillStyle="rgba(0,0,0,0)",r.fillRect(0,0,1,1),r.canvas}class IC{constructor(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let n=e-3;for(;n>0&&this.points_[n+2]>t;)n-=3;const s=this.points_[e+2]-this.points_[n+2];if(s<1e3/60)return!1;const a=this.points_[e]-this.points_[n],l=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(l,a),this.initialVelocity_=Math.sqrt(a*a+l*l)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class SC extends gh{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){wt()}calculateMatrices2D(t){const e=t.viewState,n=t.coordinateToPixelTransform,s=t.pixelToCoordinateTransform;$n(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),xh(s,n)}forEachFeatureAtCoordinate(t,e,n,s,a,l,h,c){let f;const g=e.viewState;function _(O,M,F,z){return a.call(l,M,O?F:null,z)}const p=g.projection,x=Wd(t.slice(),p),v=[[0,0]];if(p.canWrapX()&&s){const O=p.getExtent(),M=kt(O);v.push([-M,0],[M,0])}const w=e.layerStatesArray,R=w.length,T=[],S=[];for(let O=0;O<v.length;O++)for(let M=R-1;M>=0;--M){const F=w[M],z=F.layer;if(z.hasRenderer()&&Xh(F,g)&&h.call(c,z)){const B=z.getRenderer(),H=z.getSource();if(B&&H){const it=H.getWrapX()?x:t,gt=_.bind(null,F.managed);S[0]=it[0]+v[O][0],S[1]=it[1]+v[O][1],f=B.forEachFeatureAtCoordinate(S,e,n,gt,T)}if(f)return f}}if(T.length===0)return;const b=1/T.length;return T.forEach((O,M)=>O.distanceSq+=M*b),T.sort((O,M)=>O.distanceSq-M.distanceSq),T.some(O=>f=O.callback(O.feature,O.layer,O.geometry)),f}hasFeatureAtCoordinate(t,e,n,s,a,l){return this.forEachFeatureAtCoordinate(t,e,n,s,ws,this,a,l)!==void 0}getMap(){return this.map_}renderFrame(t){wt()}flushDeclutterItems(t){}scheduleExpireIconCache(t){ia.canExpireCache()&&t.postRenderFunctions.push(AC)}}function AC(r,t){ia.expire()}class LC extends SC{constructor(t){super(t),this.fontChangeListenerKey_=Ct(Kn,Gr.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=pa+" ol-layers";const n=t.getViewport();n.insertBefore(this.element_,n.firstChild||null),this.children_=[],this.renderedVisible_=!0,this.declutterLayers_=[]}dispatchRenderEvent(t,e){const n=this.getMap();if(n.hasListener(t)){const s=new xg(t,void 0,e);n.dispatchEvent(s)}}disposeInternal(){zt(this.fontChangeListenerKey_),this.element_.parentNode.removeChild(this.element_),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(bn.PRECOMPOSE,t);const e=t.layerStatesArray.sort(function(l,h){return l.zIndex-h.zIndex}),n=t.viewState;this.children_.length=0;const s=this.declutterLayers_;s.length=0;let a=null;for(let l=0,h=e.length;l<h;++l){const c=e[l];t.layerIndex=l;const f=c.layer,g=f.getSourceState();if(!Xh(c,n)||g!="ready"&&g!="undefined"){f.unrender();continue}const _=f.render(t,a);_&&(_!==a&&(this.children_.push(_),a=_),"getDeclutter"in f&&s.push(f))}this.flushDeclutterItems(t),Iv(this.element_,this.children_),this.dispatchRenderEvent(bn.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}flushDeclutterItems(t){const e=this.declutterLayers_;for(let n=e.length-1;n>=0;--n)e[n].renderDeclutter(t);e.length=0}}class Ci extends Qn{constructor(t,e){super(t),this.layer=e}}const Vl={LAYERS:"layers"};class Vr extends og{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let n=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Vl.LAYERS,this.handleLayersChanged_),n?Array.isArray(n)?n=new An(n.slice(),{unique:!0}):vt(typeof n.getArray=="function","Expected `layers` to be an array or a `Collection`"):n=new An(void 0,{unique:!0}),this.setLayers(n)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(zt),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(Ct(t,De.ADD,this.handleLayersAdd_,this),Ct(t,De.REMOVE,this.handleLayersRemove_,this));for(const n in this.listenerKeys_)this.listenerKeys_[n].forEach(zt);Fs(this.listenerKeys_);const e=t.getArray();for(let n=0,s=e.length;n<s;n++){const a=e[n];this.registerLayerListeners_(a),this.dispatchEvent(new Ci("addlayer",a))}this.changed()}registerLayerListeners_(t){const e=[Ct(t,Gr.PROPERTYCHANGE,this.handleLayerChange_,this),Ct(t,ht.CHANGE,this.handleLayerChange_,this)];t instanceof Vr&&e.push(Ct(t,"addlayer",this.handleLayerGroupAdd_,this),Ct(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[It(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Ci("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Ci("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Ci("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,n=It(e);this.listenerKeys_[n].forEach(zt),delete this.listenerKeys_[n],this.dispatchEvent(new Ci("removelayer",e)),this.changed()}getLayers(){return this.get(Vl.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const n=e.getArray();for(let s=0,a=n.length;s<a;++s)this.dispatchEvent(new Ci("removelayer",n[s]))}this.set(Vl.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],n=e.length;this.getLayers().forEach(function(l){l.getLayerStatesArray(e)});const s=this.getLayerState();let a=s.zIndex;!t&&s.zIndex===void 0&&(a=0);for(let l=n,h=e.length;l<h;l++){const c=e[l];c.opacity*=s.opacity,c.visible=c.visible&&s.visible,c.maxResolution=Math.min(c.maxResolution,s.maxResolution),c.minResolution=Math.max(c.minResolution,s.minResolution),c.minZoom=Math.max(c.minZoom,s.minZoom),c.maxZoom=Math.min(c.maxZoom,s.maxZoom),s.extent!==void 0&&(c.extent!==void 0?c.extent=vs(c.extent,s.extent):c.extent=s.extent),c.zIndex===void 0&&(c.zIndex=a)}return e}getSourceState(){return"ready"}}class br extends Qn{constructor(t,e,n){super(t),this.map=e,this.frameState=n!==void 0?n:null}}class Ei extends br{constructor(t,e,n,s,a,l){super(t,e,a),this.originalEvent=n,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0?s:!1,this.activePointers=l}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const Yt={SINGLECLICK:"singleclick",CLICK:ht.CLICK,DBLCLICK:ht.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ch={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class bC extends la{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const n=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=n,this.pointerdownListenerKey_=Ct(n,ch.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=Ct(n,ch.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(ht.TOUCHMOVE,this.boundHandleTouchMove_,Ld?{passive:!1}:!1)}emulateClick_(t){let e=new Ei(Yt.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Ei(Yt.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const n=new Ei(Yt.SINGLECLICK,this.map_,t);this.dispatchEvent(n)},250)}updateActivePointers_(t){const e=t,n=e.pointerId;if(e.type==Yt.POINTERUP||e.type==Yt.POINTERCANCEL){delete this.trackedTouches_[n];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==e.target){delete this.trackedTouches_[s];break}}else(e.type==Yt.POINTERDOWN||e.type==Yt.POINTERMOVE)&&(this.trackedTouches_[n]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Ei(Yt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(zt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new Ei(Yt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const n=this.map_.getOwnerDocument();this.dragListenerKeys_.push(Ct(n,Yt.POINTERMOVE,this.handlePointerMove_,this),Ct(n,Yt.POINTERUP,this.handlePointerUp_,this),Ct(this.element_,Yt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==n&&this.dragListenerKeys_.push(Ct(this.element_.getRootNode(),Yt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Ei(Yt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new Ei(Yt.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(zt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(ht.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(zt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(zt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const vi={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},ce={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},oa=1/0;class MC{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Fs(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,n=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const s=this.keyFunction_(n);return delete this.queuedElements_[s],n}enqueue(t){vt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=oa?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,n=this.priorities_,s=e.length,a=e[t],l=n[t],h=t;for(;t<s>>1;){const c=this.getLeftChildIndex_(t),f=this.getRightChildIndex_(t),g=f<s&&n[f]<n[c]?f:c;e[t]=e[g],n[t]=n[g],t=g}e[t]=a,n[t]=l,this.siftDown_(h,t)}siftDown_(t,e){const n=this.elements_,s=this.priorities_,a=n[e],l=s[e];for(;e>t;){const h=this.getParentIndex_(e);if(s[h]>l)n[e]=n[h],s[e]=s[h],e=h;else break}n[e]=a,s[e]=l}reprioritize(){const t=this.priorityFunction_,e=this.elements_,n=this.priorities_;let s=0;const a=e.length;let l,h,c;for(h=0;h<a;++h)l=e[h],c=t(l),c==oa?delete this.queuedElements_[this.keyFunction_(l)]:(n[s]=c,e[s++]=l);e.length=s,n.length=s,this.heapify_()}}class OC extends MC{constructor(t,e){super(function(n){return t.apply(null,n)},function(n){return n[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(ht.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,n=e.getState();if(n===j.LOADED||n===j.ERROR||n===j.EMPTY){n!==j.ERROR&&e.removeEventListener(ht.CHANGE,this.boundHandleTileChange_);const s=e.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let n=0,s,a,l;for(;this.tilesLoading_<t&&n<e&&this.getCount()>0;)a=this.dequeue()[0],l=a.getKey(),s=a.getState(),s===j.IDLE&&!(l in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[l]=!0,++this.tilesLoading_,++n,a.load())}}function PC(r,t,e,n,s){if(!r||!(e in r.wantedTiles)||!r.wantedTiles[e][t.getKey()])return oa;const a=r.viewState.center,l=n[0]-a[0],h=n[1]-a[1];return 65536*Math.log(s)+Math.sqrt(l*l+h*h)/s}class Yh extends On{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){oh(this.element),super.disposeInternal()}getMap(){return this.map_}setMap(t){this.map_&&oh(this.element);for(let e=0,n=this.listenerKeys.length;e<n;++e)zt(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==Wr&&this.listenerKeys.push(Ct(t,vi.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class DC extends Yh{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1);const e=t.className!==void 0?t.className:"ol-attribution",n=t.tipLabel!==void 0?t.tipLabel:"Attributions",s=t.expandClassName!==void 0?t.expandClassName:e+"-expand",a=t.collapseLabel!==void 0?t.collapseLabel:"›",l=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof a=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a,this.collapseLabel_.className=l):this.collapseLabel_=a;const h=t.label!==void 0?t.label:"i";typeof h=="string"?(this.label_=document.createElement("span"),this.label_.textContent=h,this.label_.className=s):this.label_=h;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=n,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(ht.CLICK,this.handleClick_.bind(this),!1);const f=e+" "+pa+" "+Fh+(this.collapsed_&&this.collapsible_?" "+Vf:"")+(this.collapsible_?"":" ol-uncollapsible"),g=this.element;g.className=f,g.appendChild(this.toggleButton_),g.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=Array.from(new Set(this.getMap().getAllLayers().flatMap(s=>s.getAttributions(t)))),n=!this.getMap().getAllLayers().some(s=>s.getSource()&&s.getSource().getAttributionsCollapsible()===!1);return this.overrideCollapsible_||this.setCollapsible(n),e}updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=this.collectSourceAttributions_(t),n=e.length>0;if(this.renderedVisible_!=n&&(this.element.style.display=n?"":"none",this.renderedVisible_=n),!bi(e,this.renderedAttributions_)){Tv(this.ulElement_);for(let s=0,a=e.length;s<a;++s){const l=document.createElement("li");l.innerHTML=e[s],this.ulElement_.appendChild(l)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(Vf),this.collapsed_?Kf(this.collapseLabel_,this.label_):Kf(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class FC extends Yh{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",n=t.label!==void 0?t.label:"⇧",s=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof n=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=n):(this.label_=n,this.label_.classList.add(s));const a=t.tipLabel?t.tipLabel:"Reset rotation",l=document.createElement("button");l.className=e+"-reset",l.setAttribute("type","button"),l.title=a,l.appendChild(this.label_),l.addEventListener(ht.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+pa+" "+Fh,c=this.element;c.className=h,c.appendChild(l),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(Xo)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const n=e.getRotation();n!==void 0&&(this.duration_>0&&n%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Ur}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const n=e.viewState.rotation;if(n!=this.rotation_){const s="rotate("+n+"rad)";if(this.autoHide_){const a=this.element.classList.contains(Xo);!a&&n===0?this.element.classList.add(Xo):a&&n!==0&&this.element.classList.remove(Xo)}this.label_.style.transform=s}this.rotation_=n}}class kC extends Yh{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",n=t.delta!==void 0?t.delta:1,s=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",a=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",l=t.zoomInLabel!==void 0?t.zoomInLabel:"+",h=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",c=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",f=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof l=="string"?document.createTextNode(l):l),g.addEventListener(ht.CLICK,this.handleClick_.bind(this,n),!1);const _=document.createElement("button");_.className=a,_.setAttribute("type","button"),_.title=f,_.appendChild(typeof h=="string"?document.createTextNode(h):h),_.addEventListener(ht.CLICK,this.handleClick_.bind(this,-n),!1);const p=e+" "+pa+" "+Fh,x=this.element;x.className=p,x.appendChild(g),x.appendChild(_),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const n=this.getMap().getView();if(!n)return;const s=n.getZoom();if(s!==void 0){const a=n.getConstrainedZoom(s+t);this.duration_>0?(n.getAnimating()&&n.cancelAnimations(),n.animate({zoom:a,duration:this.duration_,easing:Ur})):n.setZoom(a)}}}function NC(r){r=r||{};const t=new An;return(r.zoom!==void 0?r.zoom:!0)&&t.push(new kC(r.zoomOptions)),(r.rotate!==void 0?r.rotate:!0)&&t.push(new FC(r.rotateOptions)),(r.attribution!==void 0?r.attribution:!0)&&t.push(new DC(r.attributionOptions)),t}const Ed={ACTIVE:"active"};class Ys extends On{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Ed.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Ed.ACTIVE,t)}setMap(t){this.map_=t}}function GC(r,t,e){const n=r.getCenterInternal();if(n){const s=[n[0]+t[0],n[1]+t[1]];r.animateInternal({duration:e!==void 0?e:250,easing:Yv,center:r.getConstrainedCenter(s)})}}function Uh(r,t,e,n){const s=r.getZoom();if(s===void 0)return;const a=r.getConstrainedZoom(s+t),l=r.getResolutionForZoom(a);r.getAnimating()&&r.cancelAnimations(),r.animate({resolution:l,anchor:e,duration:n!==void 0?n:250,easing:Ur})}class WC extends Ys{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==Yt.DBLCLICK){const n=t.originalEvent,s=t.map,a=t.coordinate,l=n.shiftKey?-this.delta_:this.delta_,h=s.getView();Uh(h,l,a,this.duration_),n.preventDefault(),e=!0}return!e}}class Us extends Ys{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==Yt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==Yt.POINTERUP){const n=this.handleUpEvent(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==Yt.POINTERDOWN){const n=this.handleDownEvent(t);this.handlingDownUpSequence=n,e=this.stopDown(n)}else t.type==Yt.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function Zh(r){const t=r.length;let e=0,n=0;for(let s=0;s<t;s++)e+=r[s].clientX,n+=r[s].clientY;return{clientX:e/t,clientY:n/t}}function fh(r){const t=arguments;return function(e){let n=!0;for(let s=0,a=t.length;s<a&&(n=n&&t[s](e),!!n);++s);return n}}const zC=function(r){const t=r.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},XC=function(r){const t=r.map.getTargetElement(),e=r.map.getOwnerDocument().activeElement;return t.contains(e)},Ig=function(r){return r.map.getTargetElement().hasAttribute("tabindex")?XC(r):!0},BC=ws,Sg=function(r){const t=r.originalEvent;return t.button==0&&!(xE&&Id&&t.ctrlKey)},Ag=function(r){const t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},YC=function(r){const t=r.originalEvent;return Id?t.metaKey:t.ctrlKey},UC=function(r){const t=r.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Lg=function(r){const t=r.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},Hl=function(r){const t=r.originalEvent;return vt(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"},ZC=function(r){const t=r.originalEvent;return vt(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0};class KC extends Us{constructor(t){super({stopDown:aa}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:fh(Ag,ZC);this.condition_=t.onFocusOnly?fh(Ig,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const n=this.targetPointers,s=e.getEventPixel(Zh(n));if(n.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const a=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],h=t.map.getView();UE(a,h.getResolution()),Rh(a,h.getRotation()),h.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=n.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,n=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),a=this.kinetic_.getAngle(),l=n.getCenterInternal(),h=e.getPixelFromCoordinateInternal(l),c=e.getCoordinateFromPixelInternal([h[0]-s*Math.cos(a),h[1]-s*Math.sin(a)]);n.animateInternal({center:n.getConstrainedCenter(c),duration:500,easing:Ur})}return this.panning_&&(this.panning_=!1,n.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const n=t.map.getView();return this.lastCentroid=null,n.getAnimating()&&n.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class VC extends Us{constructor(t){t=t||{},super({stopDown:aa}),this.condition_=t.condition?t.condition:zC,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!Hl(t))return;const e=t.map,n=e.getView();if(n.getConstraints().rotation===zh)return;const s=e.getSize(),a=t.pixel,l=Math.atan2(s[1]/2-a[1],a[0]-s[0]/2);if(this.lastAngle_!==void 0){const h=l-this.lastAngle_;n.adjustRotationInternal(-h)}this.lastAngle_=l}handleUpEvent(t){return Hl(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return Hl(t)&&Sg(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class HC extends gh{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,n="px",s=this.element_.style;s.left=Math.min(t[0],e[0])+n,s.top=Math.min(t[1],e[1])+n,s.width=Math.abs(e[0]-t[0])+n,s.height=Math.abs(e[1]-t[1])+n}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){const t=this.startPixel_,e=this.endPixel_,s=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new Is([s])}getGeometry(){return this.geometry_}}const Ko={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class ql extends Qn{constructor(t,e,n){super(t),this.coordinate=e,this.mapBrowserEvent=n}}class qC extends Us{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.box_=new HC(t.className||"ol-dragbox"),this.minArea_=t.minArea!==void 0?t.minArea:64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition?t.condition:Sg,this.boxEndCondition_=t.boxEndCondition?t.boxEndCondition:this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,n){const s=n[0]-e[0],a=n[1]-e[1];return s*s+a*a>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new ql(Ko.BOXDRAG,t.coordinate,t))}handleUpEvent(t){this.box_.setMap(null);const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new ql(e?Ko.BOXEND:Ko.BOXCANCEL,t.coordinate,t)),!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new ql(Ko.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}}class $C extends qC{constructor(t){t=t||{};const e=t.condition?t.condition:UC;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const n=this.getMap().getView();let s=this.getGeometry();if(this.out_){const a=n.rotatedExtentForGeometry(s),l=n.getResolutionForExtentInternal(a),h=n.getResolution()/l;s=s.clone(),s.scale(h*h)}n.fitInternal(s,{duration:this.duration_,easing:Ur})}}const Hi={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class jC extends Ys{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Ag(e)&&Lg(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==ht.KEYDOWN){const n=t.originalEvent,s=n.key;if(this.condition_(t)&&(s==Hi.DOWN||s==Hi.LEFT||s==Hi.RIGHT||s==Hi.UP)){const l=t.map.getView(),h=l.getResolution()*this.pixelDelta_;let c=0,f=0;s==Hi.DOWN?f=-h:s==Hi.LEFT?c=-h:s==Hi.RIGHT?c=h:f=h;const g=[c,f];Rh(g,l.getRotation()),GC(l,g,this.duration_),n.preventDefault(),e=!0}}return!e}}class JC extends Ys{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!YC(e)&&Lg(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==ht.KEYDOWN||t.type==ht.KEYPRESS){const n=t.originalEvent,s=n.key;if(this.condition_(t)&&(s==="+"||s==="-")){const a=t.map,l=s==="+"?this.delta_:-this.delta_,h=a.getView();Uh(h,l,void 0,this.duration_),n.preventDefault(),e=!0}}return!e}}class QC extends Ys{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:BC;this.condition_=t.onFocusOnly?fh(Ig,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==ht.WHEEL)return!0;const n=t.map,s=t.originalEvent;s.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let a;if(t.type==ht.WHEEL&&(a=s.deltaY,pE&&s.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(a/=Sd),s.deltaMode===WheelEvent.DOM_DELTA_LINE&&(a*=40)),a===0)return!1;this.lastDelta_=a;const l=Date.now();this.startTime_===void 0&&(this.startTime_=l),(!this.mode_||l-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?"trackpad":"wheel");const h=n.getView();if(this.mode_==="trackpad"&&!(h.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-a/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=l,!1;this.totalDelta_+=a;const c=Math.max(this.timeout_-(l-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),c),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let n=-qt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(n=n?n>0?1:-1:0),Uh(e,n,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class tR extends Us{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=aa),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const n=this.targetPointers[0],s=this.targetPointers[1],a=Math.atan2(s.clientY-n.clientY,s.clientX-n.clientX);if(this.lastAngle_!==void 0){const c=a-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=c}this.lastAngle_=a;const l=t.map,h=l.getView();h.getConstraints().rotation!==zh&&(this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(Zh(this.targetPointers))),this.rotating_&&(l.render(),h.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class eR extends Us{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=aa),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const n=this.targetPointers[0],s=this.targetPointers[1],a=n.clientX-s.clientX,l=n.clientY-s.clientY,h=Math.sqrt(a*a+l*l);this.lastDistance_!==void 0&&(e=this.lastDistance_/h),this.lastDistance_=h;const c=t.map,f=c.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(Zh(this.targetPointers))),c.render(),f.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const n=t.map.getView(),s=this.lastScaleDelta_>1?1:-1;return n.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function nR(r){r=r||{};const t=new An,e=new IC(-.005,.05,100);return(r.altShiftDragRotate!==void 0?r.altShiftDragRotate:!0)&&t.push(new VC),(r.doubleClickZoom!==void 0?r.doubleClickZoom:!0)&&t.push(new WC({delta:r.zoomDelta,duration:r.zoomDuration})),(r.dragPan!==void 0?r.dragPan:!0)&&t.push(new KC({onFocusOnly:r.onFocusOnly,kinetic:e})),(r.pinchRotate!==void 0?r.pinchRotate:!0)&&t.push(new tR),(r.pinchZoom!==void 0?r.pinchZoom:!0)&&t.push(new eR({duration:r.zoomDuration})),(r.keyboard!==void 0?r.keyboard:!0)&&(t.push(new jC),t.push(new JC({delta:r.zoomDelta,duration:r.zoomDuration}))),(r.mouseWheelZoom!==void 0?r.mouseWheelZoom:!0)&&t.push(new QC({onFocusOnly:r.onFocusOnly,duration:r.zoomDuration})),(r.shiftDragZoom!==void 0?r.shiftDragZoom:!0)&&t.push(new $C({duration:r.zoomDuration})),t}function bg(r){if(r instanceof Ea){r.setMapInternal(null);return}r instanceof Vr&&r.getLayers().forEach(bg)}function Mg(r,t){if(r instanceof Ea){r.setMapInternal(t);return}if(r instanceof Vr){const e=r.getLayers().getArray();for(let n=0,s=e.length;n<s;++n)Mg(e[n],t)}}let iR=class extends On{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=rR(t);this.renderComplete_,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Sd,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=vn(),this.pixelToCoordinateTransform_=vn(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||NC(),this.interactions=e.interactions||nR({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new OC(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(ce.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(ce.VIEW,this.handleViewChanged_),this.addChangeListener(ce.SIZE,this.handleSizeChanged_),this.addChangeListener(ce.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const n=this;t.view&&!(t.view instanceof xn)&&t.view.then(function(s){n.setView(new xn(s))}),this.controls.addEventListener(De.ADD,s=>{s.element.setMap(this)}),this.controls.addEventListener(De.REMOVE,s=>{s.element.setMap(null)}),this.interactions.addEventListener(De.ADD,s=>{s.element.setMap(this)}),this.interactions.addEventListener(De.REMOVE,s=>{s.element.setMap(null)}),this.overlays_.addEventListener(De.ADD,s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener(De.REMOVE,s=>{const a=s.element.getId();a!==void 0&&delete this.overlayIdIndex_[a.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){Mg(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,n){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(t);n=n!==void 0?n:{};const a=n.hitTolerance!==void 0?n.hitTolerance:0,l=n.layerFilter!==void 0?n.layerFilter:ws,h=n.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,a,h,e,null,l,null)}getFeaturesAtPixel(t,e){const n=[];return this.forEachFeatureAtPixel(t,function(s){n.push(s)},e),n}getAllLayers(){const t=[];function e(n){n.forEach(function(s){s instanceof Vr?e(s.getLayers()):t.push(s)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const n=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const s=e.layerFilter!==void 0?e.layerFilter:ws,a=e.hitTolerance!==void 0?e.hitTolerance:0,l=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,a,l,s,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const n=this.viewport_.getBoundingClientRect(),s=this.getSize(),a=n.width/s[0],l=n.height/s[1],h="changedTouches"in t?t.changedTouches[0]:t;return[(h.clientX-n.left)/a,(h.clientY-n.top)/l]}getTarget(){return this.get(ce.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return sh(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?ne(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(ce.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof An){e.setLayers(t);return}const n=e.getLayers();n.clear(),n.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const s=t[e];if(!s.visible)continue;const a=s.layer.getRenderer();if(a&&!a.ready)return!0;const l=s.layer.getSource();if(l&&l.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Zn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?ne(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(ce.SIZE)}getView(){return this.get(ce.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,n,s){return PC(this.frameState_,t,e,n,s)}handleBrowserEvent(t,e){e=e||t.type;const n=new Ei(e,this,t);this.handleMapBrowserEvent(n)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,n=e.type;if(n===ch.POINTERDOWN||n===ht.WHEEL||n===ht.KEYDOWN){const s=this.getOwnerDocument(),a=this.viewport_.getRootNode?this.viewport_.getRootNode():s,l=e.target;if(this.overlayContainerStopEvent_.contains(l)||!(a===s?s.documentElement:a).contains(l))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const s=this.getInteractions().getArray().slice();for(let a=s.length-1;a>=0;a--){const l=s[a];if(l.getMap()!==this||!l.getActive()||!this.getTargetElement())continue;if(!l.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let s=this.maxTilesLoading_,a=s;if(t){const l=t.viewHints;if(l[fe.ANIMATING]||l[fe.INTERACTING]){const h=Date.now()-t.time>8;s=h?0:8,a=h?0:2}}e.getTilesLoading()<s&&(e.reprioritize(),e.loadMoreTiles(s,a))}t&&this.renderer_&&!t.animate&&(this.renderComplete_===!0?(this.hasListener(bn.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(bn.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new br(vi.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new br(vi.LOADSTART,this,t))));const n=this.postRenderFunctions_;for(let s=0,a=n.length;s<a;++s)n[s](this,t);n.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let n=0,s=this.targetChangeHandlerKeys_.length;n<s;++n)zt(this.targetChangeHandlerKeys_[n]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(ht.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(ht.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,oh(this.viewport_)}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const n=this.targetElement_.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.unobserve(n.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new LC(this)),this.mapBrowserEventHandler_=new bC(this,this.moveTolerance_);for(const a in Yt)this.mapBrowserEventHandler_.addEventListener(Yt[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(ht.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(ht.WHEEL,this.boundHandleBrowserEvent_,Ld?{passive:!1}:!1);const n=this.keyboardEventTarget_?this.keyboardEventTarget_:e;this.targetChangeHandlerKeys_=[Ct(n,ht.KEYDOWN,this.handleBrowserEvent,this),Ct(n,ht.KEYPRESS,this.handleBrowserEvent,this)];const s=e.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(zt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(zt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=Ct(t,Gr.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ct(t,ht.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(zt),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Ci("addlayer",t)),this.layerGroupPropertyListenerKeys_=[Ct(t,Gr.PROPERTYCHANGE,this.render,this),Ct(t,ht.CHANGE,this.render,this),Ct(t,"addlayer",this.handleLayerAdd_,this),Ct(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,n=t.length;e<n;++e){const s=t[e].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}flushDeclutterItems(){const t=this.frameState_;t&&this.renderer_.flushDeclutterItems(t)}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){bg(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),n=this.getView(),s=this.frameState_;let a=null;if(e!==void 0&&Bf(e)&&n&&n.isDef()){const l=n.getHints(this.frameState_?this.frameState_.viewHints:void 0),h=n.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutterTree:null,extent:eh(h.center,h.resolution,h.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:h,viewHints:l,wantedTiles:{},mapId:It(this),renderTargets:{}},h.nextCenter&&h.nextResolution){const c=isNaN(h.nextRotation)?h.rotation:h.nextRotation;a.nextExtent=eh(h.nextCenter,h.nextResolution,c,e)}}this.frameState_=a,this.renderer_.renderFrame(a),a&&(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),s&&(!this.previousExtent_||!Gs(this.previousExtent_)&&!Cs(a.extent,this.previousExtent_))&&(this.dispatchEvent(new br(vi.MOVESTART,this,s)),this.previousExtent_=Ns(this.previousExtent_)),this.previousExtent_&&!a.viewHints[fe.ANIMATING]&&!a.viewHints[fe.INTERACTING]&&!Cs(a.extent,this.previousExtent_)&&(this.dispatchEvent(new br(vi.MOVEEND,this,a)),Md(a.extent,this.previousExtent_))),this.dispatchEvent(new br(vi.POSTRENDER,this,a)),this.renderComplete_=this.hasListener(vi.LOADSTART)||this.hasListener(vi.LOADEND)||this.hasListener(bn.RENDERCOMPLETE)?!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady():void 0,this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Ci("removelayer",e)),this.set(ce.LAYERGROUP,t)}setSize(t){this.set(ce.SIZE,t)}setTarget(t){this.set(ce.TARGET,t)}setView(t){if(!t||t instanceof xn){this.set(ce.VIEW,t);return}this.set(ce.VIEW,new xn);const e=this;t.then(function(n){e.setView(new xn(n))})}updateSize(){const t=this.getTargetElement();let e;if(t){const s=getComputedStyle(t),a=t.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),l=t.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth);!isNaN(a)&&!isNaN(l)&&(e=[a,l],!Bf(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&zd("No map visible because the map container's width or height are 0."))}const n=this.getSize();e&&(!n||!bi(e,n))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function rR(r){let t=null;r.keyboardEventTarget!==void 0&&(t=typeof r.keyboardEventTarget=="string"?document.getElementById(r.keyboardEventTarget):r.keyboardEventTarget);const e={},n=r.layers&&typeof r.layers.getLayers=="function"?r.layers:new Vr({layers:r.layers});e[ce.LAYERGROUP]=n,e[ce.TARGET]=r.target,e[ce.VIEW]=r.view instanceof xn?r.view:new xn;let s;r.controls!==void 0&&(Array.isArray(r.controls)?s=new An(r.controls.slice()):(vt(typeof r.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=r.controls));let a;r.interactions!==void 0&&(Array.isArray(r.interactions)?a=new An(r.interactions.slice()):(vt(typeof r.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),a=r.interactions));let l;return r.overlays!==void 0?Array.isArray(r.overlays)?l=new An(r.overlays.slice()):(vt(typeof r.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),l=r.overlays):l=new An,{controls:s,interactions:a,keyboardEventTarget:t,overlays:l,values:e}}class sR{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return vt(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return vt(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){vt(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}}function vd(r,t,e,n){return n!==void 0?(n[0]=r,n[1]=t,n[2]=e,n):[r,t,e]}function Ca(r,t,e){return r+"/"+t+"/"+e}function Og(r){return Ca(r[0],r[1],r[2])}function oR(r){return r.split("/").map(Number)}function aR(r){return(r[1]<<r[0])+r[2]}function lR(r,t){const e=r[0],n=r[1],s=r[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const a=t.getFullTileRange(e);return a?a.containsXY(n,s):!0}class Pg extends sR{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),n=oR(t)[0];this.forEach(s=>{s.tileCoord[0]!==n&&(this.remove(Og(s.tileCoord)),s.release())})}}class Kh{constructor(t,e,n,s){this.minX=t,this.maxX=e,this.minY=n,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Rr(r,t,e,n,s){return s!==void 0?(s.minX=r,s.maxX=t,s.minY=e,s.maxY=n,s):new Kh(r,t,e,n)}const Vo={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class hR extends Ea{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getPreload(){return this.get(Vo.PRELOAD)}setPreload(t){this.set(Vo.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Vo.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Vo.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}const uR=.5,cR=10,wd=.25;class fR{constructor(t,e,n,s,a,l){this.sourceProj_=t,this.targetProj_=e;let h={};const c=Rs(this.targetProj_,this.sourceProj_);this.transformInv_=function(S){const b=S[0]+"/"+S[1];return h[b]||(h[b]=c(S)),h[b]},this.maxSourceExtent_=s,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&kt(s)>=kt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?kt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?kt(this.targetProj_.getExtent()):null;const f=nr(n),g=fa(n),_=ca(n),p=ua(n),x=this.transformInv_(f),v=this.transformInv_(g),w=this.transformInv_(_),R=this.transformInv_(p),T=cR+(l?Math.max(0,Math.ceil(Math.log2(th(n)/(l*l*256*256)))):0);if(this.addQuad_(f,g,_,p,x,v,w,R,T),this.wrapsXInSource_){let S=1/0;this.triangles_.forEach(function(b,O,M){S=Math.min(S,b.source[0][0],b.source[1][0],b.source[2][0])}),this.triangles_.forEach(b=>{if(Math.max(b.source[0][0],b.source[1][0],b.source[2][0])-S>this.sourceWorldWidth_/2){const O=[[b.source[0][0],b.source[0][1]],[b.source[1][0],b.source[1][1]],[b.source[2][0],b.source[2][1]]];O[0][0]-S>this.sourceWorldWidth_/2&&(O[0][0]-=this.sourceWorldWidth_),O[1][0]-S>this.sourceWorldWidth_/2&&(O[1][0]-=this.sourceWorldWidth_),O[2][0]-S>this.sourceWorldWidth_/2&&(O[2][0]-=this.sourceWorldWidth_);const M=Math.min(O[0][0],O[1][0],O[2][0]);Math.max(O[0][0],O[1][0],O[2][0])-M<this.sourceWorldWidth_/2&&(b.source=O)}})}h={}}addTriangle_(t,e,n,s,a,l){this.triangles_.push({source:[s,a,l],target:[t,e,n]})}addQuad_(t,e,n,s,a,l,h,c,f){const g=Sf([a,l,h,c]),_=this.sourceWorldWidth_?kt(g)/this.sourceWorldWidth_:null,p=this.sourceWorldWidth_,x=this.sourceProj_.canWrapX()&&_>.5&&_<1;let v=!1;if(f>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const R=Sf([t,e,n,s]);v=kt(R)/this.targetWorldWidth_>wd||v}!x&&this.sourceProj_.isGlobal()&&_&&(v=_>wd||v)}if(!v&&this.maxSourceExtent_&&isFinite(g[0])&&isFinite(g[1])&&isFinite(g[2])&&isFinite(g[3])&&!ke(g,this.maxSourceExtent_))return;let w=0;if(!v&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1])||!isFinite(h[0])||!isFinite(h[1])||!isFinite(c[0])||!isFinite(c[1]))){if(f>0)v=!0;else if(w=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(l[0])||!isFinite(l[1])?4:0)+(!isFinite(h[0])||!isFinite(h[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),w!=1&&w!=2&&w!=4&&w!=8)return}if(f>0){if(!v){const R=[(t[0]+n[0])/2,(t[1]+n[1])/2],T=this.transformInv_(R);let S;x?S=(tr(a[0],p)+tr(h[0],p))/2-tr(T[0],p):S=(a[0]+h[0])/2-T[0];const b=(a[1]+h[1])/2-T[1];v=S*S+b*b>this.errorThresholdSquared_}if(v){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const R=[(e[0]+n[0])/2,(e[1]+n[1])/2],T=this.transformInv_(R),S=[(s[0]+t[0])/2,(s[1]+t[1])/2],b=this.transformInv_(S);this.addQuad_(t,e,R,S,a,l,T,b,f-1),this.addQuad_(S,R,n,s,b,T,h,c,f-1)}else{const R=[(t[0]+e[0])/2,(t[1]+e[1])/2],T=this.transformInv_(R),S=[(n[0]+s[0])/2,(n[1]+s[1])/2],b=this.transformInv_(S);this.addQuad_(t,R,S,s,a,T,b,c,f-1),this.addQuad_(R,e,n,S,T,l,h,b,f-1)}return}}if(x){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}w&11||this.addTriangle_(t,n,s,a,h,c),w&14||this.addTriangle_(t,n,e,a,h,l),w&&(w&13||this.addTriangle_(e,s,t,l,c,a),w&7||this.addTriangle_(e,s,n,l,c,h))}calculateSourceExtent(){const t=an();return this.triangles_.forEach(function(e,n,s){const a=e.source;Es(t,a[0]),Es(t,a[1]),Es(t,a[2])}),t}getTriangles(){return this.triangles_}}let $l;const Nr=[];function Cd(r,t,e,n,s){r.beginPath(),r.moveTo(0,0),r.lineTo(t,e),r.lineTo(n,s),r.closePath(),r.save(),r.clip(),r.fillRect(0,0,Math.max(t,n)+1,Math.max(e,s)),r.restore()}function jl(r,t){return Math.abs(r[t*4]-210)>2||Math.abs(r[t*4+3]-.75*255)>2}function dR(){if($l===void 0){const r=Se(6,6,Nr);r.globalCompositeOperation="lighter",r.fillStyle="rgba(210, 0, 0, 0.75)",Cd(r,4,5,4,0),Cd(r,4,5,0,5);const t=r.getImageData(0,0,3,3).data;$l=jl(t,0)||jl(t,4)||jl(t,8),ma(r),Nr.push(r.canvas)}return $l}function Rd(r,t,e,n){const s=Ah(e,t,r);let a=Of(t,n,e);const l=t.getMetersPerUnit();l!==void 0&&(a*=l);const h=r.getMetersPerUnit();h!==void 0&&(a/=h);const c=r.getExtent();if(!c||ha(c,s)){const f=Of(r,a,s)/a;isFinite(f)&&f>0&&(a/=f)}return a}function gR(r,t,e,n){const s=er(e);let a=Rd(r,t,s,n);return(!isFinite(a)||a<=0)&&kd(e,function(l){return a=Rd(r,t,l,n),isFinite(a)&&a>0}),a}function _R(r,t,e,n,s,a,l,h,c,f,g,_,p){const x=Se(Math.round(e*r),Math.round(e*t),Nr);if(_||(x.imageSmoothingEnabled=!1),c.length===0)return x.canvas;x.scale(e,e);function v(S){return Math.round(S*e)/e}x.globalCompositeOperation="lighter";const w=an();c.forEach(function(S,b,O){TE(w,S.extent)});let R;{const S=kt(w),b=He(w);R=Se(Math.round(e*S/n),Math.round(e*b/n),Nr),_||(R.imageSmoothingEnabled=!1);const O=e/n;c.forEach(function(M,F,z){const B=M.extent[0]-w[0],H=-(M.extent[3]-w[3]),it=kt(M.extent),gt=He(M.extent);M.image.width>0&&M.image.height>0&&R.drawImage(M.image,f,f,M.image.width-2*f,M.image.height-2*f,B*O,H*O,it*O,gt*O)})}const T=nr(l);return h.getTriangles().forEach(function(S,b,O){const M=S.source,F=S.target;let z=M[0][0],B=M[0][1],H=M[1][0],it=M[1][1],gt=M[2][0],_t=M[2][1];const ut=v((F[0][0]-T[0])/a),Gt=v(-(F[0][1]-T[1])/a),V=v((F[1][0]-T[0])/a),J=v(-(F[1][1]-T[1])/a),U=v((F[2][0]-T[0])/a),nt=v(-(F[2][1]-T[1])/a),St=z,xt=B;z=0,B=0,H-=St,it-=xt,gt-=St,_t-=xt;const Ot=[[H,it,0,0,V-ut],[gt,_t,0,0,U-ut],[0,0,H,it,J-Gt],[0,0,gt,_t,nt-Gt]],X=BE(Ot);if(!X)return;if(x.save(),x.beginPath(),dR()||!_){x.moveTo(V,J);const mt=4,Et=ut-V,Ge=Gt-J;for(let ie=0;ie<mt;ie++)x.lineTo(V+v((ie+1)*Et/mt),J+v(ie*Ge/(mt-1))),ie!=mt-1&&x.lineTo(V+v((ie+1)*Et/mt),J+v((ie+1)*Ge/(mt-1)));x.lineTo(U,nt)}else x.moveTo(V,J),x.lineTo(ut,Gt),x.lineTo(U,nt);x.clip(),x.transform(X[0],X[2],X[1],X[3],ut,Gt),x.translate(w[0]-St,w[3]-xt);let $t;if(R)$t=R.canvas,x.scale(n/e,-n/e);else{const mt=c[0],Et=mt.extent;$t=mt.image,x.scale(kt(Et)/$t.width,-He(Et)/$t.height)}x.drawImage($t,0,0),x.restore()}),R&&(ma(R),Nr.push(R.canvas)),g&&(x.save(),x.globalCompositeOperation="source-over",x.strokeStyle="black",x.lineWidth=1,h.getTriangles().forEach(function(S,b,O){const M=S.target,F=(M[0][0]-T[0])/a,z=-(M[0][1]-T[1])/a,B=(M[1][0]-T[0])/a,H=-(M[1][1]-T[1])/a,it=(M[2][0]-T[0])/a,gt=-(M[2][1]-T[1])/a;x.beginPath(),x.moveTo(B,H),x.lineTo(F,z),x.lineTo(it,gt),x.closePath(),x.stroke()}),x.restore()),x.canvas}class dh extends Rg{constructor(t,e,n,s,a,l,h,c,f,g,_,p){super(a,j.IDLE,p),this.renderEdges_=_!==void 0?_:!1,this.pixelRatio_=h,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=l||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const x=s.getTileCoordExtent(this.wrappedTileCoord_),v=this.targetTileGrid_.getExtent();let w=this.sourceTileGrid_.getExtent();const R=v?vs(x,v):x;if(th(R)===0){this.state=j.EMPTY;return}const T=t.getExtent();T&&(w?w=vs(w,T):w=T);const S=s.getResolution(this.wrappedTileCoord_[0]),b=gR(t,n,R,S);if(!isFinite(b)||b<=0){this.state=j.EMPTY;return}const O=g!==void 0?g:uR;if(this.triangulation_=new fR(t,n,R,w,b*O,S),this.triangulation_.getTriangles().length===0){this.state=j.EMPTY;return}this.sourceZ_=e.getZForResolution(b);let M=this.triangulation_.calculateSourceExtent();if(w&&(t.canWrapX()?(M[1]=qt(M[1],w[1],w[3]),M[3]=qt(M[3],w[1],w[3])):M=vs(M,w)),!th(M))this.state=j.EMPTY;else{const F=e.getTileRangeForExtentAndZ(M,this.sourceZ_);for(let z=F.minX;z<=F.maxX;z++)for(let B=F.minY;B<=F.maxY;B++){const H=f(this.sourceZ_,z,B,h);H&&this.sourceTiles_.push(H)}this.sourceTiles_.length===0&&(this.state=j.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{e&&e.getState()==j.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})}),this.sourceTiles_.length=0,t.length===0)this.state=j.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),s=typeof n=="number"?n:n[0],a=typeof n=="number"?n:n[1],l=this.targetTileGrid_.getResolution(e),h=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=_R(s,a,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),l,c,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=j.LOADED}this.changed()}load(){if(this.state==j.IDLE){this.state=j.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(e=>{const n=e.getState();if(n==j.IDLE||n==j.LOADING){t++;const s=Ct(e,ht.CHANGE,function(a){const l=e.getState();(l==j.LOADED||l==j.ERROR||l==j.EMPTY)&&(zt(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))},this);this.sourcesListenerKeys_.push(s)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function(e,n,s){e.getState()==j.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(zt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(ma(this.canvas_.getContext("2d")),Nr.push(this.canvas_),this.canvas_=null),super.release()}}class mR extends Eg{constructor(t){super(t),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=an(),this.tmpTileRange_=new Kh(0,0,0,0)}isDrawableTile(t){const e=this.getLayer(),n=t.getState(),s=e.getUseInterimTilesOnError();return n==j.LOADED||n==j.EMPTY||n==j.ERROR&&!s}getTile(t,e,n,s){const a=s.pixelRatio,l=s.viewState.projection,h=this.getLayer();let f=h.getSource().getTile(t,e,n,a,l);return f.getState()==j.ERROR&&h.getUseInterimTilesOnError()&&h.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(f)||(f=f.getInterimTile()),f}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),s=ne(e.pixelToCoordinateTransform,t.slice()),a=n.getExtent();if(a&&!ha(a,s))return null;const l=e.pixelRatio,h=e.viewState.projection,c=e.viewState,f=n.getRenderSource(),g=f.getTileGridForProjection(c.projection),_=f.getTilePixelRatio(e.pixelRatio);for(let p=g.getZForResolution(c.resolution);p>=g.getMinZoom();--p){const x=g.getTileCoordForCoordAndZ(s,p),v=f.getTile(p,x[1],x[2],l,h);if(!(v instanceof Tg||v instanceof dh)||v instanceof dh&&v.getState()===j.EMPTY)return null;if(v.getState()!==j.LOADED)continue;const w=g.getOrigin(p),R=Ve(g.getTileSize(p)),T=g.getResolution(p),S=Math.floor(_*((s[0]-w[0])/T-x[1]*R[0])),b=Math.floor(_*((w[1]-s[1])/T-x[2]*R[1])),O=Math.round(_*f.getGutterForProjection(c.projection));return this.getImageData(v.getImage(),S+O,b+O)}return null}loadedTileCallback(t,e,n){return this.isDrawableTile(n)?super.loadedTileCallback(t,e,n):!1}prepareFrame(t){return!!this.getLayer().getSource()}renderFrame(t,e){const n=t.layerStatesArray[t.layerIndex],s=t.viewState,a=s.projection,l=s.resolution,h=s.center,c=s.rotation,f=t.pixelRatio,g=this.getLayer(),_=g.getSource(),p=_.getRevision(),x=_.getTileGridForProjection(a),v=x.getZForResolution(l,_.zDirection),w=x.getResolution(v);let R=t.extent;const T=t.viewState.resolution,S=_.getTilePixelRatio(f),b=Math.round(kt(R)/T*f),O=Math.round(He(R)/T*f),M=n.extent&&$i(n.extent);M&&(R=vs(R,$i(n.extent)));const F=w*b/2/S,z=w*O/2/S,B=[h[0]-F,h[1]-z,h[0]+F,h[1]+z],H=x.getTileRangeForExtentAndZ(R,v),it={};it[v]={};const gt=this.createLoadedTileFinder(_,a,it),_t=this.tmpExtent,ut=this.tmpTileRange_;this.newTiles_=!1;const Gt=c?nh(s.center,T,c,t.size):void 0;for(let $t=H.minX;$t<=H.maxX;++$t)for(let mt=H.minY;mt<=H.maxY;++mt){if(c&&!x.tileCoordIntersectsViewport([v,$t,mt],Gt))continue;const Et=this.getTile(v,$t,mt,t);if(this.isDrawableTile(Et)){const me=It(this);if(Et.getState()==j.LOADED){it[v][Et.tileCoord.toString()]=Et;let pe=Et.inTransition(me);pe&&n.opacity!==1&&(Et.endTransition(me),pe=!1),!this.newTiles_&&(pe||!this.renderedTiles.includes(Et))&&(this.newTiles_=!0)}if(Et.getAlpha(me,t.time)===1)continue}const Ge=x.getTileCoordChildTileRange(Et.tileCoord,ut,_t);let ie=!1;Ge&&(ie=gt(v+1,Ge)),ie||x.forEachTileCoordParentTileRange(Et.tileCoord,gt,ut,_t)}const V=w/l*f/S;$n(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/f,1/f,c,-b/2,-O/2);const J=bd(this.pixelTransform);this.useContainer(e,J,this.getBackground(t));const U=this.context,nt=U.canvas;xh(this.inversePixelTransform,this.pixelTransform),$n(this.tempTransform,b/2,O/2,V,V,0,-b/2,-O/2),nt.width!=b||nt.height!=O?(nt.width=b,nt.height=O):this.containerReused||U.clearRect(0,0,b,O),M&&this.clipUnrotated(U,t,M),_.getInterpolate()||(U.imageSmoothingEnabled=!1),this.preRender(U,t),this.renderedTiles.length=0;let St=Object.keys(it).map(Number);St.sort(Si);let xt,Ot,X;n.opacity===1&&(!this.containerReused||_.getOpaque(t.viewState.projection))?St=St.reverse():(xt=[],Ot=[]);for(let $t=St.length-1;$t>=0;--$t){const mt=St[$t],Et=_.getTilePixelSize(mt,f,a),ie=x.getResolution(mt)/w,me=Et[0]*ie*V,pe=Et[1]*ie*V,ti=x.getTileCoordForCoordAndZ(nr(B),mt),Pn=x.getTileCoordExtent(ti),hn=ne(this.tempTransform,[S*(Pn[0]-B[0])/w,S*(B[3]-Pn[3])/w]),Oi=S*_.getGutterForProjection(a),Vt=it[mt];for(const un in Vt){const wn=Vt[un],Ae=wn.tileCoord,Pi=ti[1]-Ae[1],ir=Math.round(hn[0]-(Pi-1)*me),qe=ti[2]-Ae[2],ye=Math.round(hn[1]-(qe-1)*pe),Ht=Math.round(hn[0]-Pi*me),re=Math.round(hn[1]-qe*pe),We=ir-Ht,xe=ye-re,ei=v===mt,ze=ei&&wn.getAlpha(It(this),t.time)!==1;let Ee=!1;if(!ze)if(xt){X=[Ht,re,Ht+We,re,Ht+We,re+xe,Ht,re+xe];for(let Cn=0,ni=xt.length;Cn<ni;++Cn)if(v!==mt&&mt<Ot[Cn]){const jt=xt[Cn];ke([Ht,re,Ht+We,re+xe],[jt[0],jt[3],jt[4],jt[7]])&&(Ee||(U.save(),Ee=!0),U.beginPath(),U.moveTo(X[0],X[1]),U.lineTo(X[2],X[3]),U.lineTo(X[4],X[5]),U.lineTo(X[6],X[7]),U.moveTo(jt[6],jt[7]),U.lineTo(jt[4],jt[5]),U.lineTo(jt[2],jt[3]),U.lineTo(jt[0],jt[1]),U.clip())}xt.push(X),Ot.push(mt)}else U.clearRect(Ht,re,We,xe);this.drawTileImage(wn,t,Ht,re,We,xe,Oi,ei),xt&&!ze?(Ee&&U.restore(),this.renderedTiles.unshift(wn)):this.renderedTiles.push(wn),this.updateUsedTiles(t.usedTiles,_,wn)}}return this.renderedRevision=p,this.renderedResolution=w,this.extentChanged=!this.renderedExtent_||!Cs(this.renderedExtent_,B),this.renderedExtent_=B,this.renderedPixelRatio=f,this.renderedProjection=a,this.manageTilePyramid(t,_,x,f,a,R,v,g.getPreload()),this.scheduleExpireCache(t,_),this.postRender(U,t),n.extent&&U.restore(),U.imageSmoothingEnabled=!0,J!==nt.style.transform&&(nt.style.transform=J),this.container}drawTileImage(t,e,n,s,a,l,h,c){const f=this.getTileImage(t);if(!f)return;const g=It(this),_=e.layerStatesArray[e.layerIndex],p=_.opacity*(c?t.getAlpha(g,e.time):1),x=p!==this.context.globalAlpha;x&&(this.context.save(),this.context.globalAlpha=p),this.context.drawImage(f,h,h,f.width-2*h,f.height-2*h,n,s,a,l),x&&this.context.restore(),p!==_.opacity?e.animate=!0:c&&t.endTransition(g)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}scheduleExpireCache(t,e){if(e.canExpireCache()){const n=(function(s,a,l){const h=It(s);h in l.usedTiles&&s.expireCache(l.viewState.projection,l.usedTiles[h])}).bind(null,e);t.postRenderFunctions.push(n)}}updateUsedTiles(t,e,n){const s=It(e);s in t||(t[s]={}),t[s][n.getKey()]=!0}manageTilePyramid(t,e,n,s,a,l,h,c,f){const g=It(e);g in t.wantedTiles||(t.wantedTiles[g]={});const _=t.wantedTiles[g],p=t.tileQueue,x=n.getMinZoom(),v=t.viewState.rotation,w=v?nh(t.viewState.center,t.viewState.resolution,v,t.size):void 0;let R=0,T,S,b,O,M,F;for(F=x;F<=h;++F)for(S=n.getTileRangeForExtentAndZ(l,F,S),b=n.getResolution(F),O=S.minX;O<=S.maxX;++O)for(M=S.minY;M<=S.maxY;++M)v&&!n.tileCoordIntersectsViewport([F,O,M],w)||(h-F<=c?(++R,T=e.getTile(F,O,M,s,a),T.getState()==j.IDLE&&(_[T.getKey()]=!0,p.isKeyQueued(T.getKey())||p.enqueue([T,g,n.getTileCoordCenter(T.tileCoord),b])),f!==void 0&&f(T)):e.useTile(F,O,M,a));e.updateCacheSize(R,a)}}class pR extends hR{constructor(t){super(t)}createRenderer(){return new mR(this)}}const Jl={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},Tr=[0,0,0],xi=5;class Dg{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,vt(dE(this.resolutions_,(s,a)=>a-s),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let s=0,a=this.resolutions_.length-1;s<a;++s)if(!e)e=this.resolutions_[s]/this.resolutions_[s+1];else if(this.resolutions_[s]/this.resolutions_[s+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,vt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const n=t.extent;n!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=nr(n)),vt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,vt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Nh,vt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=n!==void 0?n:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((s,a)=>{const l=new Kh(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(n){const h=this.getTileRangeForExtentAndZ(n,a);l.minX=Math.max(h.minX,l.minX),l.maxX=Math.min(h.maxX,l.maxX),l.minY=Math.max(h.minY,l.minY),l.maxY=Math.min(h.maxY,l.maxY)}return l}):n&&this.calculateTileRanges_(n)}forEachTileCoord(t,e,n){const s=this.getTileRangeForExtentAndZ(t,e);for(let a=s.minX,l=s.maxX;a<=l;++a)for(let h=s.minY,c=s.maxY;h<=c;++h)n([e,a,h])}forEachTileCoordParentTileRange(t,e,n,s){let a,l,h,c=null,f=t[0]-1;for(this.zoomFactor_===2?(l=t[1],h=t[2]):c=this.getTileCoordExtent(t,s);f>=this.minZoom;){if(l!==void 0&&h!==void 0?(l=Math.floor(l/2),h=Math.floor(h/2),a=Rr(l,l,h,h,n)):a=this.getTileRangeForExtentAndZ(c,f,n),e(f,a))return!0;--f}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,n){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const a=t[1]*2,l=t[2]*2;return Rr(a,a+1,l,l+1,e)}const s=this.getTileCoordExtent(t,n||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,n){if(e>this.maxZoom||e<this.minZoom)return null;const s=t[0],a=t[1],l=t[2];if(e===s)return Rr(a,l,a,l,n);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,e-s),f=Math.floor(a*c),g=Math.floor(l*c);if(e<s)return Rr(f,f,g,g,n);const _=Math.floor(c*(a+1))-1,p=Math.floor(c*(l+1))-1;return Rr(f,_,g,p,n)}const h=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(h,e,n)}getTileRangeForExtentAndZ(t,e,n){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Tr);const s=Tr[1],a=Tr[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Tr);const l=Tr[1],h=Tr[2];return Rr(s,l,a,h,n)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),n=this.getResolution(t[0]),s=Ve(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*s[0]*n,e[1]-(t[2]+.5)*s[1]*n]}getTileCoordExtent(t,e){const n=this.getOrigin(t[0]),s=this.getResolution(t[0]),a=Ve(this.getTileSize(t[0]),this.tmpSize_),l=n[0]+t[1]*a[0]*s,h=n[1]-(t[2]+1)*a[1]*s,c=l+a[0]*s,f=h+a[1]*s;return jn(l,h,c,f,e)}getTileCoordForCoordAndResolution(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)}getTileCoordForXYAndResolution_(t,e,n,s,a){const l=this.getZForResolution(n),h=n/this.getResolution(l),c=this.getOrigin(l),f=Ve(this.getTileSize(l),this.tmpSize_);let g=h*(t-c[0])/n/f[0],_=h*(c[1]-e)/n/f[1];return s?(g=zo(g,xi)-1,_=zo(_,xi)-1):(g=Wo(g,xi),_=Wo(_,xi)),vd(l,g,_,a)}getTileCoordForXYAndZ_(t,e,n,s,a){const l=this.getOrigin(n),h=this.getResolution(n),c=Ve(this.getTileSize(n),this.tmpSize_);let f=(t-l[0])/h/c[0],g=(l[1]-e)/h/c[1];return s?(f=zo(f,xi)-1,g=zo(g,xi)-1):(f=Wo(f,xi),g=Wo(g,xi)),vd(n,f,g,a)}getTileCoordForCoordAndZ(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const n=_h(this.resolutions_,t,e||0);return qt(n,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Jd(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,n=new Array(e);for(let s=this.minZoom;s<e;++s)n[s]=this.getTileRangeForExtentAndZ(t,s);this.fullTileRanges_=n}}function Fg(r){let t=r.getDefaultTileGrid();return t||(t=vR(r),r.setDefaultTileGrid(t)),t}function yR(r,t,e){const n=t[0],s=r.getTileCoordCenter(t),a=Vh(e);if(!ha(a,s)){const l=kt(a),h=Math.ceil((a[0]-s[0])/l);return s[0]+=l*h,r.getTileCoordForCoordAndZ(s,n)}return t}function xR(r,t,e,n){n=n!==void 0?n:"top-left";const s=kg(r,t,e);return new Dg({extent:r,origin:SE(r,n),resolutions:s,tileSize:e})}function ER(r){const t=r||{},e=t.extent||ln("EPSG:3857").getExtent(),n={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:kg(e,t.maxZoom,t.tileSize,t.maxResolution)};return new Dg(n)}function kg(r,t,e,n){t=t!==void 0?t:kv,e=Ve(e!==void 0?e:Nh);const s=He(r),a=kt(r);n=n>0?n:Math.max(a/e[0],s/e[1]);const l=t+1,h=new Array(l);for(let c=0;c<l;++c)h[c]=n/Math.pow(2,c);return h}function vR(r,t,e,n){const s=Vh(r);return xR(s,t,e,n)}function Vh(r){r=ln(r);let t=r.getExtent();if(!t){const e=180*wh.degrees/r.getMetersPerUnit();t=jn(-e,-e,e,e)}return t}class wR extends Cg{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.opaque_=t.opaque!==void 0?t.opaque:!1,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Ve(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new Pg(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const n=this.getTileCacheForProjection(t);n&&n.expireCache(e)}forEachLoadedTile(t,e,n,s){const a=this.getTileCacheForProjection(t);if(!a)return!1;let l=!0,h,c,f;for(let g=n.minX;g<=n.maxX;++g)for(let _=n.minY;_<=n.maxY;++_)c=Ca(e,g,_),f=!1,a.containsKey(c)&&(h=a.get(c),f=h.getState()===j.LOADED,f&&(f=s(h)!==!1)),f||(l=!1);return l}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getOpaque(t){return this.opaque_}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,n,s,a){return wt()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:Fg(t)}getTileCacheForProjection(t){const e=this.getProjection();return vt(e===null||Ir(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,n){const s=this.getTileGridForProjection(n),a=this.getTilePixelRatio(e),l=Ve(s.getTileSize(t),this.tmpSize);return a==1?l:yv(l,a,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const n=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=yR(n,t,e)),lR(t,n)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(t,e){const n=this.getTileCacheForProjection(e);t>n.highWaterMark&&(n.highWaterMark=t)}useTile(t,e,n,s){}}class CR extends Qn{constructor(t,e){super(t),this.tile=e}}function RR(r,t){const e=/\{z\}/g,n=/\{x\}/g,s=/\{y\}/g,a=/\{-y\}/g;return function(l,h,c){if(l)return r.replace(e,l[0].toString()).replace(n,l[1].toString()).replace(s,l[2].toString()).replace(a,function(){const f=l[0],g=t.getFullTileRange(f);if(!g)throw new Error("The {-y} placeholder requires a tile grid with extent");return(g.getHeight()-l[2]-1).toString()})}}function TR(r,t){const e=r.length,n=new Array(e);for(let s=0;s<e;++s)n[s]=RR(r[s],t);return IR(n)}function IR(r){return r.length===1?r[0]:function(t,e,n){if(!t)return;const s=aR(t),a=tr(s,r.length);return r[a](t,e,n)}}function SR(r){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(r);if(e){const n=e[1].charCodeAt(0),s=e[2].charCodeAt(0);let a;for(a=n;a<=s;++a)t.push(r.replace(e[0],String.fromCharCode(a)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(r),e){const n=parseInt(e[2],10);for(let s=parseInt(e[1],10);s<=n;s++)t.push(r.replace(e[0],s.toString()));return t}return t.push(r),t}class Hh extends wR{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Hh.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,n=It(e),s=e.getState();let a;s==j.LOADING?(this.tileLoadingKeys_[n]=!0,a=Jl.TILELOADSTART):n in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[n],a=s==j.ERROR?Jl.TILELOADERROR:s==j.LOADED?Jl.TILELOADEND:void 0),a!=null&&this.dispatchEvent(new CR(a,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=SR(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(TR(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,n){}useTile(t,e,n){const s=Ca(t,e,n);this.tileCache.containsKey(s)&&this.tileCache.get(s)}}class AR extends Hh{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:LR,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:Tg,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(const s in this.tileCacheForProjection){const a=this.tileCacheForProjection[s];a.expireCache(a==n?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!Ir(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getOpaque(t){return this.getProjection()&&t&&!Ir(this.getProjection(),t)?!1:super.getOpaque(t)}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||Ir(e,t)))return this.tileGrid;const n=It(t);return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Fg(t)),this.tileGridForProjection[n]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||Ir(e,t))return this.tileCache;const n=It(t);return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Pg(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]}createTile_(t,e,n,s,a,l){const h=[t,e,n],c=this.getTileCoordForTileUrlFunction(h,a),f=c?this.tileUrlFunction(c,s,a):void 0,g=new this.tileClass(h,f!==void 0?j.IDLE:j.EMPTY,f!==void 0?f:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return g.key=l,g.addEventListener(ht.CHANGE,this.handleTileChange.bind(this)),g}getTile(t,e,n,s,a){const l=this.getProjection();if(!l||!a||Ir(l,a))return this.getTileInternal(t,e,n,s,l||a);const h=this.getTileCacheForProjection(a),c=[t,e,n];let f;const g=Og(c);h.containsKey(g)&&(f=h.get(g));const _=this.getKey();if(f&&f.key==_)return f;const p=this.getTileGridForProjection(l),x=this.getTileGridForProjection(a),v=this.getTileCoordForTileUrlFunction(c,a),w=new dh(l,p,a,x,c,v,this.getTilePixelRatio(s),this.getGutter(),(R,T,S,b)=>this.getTileInternal(R,T,S,b,l),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return w.key=_,f?(w.interimTile=f,w.refreshInterimChain(),h.replace(g,w)):h.set(g,w),w}getTileInternal(t,e,n,s,a){let l=null;const h=Ca(t,e,n),c=this.getKey();if(!this.tileCache.containsKey(h))l=this.createTile_(t,e,n,s,a,c),this.tileCache.set(h,l);else if(l=this.tileCache.get(h),l.key!=c){const f=l;l=this.createTile_(t,e,n,s,a,c),f.getState()==j.IDLE?l.interimTile=f.interimTile:l.interimTile=f,l.refreshInterimChain(),this.tileCache.replace(h,l)}return l}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const n=ln(t);if(n){const s=It(n);s in this.tileGridForProjection||(this.tileGridForProjection[s]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function LR(r,t){r.getImage().src=t}class bR extends AR{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",n=t.tileGrid!==void 0?t.tileGrid:ER({extent:Vh(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,opaque:t.opaque,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:n,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const MR='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class OR extends bR{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[MR];const n=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",s=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:n,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,opaque:t.opaque!==void 0?t.opaque:!0,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:s,wrapX:t.wrapX,zDirection:t.zDirection})}}const PR={class:"map-container"},DR=iE({__name:"Map",props:{center:{default:()=>({lat:34.0522,lng:-118.2437})},zoom:{default:10},minZoom:{default:1},maxZoom:{default:19},pins:{default:()=>[]},disableControls:{type:Boolean,default:!1},nonInteractive:{type:Boolean,default:!1}},emits:["update:center","update:zoom","view-change","bounds-change","map-click","pin-click"],setup(r,{emit:t}){const e=rE("mapEl"),n=wf(null),s=wf(null),a=r,l=t,h=()=>{n.value&&n.value.setView(new xn({center:[a.center.lng,a.center.lat],zoom:a.zoom}))},c=uE.debounce(w=>{const R=w.getCenter(),T=w.getZoom();if(!R||T==null)return;const S=Df(R),b={lat:S[1],lng:S[0]};l("update:center",b),l("update:zoom",T),l("view-change",{center:b,zoom:T}),f(w)},250),f=w=>{const R=w.calculateExtent(),[T,S,b,O]=$E(R,"EPSG:3857","EPSG:4326");l("bounds-change",{west:T,south:S,east:b,north:O})},g=new xC({source:new RC,zIndex:10,renderOrder:(w,R)=>{const T=w.getGeometry(),S=R.getGeometry();if(!T||!S)return 0;const b=T.getCoordinates();return S.getCoordinates()[1]-b[1]}}),_=(w,R,T=!1)=>{const S=R!=null;let b="";S&&(b=`<text x="16" y="21" text-anchor="middle" font-size="16" fill="${w}" font-family="Arial" font-weight="bold">${R}</text>`);const O=T?.4:.2,M=T?8:4,F=T?-2:0;return`data:image/svg+xml;charset=utf-8,${encodeURIComponent(`
      <svg width="32" height="44" viewBox="-2 -2 34 46" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
            <feDropShadow dx="0" dy="${2+(T?2:0)}" stdDeviation="${M}" flood-opacity="${O}"/>
          </filter>
        </defs>
        <g transform="translate(0, ${F})" style="transition: transform 0.2s ease-out;">
          <path d="M16 0C7.163 0 0 7.163 0 16c0 16 16 24 16 24s16-8 16-24C32 7.163 24.837 0 16 0z" 
                fill="${w}" filter="url(#shadow)"/>
          <circle cx="16" cy="16" r="${S?12:6}" fill="white"/>
          ${b}
        </g>
      </svg>
    `)}`},p=(w,R)=>new qn({image:new Yr({src:_(w,R,!0),scale:1.1,anchor:[.5,1]})}),x=(w,R)=>new qn({image:new Yr({src:_(w,R,!1),scale:1,anchor:[.5,1]})}),v=()=>{const w=g.getSource();if(!w)return;const R=a.pins.map(T=>{const S=new ph({geometry:new da(kl([T.lng,T.lat])),index:T.index,pinData:T}),b=x(T.color,T.index),O=p(T.color,T.index);return S.setStyle(b),S.set("normalStyle",b),S.set("hoverStyle",O),S});w.clear(),w.addFeatures(R)};return Cf(()=>a.pins,v),Cf(()=>a.center,w=>{n.value&&n.value.getView().animate({center:kl([w.lng,w.lat]),duration:500})}),sE(()=>{if(!e.value){console.error("Map element is not available");return}console.log("Initializing map with center:",[a.center.lng,a.center.lat],a.zoom);const w=new xn({center:kl([a.center.lng,a.center.lat]),zoom:a.zoom,minZoom:a.minZoom,maxZoom:a.maxZoom,projection:"EPSG:3857"});v(),w.on("change:center",()=>c(w)),w.on("change:resolution",()=>c(w)),n.value=new iR({target:e.value,layers:[new pR({source:new OR}),g],view:w,controls:a.disableControls?[]:void 0,interactions:a.nonInteractive?[]:void 0}),f(w),n.value.on("pointermove",R=>{var S,b,O;const T=(S=n.value)==null?void 0:S.forEachFeatureAtPixel(R.pixel,M=>M);if(T&&T.get&&T.get("pinData")){const M=T;if(s.value!==M){if(s.value){const z=s.value.get("normalStyle");z&&s.value.setStyle(z)}s.value=M;const F=M.get("hoverStyle");if(F&&M.setStyle(F),(b=n.value)!=null&&b.getTarget()){const z=n.value.getTarget();z.style.cursor="pointer"}}}else if(s.value){const M=s.value.get("normalStyle");if(M&&s.value.setStyle(M),s.value=null,(O=n.value)!=null&&O.getTarget()){const F=n.value.getTarget();F.style.cursor="default"}}}),n.value.on("singleclick",R=>{var M;const T=R.coordinate,[S,b]=Df(T),O=(M=n.value)==null?void 0:M.forEachFeatureAtPixel(R.pixel,F=>F);if(O&&O.get&&O.get("pinData")){const F=O.get("pinData");l("pin-click",F)}else l("map-click",{lat:b,lng:S})})}),oE(()=>{var w;(w=n.value)!=null&&w.setTarget&&(n.value.setTarget(void 0),n.value=null)}),(w,R)=>(lE(),aE("div",PR,[Fl("div",{ref_key:"mapEl",ref:e,class:"map"},null,512),Fl("div",{class:"controls"},[Fl("button",{onClick:h,class:"btn btn-secondary"},"Reset View")])]))}}),GR=hE(DR,[["__scopeId","data-v-95e1902c"]]);export{GR as M,uE as l};
//# sourceMappingURL=Map-Cr7WoUv5.js.map
