import{d as w,k as L,l as U,A as y,e as V,c as r,a as t,n as E,p as A,q as g,v as k,h as m,t as c,P as h,F as N,C as D,j as d,I as b,B as v,w as C,g as I,o as i,_ as S}from"./index-Cwfaiojx.js";import{useAlertsStore as O}from"./alerts-C5XLbTOi.js";import{C as R}from"./constants-DDm60LNs.js";import{L as T}from"./LocationSelector-569OudmH.js";import{u as j}from"./location-2vzTZ4MP.js";import"./Map-CKaJgrhF.js";import"./Text.vue_vue_type_script_setup_true_lang-Cv6843iF.js";const q={class:"alert-form"},G=["disabled"],z={for:"alert-radius",class:"block text-sm font-medium text-gray-700 mb-2"},H=["disabled"],P={class:"flex justify-between text-xs text-gray-500 mt-1"},Y={key:0},J={key:1},K={key:2},Q={key:3},W={class:"space-y-2"},X={class:"flex items-center"},Z=["disabled"],ee=["onUpdate:modelValue","value","disabled"],te={class:"ml-2 text-sm text-gray-700"},se={key:0,class:"error-message"},ae={class:"form-actions"},oe=w({__name:"AlertForm",props:{alert:{default:null},loading:{type:Boolean,default:!1},useMiles:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(_,{emit:n}){const o=_,p=n,u=j(),f=L(""),e=U({name:"",location:{lng:-118.2437,lat:34.0522},radius_meters:5e3,category:""}),M=y(()=>!!o.alert),F=y(()=>{if(o.useMiles){const a=e.radius_meters*621371e-9;return a<1?`${Math.round(e.radius_meters*3.28084)}ft`:`${a.toFixed(1)}mi`}else{const a=e.radius_meters/1e3;return a<1?`${e.radius_meters}m`:`${a.toFixed(1)}km`}}),x=y(()=>e.name.trim().length>0&&e.location.lat!==0&&e.location.lng!==0&&e.radius_meters>=500&&e.radius_meters<=5e4),$=()=>{if(!x.value)return;f.value="";const a={name:e.name.trim(),location:e.location,radius_meters:e.radius_meters,category:e.category||void 0};p("submit",a)};return V(async()=>{o.alert?(e.name=o.alert.name,e.location={...o.alert.location},e.radius_meters=o.alert.radius_meters,e.category=o.alert.category||""):u.creationLocation&&(e.location={...u.creationLocation})}),(a,s)=>(i(),r("div",q,[t("form",{onSubmit:E($,["prevent"]),class:"space-y-6"},[t("div",null,[s[4]||(s[4]=t("label",{for:"alert-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Alert Name ",-1)),g(t("input",{id:"alert-name","onUpdate:modelValue":s[0]||(s[0]=l=>e.name=l),type:"text",required:"",placeholder:"e.g. 'Downtown alerts' or 'Help needed in my area'",class:"input",disabled:a.loading},null,8,G),[[k,e.name]]),s[5]||(s[5]=t("p",{class:"mt-1 text-sm text-gray-500"}," Give your alert a descriptive name to help you identify it later. ",-1))]),t("div",null,[s[6]||(s[6]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Location ",-1)),m(T,{modelValue:e.location,"onUpdate:modelValue":s[1]||(s[1]=l=>e.location=l),disabled:a.loading,class:"mb-2"},null,8,["modelValue","disabled"]),s[7]||(s[7]=t("p",{class:"text-sm text-gray-500"},"Set the center point for your alert area.",-1))]),t("div",null,[t("label",z," Alert Radius: "+c(F.value),1),g(t("input",{id:"alert-radius","onUpdate:modelValue":s[2]||(s[2]=l=>e.radius_meters=l),type:"range",min:"500",max:"50000",step:"500",class:"slider",disabled:a.loading},null,8,H),[[k,e.radius_meters,void 0,{number:!0}]]),t("div",P,[o.useMiles?(i(),r("span",Y,"1640ft")):(i(),r("span",J,"500m")),o.useMiles?(i(),r("span",K,"31mi")):(i(),r("span",Q,"50km"))]),s[8]||(s[8]=t("p",{class:"mt-1 text-sm text-gray-500"}," You'll be notified about new listings within this distance from your location. ",-1))]),t("div",null,[s[10]||(s[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"}," Category Filter (Optional) ",-1)),t("div",W,[t("label",X,[g(t("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>e.category=l),type:"radio",value:"",class:"radio",disabled:a.loading},null,8,Z),[[h,e.category]]),s[9]||(s[9]=t("span",{class:"ml-2 text-sm text-gray-700"},"All categories",-1))]),(i(!0),r(N,null,D(d(R),l=>(i(),r("label",{key:l.value,class:"flex items-center"},[g(t("input",{"onUpdate:modelValue":B=>e.category=B,type:"radio",value:l.value,class:"radio",disabled:a.loading},null,8,ee),[[h,e.category]]),t("span",te,c(l.label),1)]))),128))]),s[11]||(s[11]=t("p",{class:"mt-1 text-sm text-gray-500"}," Only get notified about listings in specific categories, or leave unselected for all. ",-1))]),f.value?(i(),r("div",se,[m(d(b),{icon:"tabler:alert-triangle",class:"error-icon"}),t("span",null,c(f.value),1)])):A("",!0),t("div",ae,[m(v,{loading:a.loading,disabled:!x.value},{default:C(()=>[I(c(M.value?"Update Alert":"Create Alert"),1)]),_:1},8,["loading","disabled"])])],32)]))}}),le=S(oe,[["__scopeId","data-v-b08f5652"]]),re={class:"form-section"},ie={class:"form-header"},ne={key:0,class:"error-banner"},de=w({__name:"AlertCreateView",setup(_){const n=O(),o=async p=>{try{await n.createAlert(p)}catch{}};return V(()=>{n.clearError()}),(p,u)=>(i(),r("div",null,[t("div",re,[t("div",ie,[m(v,{variant:"ghost",link:{name:"alerts"},class:"hover:bg-gray-100 mr-3"},{default:C(()=>[m(d(b),{icon:"tabler:chevron-left",class:"w-6 h-6 text-gray-500"})]),_:1}),u[0]||(u[0]=t("h2",{class:"form-title grow"},"Create New Alert",-1))]),m(le,{loading:d(n).loading,useMiles:!0,onSubmit:o},null,8,["loading"])]),d(n).error?(i(),r("div",ne,[m(d(b),{icon:"tabler:alert-triangle",class:"error-icon"}),t("span",null,c(d(n).error),1),m(v,{variant:"ghost",size:"sm","icon-left":"tabler:x",onClick:d(n).clearError,class:"error-close"},null,8,["onClick"])])):A("",!0)]))}}),be=S(de,[["__scopeId","data-v-c8066913"]]);export{be as default};
//# sourceMappingURL=AlertCreateView-B0BBYTCo.js.map
