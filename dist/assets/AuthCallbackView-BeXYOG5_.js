import{d as c,u as l,e as m,y as t,x as h,c as p,a as i,h as d,r as f,o as _}from"./index-BGnEo6Zc.js";const g={class:"min-h-screen bg-gray-50 flex items-center justify-center"},x={class:"text-center"},k=c({__name:"AuthCallbackView",setup(y){const s=h(),u=l();return m(async()=>{try{const{data:e,error:r}=await t.auth.getSession();if(r){console.error("Auth callback error:",r),s.push("/auth");return}if(e.session){const{data:a,error:o}=await t.from("users").select("*").eq("id",e.session.user.id).maybeSingle();if(o){console.error("Error checking profile:",o),s.push("/auth");return}if(!a){const{error:n}=await t.from("users").insert([{id:e.session.user.id,email:e.session.user.email,full_name:e.session.user.user_metadata.full_name||e.session.user.user_metadata.name||"",avatar_url:e.session.user.user_metadata.avatar_url}]);if(n){console.error("Error creating profile:",n),s.push("/auth");return}}await u.fetchUserProfile(e.session.user.id),s.push("/requests")}else s.push("/auth")}catch(e){console.error("Auth callback error:",e),s.push("/auth")}}),(e,r)=>{const a=f("Icon");return _(),p("div",g,[i("div",x,[d(a,{name:"svg-spinners:bars-scale",class:"w-12 h-12 mx-auto text-secondary-600 animate-spin"}),r[0]||(r[0]=i("p",{class:"mt-4 text-gray-600"},"Completing sign in...",-1))])])}}});export{k as default};
//# sourceMappingURL=AuthCallbackView-BeXYOG5_.js.map
