import{M as h,y,d as f,A as w,c as l,F as v,p as m,q as A,g as b,t as k,U as C,a as E,K as F,E as M,n as L,o as c}from"./index-Cwfaiojx.js";const{info:s,warn:d}=h("Location"),P={latitude:34.0522,longitude:-118.2437,city:"Los Angeles",country:"United States",countryCode:"US",timeZone:"America/Los_Angeles",accuracy:"low",source:"fallback"};class u{static async getCurrentPosition(){try{return await u.getGpsPosition()}catch(t){d("GPS location failed, trying approximation:",t);try{return await u.getApproxPosition()}catch(o){return d("IP location also failed:",o),d("All location methods failed, using default location"),P}}}static async getGpsPosition(){if(s("Attempting to get GPS location..."),!navigator.geolocation)throw new Error("Geolocation is not supported by this browser");const t=await new Promise((o,a)=>{navigator.geolocation.getCurrentPosition(o,a,{enableHighAccuracy:!0,timeout:1e4,maximumAge:5*60*1e3})});return s("GPS location successful:",t.coords),{latitude:t.coords.latitude,longitude:t.coords.longitude,city:"Current Location",country:"Unknown",countryCode:"Unknown",timeZone:Intl.DateTimeFormat().resolvedOptions().timeZone,accuracy:"high",source:"gps"}}static async getApproxPosition(){s("Getting approximate location...");const{data:t,error:o}=await y.functions.invoke("get-user-location");if(o)throw new Error(`Supabase function failed: ${o}`);if(!t)throw new Error("No data received from Supabase function");if(!t.latitude||!t.longitude)throw new Error("Invalid response: Missing latitude or longitude data");const a=parseFloat(t.latitude),e=parseFloat(t.longitude);if(isNaN(a)||isNaN(e))throw new Error("Invalid response: Latitude or longitude is not a valid number");if(a<-90||a>90)throw new Error("Invalid response: Latitude out of valid range (-90 to 90)");if(e<-180||e>180)throw new Error("Invalid response: Longitude out of valid range (-180 to 180)");return s("Supabase location successful:",t),{latitude:a,longitude:e,city:t.city||"Unknown",country:t.country||"Unknown",countryCode:t.countryCode||"Unknown",timeZone:t.timeZone||Intl.DateTimeFormat().resolvedOptions().timeZone,accuracy:"medium",source:"ip"}}static calculateDistance(t,o,a,e){const i=this.toRadians(a-t),r=this.toRadians(e-o),p=Math.sin(i/2)*Math.sin(i/2)+Math.cos(this.toRadians(t))*Math.cos(this.toRadians(a))*Math.sin(r/2)*Math.sin(r/2);return 3959*(2*Math.atan2(Math.sqrt(p),Math.sqrt(1-p)))}static toRadians(t){return t*(Math.PI/180)}static async geocodeAddress(t){const o=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}&limit=1`,a=await fetch(o,{headers:{Accept:"application/json","User-Agent":"KindrApp/1.0 (contact@kindr.net)"}});if(!a.ok)throw new Error("Failed to geocode address");const e=await a.json();if(!e||!e[0])throw new Error("No results found for address");return{latitude:parseFloat(e[0].lat),longitude:parseFloat(e[0].lon),formatted_address:e[0].display_name}}static async reverseGeocode(t,o){const a=`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${o}`,e=await fetch(a,{headers:{Accept:"application/json","User-Agent":"KindrApp/1.0 (contact@kindr.net)"}});return e.ok?(await e.json()).display_name||`${t.toFixed(4)}, ${o.toFixed(4)}`:`${t.toFixed(4)}, ${o.toFixed(4)}`}static filterRequestsByLocation(t,o){return t.filter(a=>this.calculateDistance(o.latitude,o.longitude,a.location.latitude,a.location.longitude)<=o.radius)}}const U=["for"],$={key:0,class:"text-error-600"},I=["id","type","placeholder","required"],R=f({__name:"Text",props:{modelValue:{},label:{},id:{},placeholder:{},required:{type:Boolean},type:{default:"text"},inputClass:{}},emits:["update:modelValue","input","enter"],setup(g,{emit:t}){const o=g,a=t,e=w({get:()=>o.modelValue,set:n=>a("update:modelValue",n)});return(n,i)=>(c(),l(v,null,[n.label?(c(),l("label",{key:0,for:n.id,class:"block text-sm font-medium text-gray-700 mb-2"},[b(k(n.label),1),n.required?(c(),l("span",$,"*")):m("",!0)],8,U)):m("",!0),A(E("input",{id:n.id,"onUpdate:modelValue":i[0]||(i[0]=r=>e.value=r),type:n.type,placeholder:n.placeholder,required:n.required,class:M(["input",n.inputClass]),onInput:i[1]||(i[1]=r=>n.$emit("input",e.value)),onKeydown:i[2]||(i[2]=F(L(r=>n.$emit("enter",e.value),["prevent"]),["enter"]))},null,42,I),[[C,e.value]])],64))}});export{u as L,R as _};
//# sourceMappingURL=Text.vue_vue_type_script_setup_true_lang-Cv6843iF.js.map
