import{d as z,u as q,O as M,k as f,z as m,e as j,c as i,p as v,h as r,a as t,j as c,I as g,t as n,w,x as G,B as x,F as B,A as F,C as Y,D as T,g as y,s as H,o as l,_ as J}from"./index-WKext-pH.js";import{C as L,D as K}from"./constants-DDm60LNs.js";import{u as Q}from"./listings-D5iJdAXG.js";import{M as W}from"./Map-Cr7WoUv5.js";import{L as X}from"./ListingPills-BMTqgBnq.js";const Z={class:"listing-show-container"},ss={key:0,class:"loading-state"},ts={key:1,class:"error-state"},es={key:2,class:"listing-content"},as={class:"mobile-header"},is={key:0,class:"image-gallery"},ls=["src","alt"],os={key:0,class:"image-nav"},ns=["onClick"],rs={key:1,class:"image-counter"},cs={class:"content-grid"},us={class:"main-content"},ds={class:"listing-header"},vs={class:"category-info"},_s={class:"subcategory-text"},gs={class:"listing-title"},ms={class:"status-row"},hs={class:"date-info"},ps={class:"description-section"},fs={class:"description-content"},ys={class:"pills-section"},bs={key:0,class:"skills-section"},ks={class:"skills-list"},Cs={class:"sidebar"},ws={class:"map-section"},xs={class:"map-container"},Ls={class:"location-info"},Ss={class:"details-card"},Ds={class:"details-list"},Is={key:0,class:"detail-row"},Bs={class:"detail-content"},Fs={class:"detail-value"},Ts={key:1,class:"detail-row"},As={class:"detail-content"},Es={class:"detail-value"},Ns={key:2,class:"detail-row"},Os={class:"detail-content"},Ps={class:"detail-value"},Us={key:0,class:"user-card"},Vs={class:"user-info"},Rs=["src","alt"],$s={key:1,class:"user-avatar-placeholder"},zs={class:"user-details"},qs={class:"user-name"},Ms={class:"user-email"},js=z({__name:"ListingShowView",setup(Gs){const A=H(),b=G(),k=Q(),S=q(),E=M(),s=f(null),C=f(!0),h=f(null),p=f(0),N=m(()=>{var a;return s.value?((a=L.find(e=>{var o;return e.value===((o=s.value)==null?void 0:o.category)}))==null?void 0:a.label)??"Unknown":""}),D=m(()=>{var a;return s.value?((a=L.find(e=>{var o;return e.value===((o=s.value)==null?void 0:o.category)}))==null?void 0:a.color)??"#6b7280":"#6b7280"}),O=m(()=>{var e,o,_;if(!((e=s.value)!=null&&e.subcategory))return"";const a=L.find(u=>{var d;return u.value===((d=s.value)==null?void 0:d.category)});return((_=(o=a==null?void 0:a.subcategories)==null?void 0:o.find(u=>{var d;return u.value===((d=s.value)==null?void 0:d.subcategory)}))==null?void 0:_.label)||""}),P=m(()=>{var a,e;return(a=s.value)!=null&&a.duration_estimate&&((e=K.find(o=>{var _;return o.value===((_=s.value)==null?void 0:_.duration_estimate)}))==null?void 0:e.label)||""}),U=m(()=>s.value?[{index:1,lat:s.value.location.lat,lng:s.value.location.lng,color:D.value}]:[]),I=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),V=a=>`${a.lat.toFixed(4)}, ${a.lng.toFixed(4)}`,R=async()=>{if(!(!S.user||!s.value)){if(S.user.id===s.value.user_id){alert("You cannot start a chat with yourself");return}try{const a=await E.getOrCreateChat(s.value.id);b.push({name:"chat",params:{id:a}})}catch(a){console.error("Failed to start chat:",a),alert("Failed to start chat. Please try again.")}}},$=async()=>{try{C.value=!0;const a=A.params.id,e=k.listings.find(o=>o.id===a);e?s.value=e:(await k.fetchSingleListing(a),s.value=k.listings.find(o=>o.id===a)||null),s.value||(h.value="Listing not found")}catch(a){h.value="Failed to load listing",console.error("Error fetching listing:",a)}finally{C.value=!1}};return j(()=>{$()}),(a,e)=>{var o,_;return l(),i("div",Z,[C.value?(l(),i("div",ss,[r(c(g),{icon:"svg-spinners:3-dots-bounce",class:"loading-spinner"}),e[2]||(e[2]=t("p",null,"Looking for listing...",-1))])):h.value?(l(),i("div",ts,[r(c(g),{icon:"mdi:alert-circle",class:"error-icon"}),e[4]||(e[4]=t("h2",null,"Listing not found",-1)),t("p",null,n(h.value),1),r(x,{onClick:e[0]||(e[0]=u=>c(b).push({name:"browse"})),variant:"primary"},{default:w(()=>e[3]||(e[3]=[y("Browse Listings")])),_:1,__:[3]})])):s.value?(l(),i("div",es,[t("div",as,[r(x,{onClick:e[1]||(e[1]=u=>c(b).back()),variant:"ghost","icon-left":"tabler:chevron-left",class:"back-button"},{default:w(()=>e[5]||(e[5]=[y(" Back ")])),_:1,__:[5]})]),(o=s.value.images)!=null&&o.length?(l(),i("div",is,[t("img",{src:s.value.images[p.value],alt:s.value.title,class:"main-image"},null,8,ls),s.value.images.length>1?(l(),i("div",os,[(l(!0),i(B,null,F(s.value.images,(u,d)=>(l(),i("button",{key:d,onClick:Ys=>p.value=d,class:T(["image-dot",{active:d===p.value}])},null,10,ns))),128))])):v("",!0),s.value.images.length>1?(l(),i("div",rs,n(p.value+1)+" of "+n(s.value.images.length),1)):v("",!0)])):v("",!0),t("div",cs,[t("div",us,[t("div",ds,[t("div",vs,[t("div",{class:"category-badge",style:Y({backgroundColor:D.value})},n(N.value),5),t("div",_s,n(O.value),1)]),t("h1",gs,n(s.value.title),1),t("div",ms,[t("div",{class:T(["status-badge",{active:s.value.active}])},[r(c(g),{icon:s.value.active?"tabler:check":"tabler:hourglass",class:"status-icon"},null,8,["icon"]),y(" "+n(s.value.active?"Active":"Expired"),1)],2),t("div",hs,"Posted "+n(I(s.value.created_at)),1)])]),t("div",ps,[e[6]||(e[6]=t("h2",{class:"section-title"},"Description",-1)),t("div",fs,[t("p",null,n(s.value.description),1)])]),t("div",ys,[r(X,{listing:s.value},null,8,["listing"])]),(_=s.value.skills_required)!=null&&_.length?(l(),i("div",bs,[e[7]||(e[7]=t("h3",{class:"section-subtitle"},"Skills Required",-1)),t("div",ks,[(l(!0),i(B,null,F(s.value.skills_required,u=>(l(),i("span",{key:u,class:"skill-tag"},n(u),1))),128))])])):v("",!0)]),t("div",Cs,[t("div",ws,[e[8]||(e[8]=t("h3",{class:"sidebar-title"},"Location",-1)),t("div",xs,[r(W,{center:s.value.location,zoom:15,pins:U.value,"non-interactive":"","disable-controls":"",class:"listing-map"},null,8,["center","pins"])]),t("div",Ls,[r(c(g),{icon:"tabler:map-pin",class:"location-icon"}),t("span",null,n(V(s.value.location)),1)])]),t("div",Ss,[e[12]||(e[12]=t("h3",{class:"sidebar-title"},"Details",-1)),t("div",Ds,[s.value.duration_estimate?(l(),i("div",Is,[r(c(g),{icon:"tabler:clock",class:"detail-icon"}),t("div",Bs,[e[9]||(e[9]=t("span",{class:"detail-label"},"Duration",-1)),t("span",Fs,n(P.value),1)])])):v("",!0),s.value.compensation?(l(),i("div",Ts,[r(c(g),{icon:"mdi:currency-usd",class:"detail-icon"}),t("div",As,[e[10]||(e[10]=t("span",{class:"detail-label"},"Compensation",-1)),t("span",Es,n(s.value.compensation),1)])])):v("",!0),s.value.expires_at?(l(),i("div",Ns,[r(c(g),{icon:"mdi:calendar-clock",class:"detail-icon"}),t("div",Os,[e[11]||(e[11]=t("span",{class:"detail-label"},"Expires",-1)),t("span",Ps,n(I(s.value.expires_at)),1)])])):v("",!0)])]),s.value.user?(l(),i("div",Us,[e[14]||(e[14]=t("h3",{class:"sidebar-title"},"Posted by",-1)),t("div",Vs,[s.value.user.avatar_url?(l(),i("img",{key:0,src:s.value.user.avatar_url,alt:s.value.user.full_name||"User",class:"user-avatar"},null,8,Rs)):(l(),i("div",$s,[r(c(g),{icon:"mdi:account",class:"avatar-icon"})])),t("div",zs,[t("h4",qs,n(s.value.user.full_name||"Anonymous User"),1),t("p",Ms,n(s.value.user.email),1)])]),r(x,{variant:"primary",onClick:R,"icon-left":"mdi:message",class:"contact-button"},{default:w(()=>e[13]||(e[13]=[y(" Contact ")])),_:1,__:[13]})])):v("",!0)])])])):v("",!0)])}}}),Xs=J(js,[["__scopeId","data-v-b179aa7f"]]);export{Xs as default};
//# sourceMappingURL=ListingShowView-DmKk57DV.js.map
