import{d as M,u as j,z as G,k as y,A as m,e as Y,c as o,p as u,h as n,a as e,j as c,I as g,t as r,w as k,x as H,B as b,F as B,C as T,D as J,E,g as p,i as F,s as K,o as l,_ as Q}from"./index-Cwfaiojx.js";import{C as S,D as W}from"./constants-DDm60LNs.js";import{u as X}from"./listings-D2fJ6JDs.js";import{M as Z}from"./Map-CKaJgrhF.js";import{L as tt}from"./ReputationBar.vue_vue_type_script_setup_true_lang-C-RWq6Fz.js";import{U as st}from"./UserDisplay-CG58Fqmj.js";import"./DefaultAvatar-BlKPcJpM.js";const et={class:"listing-show-container"},at={key:0,class:"loading-state"},it={key:1,class:"error-state"},lt={key:2,class:"listing-content"},ot={class:"mobile-header"},nt={key:0,class:"image-gallery"},rt=["src","alt"],ct={key:0,class:"image-nav"},ut=["onClick"],dt={key:1,class:"image-counter"},vt={class:"content-grid"},gt={class:"main-content"},_t={class:"listing-header"},mt={class:"category-info"},pt={class:"subcategory-text"},ht={class:"listing-title"},ft={class:"status-row"},yt={class:"date-info"},kt={class:"description-section"},bt={class:"description-content"},wt={class:"pills-section"},Ct={key:0,class:"skills-section"},xt={class:"skills-list"},Lt={class:"sidebar"},St={class:"map-section"},Dt={class:"map-container"},It={class:"location-info"},Bt={key:0,class:"details-card"},Tt={class:"details-list"},Et={key:0,class:"detail-row"},Ft={class:"detail-content"},Ut={class:"detail-value"},At={key:1,class:"detail-row"},Nt={class:"detail-content"},Pt={class:"detail-value"},Vt={key:2,class:"detail-row"},Ot={class:"detail-content"},Rt={class:"detail-value"},$t={key:1,class:"user-card"},zt=M({__name:"ListingShowView",setup(qt){const U=K(),w=H(),C=X(),x=j(),A=G(),s=y(null),L=y(!0),h=y(null),f=y(0),N=m(()=>{var a;return s.value?((a=S.find(t=>{var i;return t.value===((i=s.value)==null?void 0:i.category)}))==null?void 0:a.label)??"Unknown":""}),D=m(()=>{var a;return s.value?((a=S.find(t=>{var i;return t.value===((i=s.value)==null?void 0:i.category)}))==null?void 0:a.color)??"#6b7280":"#6b7280"}),P=m(()=>{var t,i,_;if(!((t=s.value)!=null&&t.subcategory))return"";const a=S.find(d=>{var v;return d.value===((v=s.value)==null?void 0:v.category)});return((_=(i=a==null?void 0:a.subcategories)==null?void 0:i.find(d=>{var v;return d.value===((v=s.value)==null?void 0:v.subcategory)}))==null?void 0:_.label)||""}),V=m(()=>{var a,t;return(a=s.value)!=null&&a.duration_estimate&&((t=W.find(i=>{var _;return i.value===((_=s.value)==null?void 0:_.duration_estimate)}))==null?void 0:t.label)||""}),O=m(()=>s.value?[{index:1,lat:s.value.location.lat,lng:s.value.location.lng,color:D.value}]:[]),R=m(()=>{var a,t,i;return((a=s.value)==null?void 0:a.duration_estimate)||((t=s.value)==null?void 0:t.compensation)||((i=s.value)==null?void 0:i.expires_at)}),I=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),$=a=>`${a.lat.toFixed(4)}, ${a.lng.toFixed(4)}`,z=async()=>{if(!(!x.user||!s.value)){if(x.user.id===s.value.user_id){alert("You cannot start a chat with yourself");return}try{const a=await A.getOrCreateChat(s.value.id);w.push({name:"chat",params:{id:a}})}catch(a){console.error("Failed to start chat:",a),alert("Failed to start chat. Please try again.")}}},q=async()=>{try{L.value=!0;const a=U.params.id,t=C.listings.find(i=>i.id===a);t?s.value=t:(await C.fetchSingleListing(a),s.value=C.listings.find(i=>i.id===a)||null),s.value||(h.value="Listing not found")}catch(a){h.value="Failed to load listing",console.error("Error fetching listing:",a)}finally{L.value=!1}};return Y(()=>{q()}),(a,t)=>{var i,_;return l(),o("div",et,[L.value?(l(),o("div",at,[n(c(g),{icon:"svg-spinners:3-dots-bounce",class:"loading-spinner"}),t[2]||(t[2]=e("p",null,"Looking for listing...",-1))])):h.value?(l(),o("div",it,[n(c(g),{icon:"mdi:alert-circle",class:"error-icon"}),t[4]||(t[4]=e("h2",null,"Listing not found",-1)),e("p",null,r(h.value),1),n(b,{onClick:t[0]||(t[0]=d=>c(w).push({name:"browse"})),variant:"primary"},{default:k(()=>t[3]||(t[3]=[p("Browse Listings")])),_:1,__:[3]})])):s.value?(l(),o("div",lt,[e("div",ot,[n(b,{onClick:t[1]||(t[1]=d=>c(w).back()),variant:"ghost","icon-left":"tabler:chevron-left",class:"back-button"},{default:k(()=>t[5]||(t[5]=[p(" Back ")])),_:1,__:[5]})]),(i=s.value.images)!=null&&i.length?(l(),o("div",nt,[e("img",{src:s.value.images[f.value],alt:s.value.title,class:"main-image"},null,8,rt),s.value.images.length>1?(l(),o("div",ct,[(l(!0),o(B,null,T(s.value.images,(d,v)=>(l(),o("button",{key:v,onClick:Mt=>f.value=v,class:E(["image-dot",{active:v===f.value}])},null,10,ut))),128))])):u("",!0),s.value.images.length>1?(l(),o("div",dt,r(f.value+1)+" of "+r(s.value.images.length),1)):u("",!0)])):u("",!0),e("div",vt,[e("div",gt,[e("div",_t,[e("div",mt,[e("div",{class:"category-badge",style:J({backgroundColor:D.value})},r(N.value),5),e("div",pt,r(P.value),1)]),e("h1",ht,r(s.value.title),1),e("div",ft,[e("div",{class:E(["status-badge",{active:s.value.active}])},[n(c(g),{icon:s.value.active?"tabler:check":"tabler:hourglass",class:"status-icon"},null,8,["icon"]),p(" "+r(s.value.active?"Active":"Expired"),1)],2),e("div",yt,"Posted "+r(I(s.value.created_at)),1)])]),e("div",kt,[t[6]||(t[6]=e("h2",{class:"section-title"},"Description",-1)),e("div",bt,[e("p",null,r(s.value.description),1)])]),e("div",wt,[n(tt,{listing:s.value},null,8,["listing"])]),(_=s.value.skills_required)!=null&&_.length?(l(),o("div",Ct,[t[7]||(t[7]=e("h3",{class:"section-subtitle"},"Skills Required",-1)),e("div",xt,[(l(!0),o(B,null,T(s.value.skills_required,d=>(l(),o("span",{key:d,class:"skill-tag"},r(d),1))),128))])])):u("",!0)]),e("div",Lt,[e("div",St,[t[8]||(t[8]=e("h3",{class:"sidebar-title"},"Location",-1)),e("div",Dt,[n(Z,{center:s.value.location,zoom:15,pins:O.value,"non-interactive":"","disable-controls":"",class:"listing-map"},null,8,["center","pins"])]),e("div",It,[n(c(g),{icon:"tabler:map-pin",class:"location-icon"}),e("span",null,r($(s.value.location)),1)])]),R.value?(l(),o("div",Bt,[t[12]||(t[12]=e("h3",{class:"sidebar-title"},"Details",-1)),e("div",Tt,[s.value.duration_estimate?(l(),o("div",Et,[n(c(g),{icon:"tabler:clock",class:"detail-icon"}),e("div",Ft,[t[9]||(t[9]=e("span",{class:"detail-label"},"Duration",-1)),e("span",Ut,r(V.value),1)])])):u("",!0),s.value.compensation?(l(),o("div",At,[n(c(g),{icon:"mdi:currency-usd",class:"detail-icon"}),e("div",Nt,[t[10]||(t[10]=e("span",{class:"detail-label"},"Compensation",-1)),e("span",Pt,r(s.value.compensation),1)])])):u("",!0),s.value.expires_at?(l(),o("div",Vt,[n(c(g),{icon:"mdi:calendar-clock",class:"detail-icon"}),e("div",Ot,[t[11]||(t[11]=e("span",{class:"detail-label"},"Expires",-1)),e("span",Rt,r(I(s.value.expires_at)),1)])])):u("",!0)])])):u("",!0),s.value.user?(l(),o("div",$t,[t[15]||(t[15]=e("h3",{class:"sidebar-title"},"Posted by",-1)),n(st,{user:s.value.user},null,8,["user"]),c(x).isAuthenticated?(l(),F(b,{key:0,variant:"primary",onClick:z,class:"contact-button"},{default:k(()=>[n(c(g),{icon:"mdi:message",class:"w-4 h-4 mr-2"}),t[13]||(t[13]=p(" Contact "))]),_:1,__:[13]})):(l(),F(b,{key:1,variant:"primary",link:{name:"auth"},class:"contact-button"},{default:k(()=>[n(c(g),{icon:"mdi:message",class:"w-4 h-4 mr-2"}),t[14]||(t[14]=p(" Log in or Sign Up To Connect "))]),_:1,__:[14]}))])):u("",!0)])])])):u("",!0)])}}}),Wt=Q(zt,[["__scopeId","data-v-1c42e8e2"]]);export{Wt as default};
//# sourceMappingURL=ListingShowView-CKmOKmfI.js.map
